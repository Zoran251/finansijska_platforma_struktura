<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <title>FINAL TEST - SaÄuvaj budÅ¾et</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: Arial; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .section { background: #333; padding: 20px; margin: 20px 0; border-radius: 8px; }
        button { background: #d4af37; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; font-weight: bold; }
        input { padding: 8px; margin: 5px; border-radius: 4px; border: 1px solid #555; background: #444; color: white; width: 200px; }
        .budget-display { background: #222; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .progress-bar { width: 100%; height: 20px; background: #555; border-radius: 10px; margin: 5px 0; }
        .progress-fill { height: 100%; background: #d4af37; border-radius: 10px; width: 0%; transition: width 0.3s; }
        #log { background: #000; padding: 10px; border-radius: 5px; height: 200px; overflow-y: scroll; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª FINAL TEST - Dugme "SaÄuvaj budÅ¾et"</h1>
        
        <div class="section">
            <h2>ğŸ“Š Trenutni prikaz budÅ¾eta</h2>
            <div class="budget-display">
                <p>MeseÄni budÅ¾et: <span data-budget="monthly">â‚¬0</span></p>
                <p>PotroÅ¡eno: <span data-budget="spent">â‚¬0</span></p>
                <p>Preostalo: <span data-budget="remaining">â‚¬0</span></p>
                <div class="progress-bar">
                    <div data-budget="progress" class="progress-fill"></div>
                </div>
            </div>
            
            <h3>Profile elementi (totalIncome, totalExpenses, currentBalance)</h3>
            <div class="budget-display">
                <p>Total Income: <span id="totalIncome">â‚¬0</span></p>
                <p>Total Expenses: <span id="totalExpenses">â‚¬0</span></p>
                <p>Current Balance: <span id="currentBalance">â‚¬0</span></p>
            </div>
        </div>
        
        <div class="section">
            <h2>âœï¸ Test unos</h2>
            <form id="budgetForm">
                <div>
                    <label>MeseÄni budÅ¾et (â‚¬):</label><br>
                    <input type="number" id="monthlyBudget" value="5000" min="0" step="10">
                </div>
                <div>
                    <label>VeÄ‡ potroÅ¡eno (â‚¬):</label><br>
                    <input type="number" id="spentAmount" value="3200" min="0" step="10">
                </div>
                <div style="margin: 20px 0;">
                    <button type="submit">ğŸ’¾ SAÄŒUVAJ BUDÅ½ET</button>
                </div>
            </form>
        </div>
        
        <div class="section">
            <h2>ğŸ”§ Test funkcije</h2>
            <button onclick="testFunctions()">ğŸ§ª Test funkcije</button>
            <button onclick="createDemo()">ğŸ¯ Demo podaci</button>
            <button onclick="clearData()">ğŸ—‘ï¸ ObriÅ¡i podatke</button>
            <button onclick="window.updateBudgetDisplay()">ğŸ”„ Manual update</button>
        </div>
        
        <div class="section">
            <h2>ğŸ“ Log</h2>
            <div id="log"></div>
        </div>
    </div>

    <script>
        // Jednostavan log sistem
        const log = document.getElementById('log');
        function addLog(message) {
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `[${time}] ${message}<br>`;
            log.scrollTop = log.scrollHeight;
            console.log(message);
        }
        
        // Mock funkcije ako main.js ne radi
        let budgetCategories = [];
        
        function saveBudgetChanges() {
            addLog('ğŸ”„ saveBudgetChanges() pozvana');
            
            const monthlyBudget = parseFloat(document.getElementById('monthlyBudget').value) || 0;
            const spentAmount = parseFloat(document.getElementById('spentAmount').value) || 0;
            
            addLog(`ğŸ’° Podaci: meseÄni=${monthlyBudget}, potroÅ¡eno=${spentAmount}`);
            
            const budgetData = {
                monthly: monthlyBudget,
                spent: spentAmount,
                categories: budgetCategories,
                lastUpdated: new Date().toISOString()
            };
            
            localStorage.setItem('userBudget', JSON.stringify(budgetData));
            addLog('ğŸ’¾ Podaci saÄuvani u localStorage');
            
            updateBudgetDisplay();
            addLog('âœ… Budget uspeÅ¡no aÅ¾uriran!');
        }
        
        function updateBudgetDisplay() {
            addLog('ğŸ“Š updateBudgetDisplay() pozvana');
            
            const savedBudget = JSON.parse(localStorage.getItem('userBudget'));
            if (!savedBudget) {
                addLog('âŒ Nema saÄuvanih podataka');
                return;
            }
            
            addLog(`ğŸ“Š UÄitani podaci: ${JSON.stringify(savedBudget)}`);
            
            // Update data-budget elements
            const monthlyElements = document.querySelectorAll('[data-budget="monthly"]');
            const spentElements = document.querySelectorAll('[data-budget="spent"]');
            const remainingElements = document.querySelectorAll('[data-budget="remaining"]');
            const progressElements = document.querySelectorAll('[data-budget="progress"]');
            
            const monthly = savedBudget.monthly || 0;
            const spent = savedBudget.spent || 0;
            const remaining = monthly - spent;
            const percentage = monthly > 0 ? (spent / monthly) * 100 : 0;
            
            addLog(`ğŸ”¢ IzraÄunato: mjeseÄni=${monthly}, potroÅ¡eno=${spent}, preostalo=${remaining}, procenat=${percentage}%`);
            
            monthlyElements.forEach(el => el.textContent = `â‚¬${monthly.toLocaleString()}`);
            spentElements.forEach(el => el.textContent = `â‚¬${spent.toLocaleString()}`);
            remainingElements.forEach(el => el.textContent = `â‚¬${remaining.toLocaleString()}`);
            progressElements.forEach(el => el.style.width = `${Math.min(percentage, 100)}%`);
            
            // Update profile elements
            const totalIncomeEl = document.getElementById('totalIncome');
            const totalExpensesEl = document.getElementById('totalExpenses');
            const currentBalanceEl = document.getElementById('currentBalance');
            
            if (totalIncomeEl) totalIncomeEl.textContent = `â‚¬${monthly.toLocaleString()}`;
            if (totalExpensesEl) totalExpensesEl.textContent = `â‚¬${spent.toLocaleString()}`;
            if (currentBalanceEl) currentBalanceEl.textContent = `â‚¬${remaining.toLocaleString()}`;
            
            addLog(`âœ… Prikaz aÅ¾uriran! PronaÄ‘eno ${monthlyElements.length} monthly, ${spentElements.length} spent, ${remainingElements.length} remaining elemenata`);
        }
        
        function testFunctions() {
            addLog('ğŸ§ª === TEST FUNKCIJA ===');
            addLog(`updateBudgetDisplay: ${typeof updateBudgetDisplay}`);
            addLog(`saveBudgetChanges: ${typeof saveBudgetChanges}`);
            addLog(`localStorage userBudget: ${localStorage.getItem('userBudget')}`);
            updateBudgetDisplay();
        }
        
        function createDemo() {
            addLog('ğŸ¯ Kreiranje demo podataka...');
            const demo = {
                monthly: 4500,
                spent: 2800,
                categories: [],
                lastUpdated: new Date().toISOString()
            };
            localStorage.setItem('userBudget', JSON.stringify(demo));
            updateBudgetDisplay();
        }
        
        function clearData() {
            localStorage.removeItem('userBudget');
            addLog('ğŸ—‘ï¸ Podaci obrisani');
            updateBudgetDisplay();
        }
        
        // Event listener za formu
        document.addEventListener('DOMContentLoaded', function() {
            addLog('ğŸš€ Stranica uÄitana');
            
            // Dodaj event listener za formu
            document.getElementById('budgetForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addLog('ğŸ“ Forma submitted!');
                saveBudgetChanges();
            });
            
            // Test poÄetni prikaz
            updateBudgetDisplay();
        });
        
        // Export na window za testiranje
        window.updateBudgetDisplay = updateBudgetDisplay;
        window.saveBudgetChanges = saveBudgetChanges;
    </script>
    
    <!-- PokuÅ¡aj uÄitati main.js, ali nastavi i bez njega -->
    <script src="js/main.js" onerror="addLog('âš ï¸ main.js se nije uÄitao, koristimo backup funkcije')"></script>
</body>
</html>
