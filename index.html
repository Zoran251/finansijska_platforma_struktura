<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finansijska Platforma</title>
    
    <!-- PWA Meta Tags -->    <meta name="theme-color" content="#D4AF37">
    <meta name="description" content="Napredna finansijska platforma za upravljanje ličnim finansijama">    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icons/golden-balance-logo.svg">
    <link rel="apple-touch-icon" href="icons/golden-balance-logo.svg">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles/index-modern.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Scripts -->
    <script src="js/offlineStorage.js"></script>
    <script src="js/touchGestures.js"></script>
    <script src="js/responsive.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', function() {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', function() {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New update available
                                    if (confirm('Nova verzija aplikacije je dostupna. Želite li da je instalirate?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', function(e) {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button
            const installBtn = document.createElement('button');
            installBtn.className = 'install-btn';
            installBtn.innerHTML = '<i class="fas fa-download"></i> Instaliraj aplikaciju';            installBtn.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #D4AF37 0%, #A8861D 100%);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 8px;
                cursor: pointer;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transition: all 0.3s ease;
            `;
            
            installBtn.addEventListener('mouseover', function() {
                this.style.transform = 'translateY(-2px)';
                this.style.boxShadow = '0 6px 16px rgba(0,0,0,0.2)';
            });
            
            installBtn.addEventListener('mouseout', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            });
            
            installBtn.addEventListener('click', function() {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function(choiceResult) {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                        installBtn.remove();
                    }
                    deferredPrompt = null;
                });
            });
            
            document.body.appendChild(installBtn);
            
            // Hide after 10 seconds if not clicked
            setTimeout(function() {
                if (installBtn && installBtn.parentNode) {
                    installBtn.style.opacity = '0';
                    setTimeout(function() {
                        installBtn.remove();
                    }, 300);
                }
            }, 10000);
        });
        
        // Handle app installation
        window.addEventListener('appinstalled', function() {
            console.log('PWA was installed');
            // Hide install button if it exists
            const installBtn = document.querySelector('.install-btn');
            if (installBtn) {
                installBtn.remove();
            }
        });
    </script>
</head>
<body>    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="app-logo">
                    <img id="appLogo" src="https://via.placeholder.com/80x80/D4AF37/000000?text=FP" alt="Logo">
                </div>
                <h1>FinPlatforma</h1>
                <p>Prijavite se za pristup aplikaciji</p>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Korisničko ime:</label>
                    <input type="text" id="username" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Lozinka:</label>
                    <input type="password" id="password" required>
                </div>
                
                <button type="submit" class="btn-primary btn-login">
                    <i class="fas fa-sign-in-alt"></i> Prijavite se
                </button>
                
                <div class="login-options">
                    <a href="#" id="adminLoginBtn">Admin pristup</a>
                </div>
            </form>
        </div>
    </div>    <div id="app" style="display: none;">
        <nav class="navbar">
            <div class="nav-brand">
                <img id="navLogo" src="https://via.placeholder.com/40x40/000000/D4AF37?text=FP" alt="Logo" class="nav-logo">
                <span>FinPlatforma</span>
            </div>
            <div class="nav-menu">
                <a href="#dashboard" class="nav-link active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#transactions" class="nav-link" data-section="transactions">
                    <i class="fas fa-exchange-alt"></i> Transakcije
                </a>
                <a href="#budget" class="nav-link" data-section="budget">
                    <i class="fas fa-calculator"></i> Budžet
                </a>
                <a href="#analytics" class="nav-link" data-section="analytics">
                    <i class="fas fa-chart-bar"></i> Analitika
                </a>
                <a href="#profile" class="nav-link" data-section="profile">
                    <i class="fas fa-user"></i> Profil
                </a>
                <a href="#admin" class="nav-link admin-only" data-section="admin" style="display: none;">
                    <i class="fas fa-cog"></i> Admin
                </a>            </div>
            <div class="nav-user">
                <!-- Network Status Indicator -->
                <div id="networkStatus" class="network-status online">
                    <i class="fas fa-wifi"></i>
                    <span class="status-text">Online</span>
                </div>
                <span id="currentUser">Korisnik</span>
                <button id="logoutBtn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </nav>

        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">                <div class="dashboard-header">
                    <h1>Dashboard</h1>
                    <div class="date-filter">
                        <input type="date" id="startDate" />
                        <input type="date" id="endDate" />
                        <button id="filterBtn">Filtriraj</button>
                    </div>
                </div>
                
                <div class="card-grid">
                    <div class="card income-card">
                        <div class="card-icon">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="card-info">
                            <h3>Ukupni prihodi</h3>
                            <p class="card-value" id="totalIncome">0 RSD</p>
                            <div class="card-trend positive">
                                <i class="fas fa-chart-line"></i>
                                <span id="incomeChange">+0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card expense-card">
                        <div class="card-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="card-info">
                            <h3>Ukupni rashodi</h3>
                            <p class="card-value" id="totalExpense">0 RSD</p>
                            <div class="card-trend negative">
                                <i class="fas fa-chart-line"></i>
                                <span id="expenseChange">+0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card balance-card">
                        <div class="card-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="card-info">
                            <h3>Saldo</h3>
                            <p class="card-value" id="balance">0 RSD</p>
                            <div class="card-trend">
                                <i class="fas fa-chart-pie"></i>
                                <span id="balanceRatio">0%</span> od prihoda
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container card">
                    <h3 class="chart-title">Mesečni pregled</h3>
                    <canvas id="monthlyChart" width="400" height="200"></canvas>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactions" class="content-section">
                <div class="section-header">
                    <h1>Transakcije</h1>
                    <button id="addTransactionBtn" class="btn-primary">
                        <i class="fas fa-plus"></i> Dodaj transakciju
                    </button>
                </div>
                
                <div class="transactions-container card">
                    <div class="transaction-filters">
                        <select id="typeFilter">
                            <option value="">Svi tipovi</option>
                            <option value="income">Prihodi</option>
                            <option value="expense">Rashodi</option>
                        </select>
                        <select id="categoryFilter">
                            <option value="">Sve kategorije</option>
                        </select>
                    </div>
                    
                    <div class="transactions-list" id="transactionsList">
                        <!-- Transakcije Ä‡e biti dinamiÄŤki uÄŤitane -->
                    </div>
                </div>
            </section>

            <!-- Budget Section -->
            <section id="budget" class="content-section">
                <div class="section-header">
                    <h1>BudĹľet</h1>
                    <button id="addBudgetBtn" class="btn-primary">
                        <i class="fas fa-plus"></i> Dodaj budĹľet
                    </button>
                </div>
                
                <div class="budget-container" id="budgetContainer">
                    <!-- BudĹľeti Ä‡e biti dinamiÄŤki uÄŤitane -->
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="content-section">
                <div class="section-header">
                    <h1>Analitika</h1>
                </div>
                
                <div class="analytics-grid">
                    <div class="chart-card">
                        <h3>Rashodi po kategorijama</h3>
                        <canvas id="categoryChart" width="300" height="300"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <h3>Trendovi prihoda/rashoda</h3>
                        <canvas id="trendChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="content-section">
                <div class="section-header">
                    <h1>KorisniÄŤki profil</h1>
                </div>
                
                <div class="profile-container">
                    <div class="profile-card">
                        <div class="profile-avatar">
                            <img id="userAvatar" src="https://via.placeholder.com/150x150/667eea/ffffff?text=USER" alt="Avatar">
                            <button id="changeAvatarBtn" class="btn-change-avatar">
                                <i class="fas fa-camera"></i>
                            </button>
                            <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                        </div>
                        
                        <div class="profile-info">
                            <h2 id="profileName">Ime korisnika</h2>
                            <p id="profileEmail">email@example.com</p>
                            <p class="profile-role">Korisnik</p>
                        </div>
                        
                        <button id="editProfileBtn" class="btn-primary">
                            <i class="fas fa-edit"></i> Izmeni profil
                        </button>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat-item">
                            <h3>Ukupno transakcija</h3>
                            <p id="userTransactionCount">0</p>
                        </div>
                        <div class="stat-item">
                            <h3>Datum registracije</h3>
                            <p id="userRegistrationDate">-</p>
                        </div>
                        <div class="stat-item">
                            <h3>Poslednja aktivnost</h3>
                            <p id="userLastActivity">-</p>
                        </div>
                    </div>
                    
                    <div class="data-export">
                        <h3>Izvoz podataka</h3>
                        <div class="export-options">
                            <button id="exportJsonBtn" class="btn-secondary">
                                <i class="fas fa-download"></i> Izvezi JSON
                            </button>
                            <button id="exportCsvBtn" class="btn-secondary">
                                <i class="fas fa-file-csv"></i> Izvezi CSV
                            </button>
                            <button id="exportPdfBtn" class="btn-secondary">
                                <i class="fas fa-file-pdf"></i> Izvezi PDF
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin Section -->
            <section id="admin" class="content-section">
                <div class="section-header">
                    <h1>Admin panel</h1>
                </div>
                
                <div class="admin-container">
                    <div class="admin-tabs">
                        <button class="admin-tab-btn active" data-tab="settings">
                            <i class="fas fa-cog"></i> Postavke
                        </button>
                        <button class="admin-tab-btn" data-tab="users">
                            <i class="fas fa-users"></i> Korisnici
                        </button>
                        <button class="admin-tab-btn" data-tab="system">
                            <i class="fas fa-server"></i> Sistem
                        </button>
                    </div>
                    
                    <div id="admin-settings" class="admin-tab-content active">
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3>Logo aplikacije</h3>
                                <div class="logo-upload">
                                    <img id="currentLogo" src="https://via.placeholder.com/100x100/667eea/ffffff?text=FP" alt="Current Logo">
                                    <div class="logo-controls">
                                        <button id="uploadLogoBtn" class="btn-primary">
                                            <i class="fas fa-upload"></i> Promeni logo
                                        </button>
                                        <input type="file" id="logoInput" accept="image/*" style="display: none;">
                                        <button id="resetLogoBtn" class="btn-secondary">
                                            <i class="fas fa-undo"></i> Resetuj
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-card">
                                <h3>Naziv aplikacije</h3>
                                <input type="text" id="appNameInput" value="FinPlatforma" class="setting-input">
                                <button id="updateAppNameBtn" class="btn-primary">AĹľuriraj</button>
                            </div>
                            
                            <div class="setting-card">
                                <h3>Kategorije</h3>
                                <div class="category-management">
                                    <div class="category-section">
                                        <h4>Kategorije prihoda</h4>
                                        <div id="incomeCategoriesList" class="categories-list"></div>
                                        <div class="add-category">
                                            <input type="text" id="newIncomeCategory" placeholder="Nova kategorija prihoda">
                                            <button id="addIncomeCategoryBtn" class="btn-small">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="category-section">
                                        <h4>Kategorije rashoda</h4>
                                        <div id="expenseCategoriesList" class="categories-list"></div>
                                        <div class="add-category">
                                            <input type="text" id="newExpenseCategory" placeholder="Nova kategorija rashoda">
                                            <button id="addExpenseCategoryBtn" class="btn-small">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="admin-users" class="admin-tab-content">
                        <div class="users-management">
                            <div class="users-header">
                                <h3>Upravljanje korisnicima</h3>
                                <button id="addUserBtn" class="btn-primary">
                                    <i class="fas fa-user-plus"></i> Dodaj korisnika
                                </button>
                            </div>
                            <div id="usersList" class="users-list"></div>
                        </div>
                    </div>
                    
                    <div id="admin-system" class="admin-tab-content">
                        <div class="system-info">
                            <h3>Sistemske informacije</h3>
                            <div class="info-grid">
                                <div class="info-card">
                                    <h4>Ukupno korisnika</h4>
                                    <p id="totalUsers">0</p>
                                </div>
                                <div class="info-card">
                                    <h4>Ukupno transakcija</h4>
                                    <p id="totalTransactions">0</p>
                                </div>
                                <div class="info-card">
                                    <h4>VeliÄŤina baze</h4>
                                    <p id="databaseSize">0 KB</p>
                                </div>
                            </div>
                            
                            <div class="system-actions">
                                <button id="backupDataBtn" class="btn-secondary">
                                    <i class="fas fa-download"></i> Backup podataka
                                </button>
                                <button id="clearDataBtn" class="btn-danger">
                                    <i class="fas fa-trash"></i> ObriĹˇi sve podatke
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Profile Edit Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Izmeni profil</h2>
                <span class="close">&times;</span>
            </div>
            <form id="profileForm">
                <div class="form-group">
                    <label for="profileNameEdit">Ime:</label>
                    <input type="text" id="profileNameEdit" required>
                </div>
                
                <div class="form-group">
                    <label for="profileEmailEdit">Email:</label>
                    <input type="email" id="profileEmailEdit" required>
                </div>
                
                <div class="form-group">
                    <label for="profilePhoneEdit">Telefon:</label>
                    <input type="tel" id="profilePhoneEdit">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelProfileEdit">OtkaĹľi</button>
                    <button type="submit" class="btn-primary">SaÄŤuvaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal za dodavanje transakcije -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj transakciju</h2>
                <span class="close">&times;</span>
            </div>
            <form id="transactionForm">
                <div class="form-group">
                    <label for="transactionType">Tip:</label>
                    <select id="transactionType" required>
                        <option value="income">Prihod</option>
                        <option value="expense">Rashod</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="transactionAmount">Iznos (RSD):</label>
                    <input type="number" id="transactionAmount" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label for="transactionCategory">Kategorija:</label>
                    <select id="transactionCategory" required>
                        <!-- Opcije Ä‡e biti dinamiÄŤki uÄŤitane -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="transactionDescription">Opis:</label>
                    <input type="text" id="transactionDescription" required>
                </div>
                
                <div class="form-group">
                    <label for="transactionDate">Datum:</label>
                    <input type="date" id="transactionDate" required>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelTransaction">OtkaĹľi</button>
                    <button type="submit" class="btn-primary">SaÄŤuvaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal za dodavanje budĹľeta -->
    <div id="budgetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dodaj budĹľet</h2>
                <span class="close">&times;</span>
            </div>
            <form id="budgetForm">
                <div class="form-group">
                    <label for="budgetCategory">Kategorija:</label>
                    <select id="budgetCategory" required>
                        <!-- Opcije Ä‡e biti dinamiÄŤki uÄŤitane -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="budgetAmount">Iznos (RSD):</label>
                    <input type="number" id="budgetAmount" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label for="budgetPeriod">Period:</label>
                    <select id="budgetPeriod" required>
                        <option value="monthly">MeseÄŤno</option>
                        <option value="yearly">GodiĹˇnje</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelBudget">OtkaĹľi</button>
                    <button type="submit" class="btn-primary">SaÄŤuvaj</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal za konsultacije -->
    <div id="consultationModal" class="modal">
        <div class="modal-content max-w-700 max-h-90vh overflow-y-auto bg-22-22-26-095 border border-gold">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div class="consultation-header text-center mb-2">
                <div class="consultation-icon mb-1" style="font-size: 3rem; color: var(--gold-bright);">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <h2 class="color-d4af37 mb-1">ZakaĹľite Besplatnu Konsultaciju</h2>
                <p class="color-999 mb-0 lh-1-5">NaĹˇi struÄŤnjaci Ä‡e vam pomoÄ‡i da optimizujete vaĹˇe finansije i postignete vaĹˇe ciljeve.</p>
            </div>
            
            <form id="consultationForm" onsubmit="submitConsultationForm(event)">
                <div class="consultation-form-grid" style="display: grid; gap: 1.5rem;">
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="clientName" class="form-label">
                                <i class="fas fa-user mr-05"></i>Ime i prezime
                            </label>
                            <input type="text" id="clientName" required class="form-control" placeholder="Unesite vaĹˇe ime i prezime" />
                        </div>
                        
                        <div class="form-group">
                            <label for="clientEmail" class="form-label">
                                <i class="fas fa-envelope mr-05"></i>Email adresa
                            </label>
                            <input type="email" id="clientEmail" required class="form-control" placeholder="vasa.email@primer.com" />
                        </div>
                    </div>
                    
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="location" class="form-label">
                                <i class="fas fa-map-marker-alt mr-05"></i>Grad i drĹľava
                            </label>
                            <input type="text" id="location" required class="form-control" placeholder="npr. Beograd, Srbija" />
                        </div>
                        
                        <div class="form-group">
                            <label for="consultationTopic" class="form-label">
                                <i class="fas fa-tag mr-05"></i>Tema konsultacije
                            </label>
                            <select id="consultationTopic" required class="form-control">
                                <option value="">Izaberite temu</option>
                                <option value="Licne finansije">đź’° LiÄŤne finansije i budĹľet</option>
                                <option value="Investicije">đź“ Investicije i Ĺˇtednja</option>
                                <option value="Penziisko osiguranje">đźŹ›ď¸Ź Penzijsko osiguranje</option>
                                <option value="Porezi">đź“Š Porezi i optimizacija</option>
                                <option value="Krediti">đźŹ¦ Krediti i dugovi</option>
                                <option value="Osiguranje">đź›ˇď¸Ź Osiguranje i zaĹˇtita</option>
                                <option value="Ostalo">âť“ Ostalo</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="consultationDate" class="form-label">
                            <i class="fas fa-clock mr-05"></i>Ĺ˝eljeni termin
                        </label>
                        <input type="datetime-local" id="consultationDate" required class="form-control" />
                        <small class="form-text color-666 mt-1">
                            <i class="fas fa-info-circle mr-05"></i>
                            Dostupni termini: radnim danima izmeÄ‘u 09:00 i 17:00
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="description" class="form-label">
                            <i class="fas fa-edit mr-05"></i>OpiĹˇite vaĹˇu situaciju i ciljeve
                        </label>
                        <textarea id="description" rows="4" required class="form-control" 
                                placeholder="Ukratko opiĹˇite vaĹˇu trenutnu finansijsku situaciju i Ĺˇta Ĺľelite da postignete kroz konsultacije..."></textarea>
                    </div>
                </div>
                
                <div class="consultation-benefits mb-2" style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0;">
                    <h4 class="color-10b981 mb-1">
                        <i class="fas fa-check-circle mr-05"></i>Ĺ ta dobijate:
                    </h4>
                    <ul class="benefits-list color-999 lh-1-6" style="list-style: none; padding: 0; margin: 0;">
                        <li><i class="fas fa-arrow-right mr-1 color-10b981"></i>Detaljnu analizu vaĹˇih finansija</li>
                        <li><i class="fas fa-arrow-right mr-1 color-10b981"></i>Personalizovane preporuke za optimizaciju</li>
                        <li><i class="fas fa-arrow-right mr-1 color-10b981"></i>Plan za postizanje finansijskih ciljeva</li>
                        <li><i class="fas fa-arrow-right mr-1 color-10b981"></i>Odgovore na sva vaĹˇa pitanja</li>
                    </ul>
                </div>
                
                <div id="formSuccess" class="d-none alert-success text-center p-2 border-radius-8 mb-2">
                    <i class="fas fa-check-circle fs-1-5rem mb-1"></i>
                    <div class="success-message"></div>
                </div>
                
                <div id="formError" class="d-none alert-danger text-center p-2 border-radius-8 mb-2">
                    <i class="fas fa-exclamation-triangle fs-1-5rem mb-1"></i>
                    <div class="error-message"></div>
                </div>
                
                <button type="submit" class="primary-button w-100 p-4 mt-2 fs-1-1rem fw-600">
                    <i class="fas fa-calendar-check mr-05"></i>
                    ZakaĹľi Besplatnu Konsultaciju
                </button>
                
                <p class="text-center color-666 fs-0-85rem mt-1 mb-0">
                    <i class="fas fa-lock mr-05"></i>VaĹˇi podaci su potpuno bezbedni i neÄ‡e biti deljeni sa treÄ‡im licima.
                </p>
            </form>
        </div>
    </div>

    <!-- Support Chat Ä‡e se kreirati dinamiÄŤki putem support-chat.js -->

    <script>
        // Handle modal functionality
        function closeModal() {
            // Close all modals
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
            // Remove body modal-open class
            document.body.classList.remove('modal-open');
        }

        // Close modal when clicking on X or outside the modal
        document.querySelectorAll('.close-modal').forEach(closeBtn => {
            closeBtn.addEventListener('click', closeModal);
        });

        window.addEventListener('click', (e) => {
            document.querySelectorAll('.modal').forEach(modal => {
                if (e.target === modal) {
                    closeModal();
                }
            });
        });

        // Handle show/hide register and login forms
        document.getElementById('showRegister')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        });

        document.getElementById('showLogin')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        });

        // Handle login form submission
        document.querySelector('#loginModal form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const emailInput = this.querySelector('#loginEmail');
            const passwordInput = this.querySelector('#loginPassword');
            
            const email = emailInput.value.trim();
            const password = passwordInput.value;
              // Admin credentials check
            if (email === 'zorandostica2@gmail.com' && password === 'zoran2403') {                // Store user data in localStorage
                localStorage.setItem('currentUser', JSON.stringify({
                    email: email,
                    name: 'Administrator',
                    isAdmin: true
                }));
                localStorage.setItem('admin_logged_in', 'true');
                
                // Reload current page to update UI
                window.location.reload();
            } else {
                // Show error message
                alert('Neispravni podaci za prijavu. Za demo koristite: zorandostica2@gmail.com / zoran2403');
            }
        });

        // Handle registration form submission
        document.querySelector('#registerModal form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const fullNameInput = this.querySelector('#regFullName');
            const emailInput = this.querySelector('#regEmail');
            const passwordInput = this.querySelector('#regPassword');
            const confirmPasswordInput = this.querySelector('#regConfirmPassword');
            
            const fullName = fullNameInput.value.trim();
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            const confirmPassword = confirmPasswordInput.value;
            
            // Password validation
            if (password !== confirmPassword) {
                alert('Lozinke se ne poklapaju!');
                return;
            }
              // For demo, only allow admin registration
            if (email === 'zorandostica2@gmail.com' && password === 'zoran2403') {                // Store user data in localStorage
                localStorage.setItem('currentUser', JSON.stringify({
                    email: email,
                    name: fullName,
                    isAdmin: true
                }));
                localStorage.setItem('admin_logged_in', 'true');
                
                // Reload current page to update UI
                window.location.reload();
            } else {
                // Show error message
                alert('Registracija je omoguÄ‡ena samo za admin nalog u ovoj demo verziji. Koristite: zorandostica2@gmail.com / zoran2403');
            }
        });

        // Check login status on page load
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            if (currentUser.email) {
                // User is logged in
                document.getElementById('guestUser').classList.add('d-none');
                document.getElementById('loggedInUser').classList.remove('d-none');
                
                // Load profile image
                loadHeaderProfileImage();
                
                // Set user profile info if available
                if (document.getElementById('dropdownUserName')) {
                    document.getElementById('dropdownUserName').textContent = currentUser.name || 'Korisnik';
                }
                if (document.getElementById('dropdownUserEmail')) {
                    document.getElementById('dropdownUserEmail').textContent = currentUser.email;
                }                // Display admin button if user is admin
                if (currentUser.email === 'zorandostica2@gmail.com' && localStorage.getItem('admin_logged_in') === 'true') {
                    if (document.getElementById('adminSettingsBtn')) {
                        document.getElementById('adminSettingsBtn').classList.remove('d-none');
                    }
                } else {
                    if (document.getElementById('adminSettingsBtn')) {
                        document.getElementById('adminSettingsBtn').classList.add('d-none');
                    }
                }            } else {
                // User is not logged in
                document.getElementById('guestUser').classList.remove('d-none');
                document.getElementById('loggedInUser').classList.add('d-none');
            }
            
            // Add event listener for logout
            document.getElementById('logoutBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('currentUser');
                localStorage.removeItem('admin_logged_in');
                window.location.reload();
            });
            
            // Toggle password visibility
            window.togglePassword = function(inputId) {
                const input = document.getElementById(inputId);
                const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                input.setAttribute('type', type);
                
                const icon = input.parentElement.querySelector('.toggle-password i');
                if (icon) {
                    icon.classList.toggle('fa-eye');
                    icon.classList.toggle('fa-eye-slash');
                }
            };
        });
    </script>
      <script>
        // Function to load profile image in header
        function loadHeaderProfileImage() {
            const userData = JSON.parse(localStorage.getItem('userData') || '{}');
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const profileImg = document.getElementById('userProfilePic');
            
            if (!profileImg) return;
            
            // Try to get profile image from localStorage data
            const profileImageUrl = userData.profileImageUrl || currentUser.profileImageUrl || currentUser.profileImage;
            
            if (profileImageUrl && currentUser.email) {
                // Pre-load the image to check if it loads properly
                const tempImg = new Image();
                tempImg.onload = function() {
                    // Image loaded successfully, display it
                    profileImg.src = profileImageUrl;
                    console.log("Profile image loaded successfully");
                };
                
                tempImg.onerror = function() {
                    // Image failed to load, keep default placeholder
                    console.error("Failed to load profile image");
                    profileImg.src = "https://via.placeholder.com/60";
                };
                
                // Start the loading process
                tempImg.src = profileImageUrl;
            } else {
                console.log("No profile image found in user data or user not logged in");
                profileImg.src = "https://via.placeholder.com/60";
            }
        }
        
        // Pravilno postavljanje DOMContentLoaded eventa i poziva funkcije
        if (typeof loadHeaderProfileImage === 'function') {
            document.addEventListener('DOMContentLoaded', function() {
                loadHeaderProfileImage();
            });
        }
    </script>
    <script>
        // Funkcija za otvaranje modala po id-u
        function openModal(modalId) {
            // Zatvori sve modale pre otvaranja novog
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
                document.body.classList.add('modal-open');
            }
        }        // Povezivanje dugmadi iz hero sekcije sa modalima
        document.addEventListener('DOMContentLoaded', function() {            
            // Smart navigation function for expense tracking button
            window.smartBudgetNavigation = function() {
                // Check if user has saved income data
                const hasIncomeData = checkUserIncomeData();
                
                if (hasIncomeData) {
                    // User has income setup, redirect to expense forms
                    sessionStorage.setItem('activeTab', 'budget-tab');
                    sessionStorage.setItem('budgetSection', 'expenses');
                    window.location.href = 'profile.html#expenseTracker';
                } else {
                    // User needs to setup income first
                    sessionStorage.setItem('activeTab', 'budget-tab');
                    sessionStorage.setItem('budgetSection', 'income');
                    sessionStorage.setItem('showIncomeAlert', 'true');
                    window.location.href = 'profile.html#incomeSetup';
                }
            };
            
            // Function to check if user has income data
            function checkUserIncomeData() {
                // Get current month key
                const now = new Date();
                const currentMonthKey = now.getFullYear() + '-' + String(now.getMonth() + 1).padStart(2, '0');
                
                // Check multiple sources for income data
                // 1. Current user object
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                if (currentUser.income && currentUser.income > 0) {
                    return true;
                }
                
                // 2. Income history for current month
                const incomeHistory = JSON.parse(localStorage.getItem('incomeHistory') || '{}');
                if (incomeHistory[currentMonthKey] && incomeHistory[currentMonthKey] > 0) {
                    return true;
                }
                
                // 3. Budget plan
                const budgetPlan = JSON.parse(localStorage.getItem('budgetPlan') || '{}');
                if (budgetPlan.income && budgetPlan.income > 0) {
                    return true;
                }
                
                // No income data found
                return false;
            }
              // Unos i praÄ‡enje troĹˇkova - sada koristi pametnu navigaciju
            const expensesBtn = document.querySelector('a[onclick="smartBudgetNavigation()"]');
            if (expensesBtn) {
                // Event je veÄ‡ postavljen preko onclick
                console.log('Smart budget navigation button is ready');
            }
            
            // Moj BudĹľet dugme sada direktno vodi na profil.html - uklonjen modal override
            
            // Finansijski kalkulator
            const calculatorBtn = document.querySelector('button[title="Otvori kalkulator"]');
            if (calculatorBtn) {
                calculatorBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal('calculatorModal');
                });
            }
            // ZakaĹľite konsultacije
            const consultationBtn = document.querySelector('button[onclick*="consultationModal"]');
            if (consultationBtn) {
                consultationBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openModal('consultationModal');
                });
            }
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Prikaz poslednje unetog prihoda u input polju
            const incomeInput = document.getElementById('monthlyIncome');
            if (incomeInput) {
                const plan = JSON.parse(localStorage.getItem('budgetPlan') || '{}');
                if (plan.income) {
                    incomeInput.value = plan.income;
                }
                // Kada korisnik izmeni i saÄŤuva novi prihod, aĹľuriraj localStorage
                incomeInput.addEventListener('change', function() {
                    const newIncome = parseFloat(this.value) || 0;
                    const plan = JSON.parse(localStorage.getItem('budgetPlan') || '{}');
                    plan.income = newIncome;
                    localStorage.setItem('budgetPlan', JSON.stringify(plan));
                });            }
        });
    </script>
    
    <script>        // Counter animation for statistics
        function animateCounters() {
            console.log('Starting counter animation'); // Debug
            const counters = document.querySelectorAll('.stat-number');
            console.log('Found counters:', counters.length); // Debug
            
            counters.forEach(counter => {
                const target = parseInt(counter.getAttribute('data-count'));
                console.log('Animating counter to:', target); // Debug
                const duration = 2000; // 2 seconds
                const increment = target / (duration / 16); // 60fps
                let current = 0;
                
                const updateCounter = () => {
                    if (current < target) {
                        current += increment;
                        if (current > target) current = target;
                        
                        // Add special formatting for large numbers
                        if (target >= 1000) {
                            counter.textContent = Math.floor(current).toLocaleString();
                        } else {
                            counter.textContent = Math.floor(current);
                        }
                        
                        requestAnimationFrame(updateCounter);
                    } else {
                        // Final value with proper formatting
                        if (target >= 1000) {
                            counter.textContent = target.toLocaleString();
                        } else {
                            counter.textContent = target;
                        }
                    }
                };
                
                updateCounter();
            });
        }
        
        // Start animation when stats section comes into view
        const observerOptions = {
            threshold: 0.5,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const statsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animateCounters();
                    statsObserver.unobserve(entry.target); // Only animate once
                }
            });
        }, observerOptions);          // Observe stats section when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            const statsSection = document.querySelector('.stats-section');
            console.log('Stats section found:', statsSection); // Debug
            
            if (statsSection) {
                statsObserver.observe(statsSection);
                
                // Fallback: Animiraj nakon 1 sekunde ako IntersectionObserver ne radi
                setTimeout(() => {
                    const counters = document.querySelectorAll('.stat-number');
                    const hasAnimated = Array.from(counters).some(counter => 
                        parseInt(counter.textContent) > 0
                    );
                    
                    if (!hasAnimated) {
                        console.log('IntersectionObserver fallback - animating counters');
                        animateCounters();
                    }
                }, 1500);
            } else {
                console.log('Stats section not found, trying fallback');
                // Ako ne moĹľe da pronaÄ‘e sekciju, animiraj odmah
                setTimeout(animateCounters, 1000);
            }
        });
        
        // Dodatni fallback - animiraj kada se stranica potpuno uÄŤita
        window.addEventListener('load', function() {
            setTimeout(() => {
                const counters = document.querySelectorAll('.stat-number');
                const hasAnimated = Array.from(counters).some(counter => 
                    parseInt(counter.textContent) > 0
                );
                
                if (!hasAnimated) {
                    console.log('Window load fallback - animating counters');
                    animateCounters();
                }
            }, 2000);        });
    </script>      <!-- Consultation functionality -->
    <script src="js/consultation.js"></script>
    <script src="js/autofill.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/monthlyStats.js"></script>
    <script src="js/imageHandler.js"></script>
      <!-- Chat Support Scripts -->
    <script src="js/support-kb.js"></script>
    <script src="js/support-chat.js"></script>
    
    <!-- Floating Support Button -->
    <button class="floating-support-btn support-btn" title="TehniÄŤka PodrĹˇka">
        đźŽ§
    </button>
    <script>
    // Mobile menu toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuToggle = document.createElement('button');
        mobileMenuToggle.className = 'mobile-menu-toggle';
        mobileMenuToggle.innerHTML = '☰';
        mobileMenuToggle.setAttribute('aria-label', 'Toggle mobile menu');
        
        const navbar = document.querySelector('.navbar');
        if (navbar) {
            navbar.appendChild(mobileMenuToggle);
        }
        
        const navMenu = document.querySelector('.nav-menu');
        
        mobileMenuToggle.addEventListener('click', function() {
            navMenu.classList.toggle('active');
            this.classList.toggle('active');
            
            // Change hamburger to X when active
            this.innerHTML = this.classList.contains('active') ? '✕' : '☰';
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!navbar.contains(e.target)) {
                navMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                mobileMenuToggle.innerHTML = '☰';
            }
        });
        
        // Close mobile menu when window is resized to desktop size
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                navMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                mobileMenuToggle.innerHTML = '☰';
            }
        });
    });
    
    </script>
    <script>
        // Network Status Monitor
    function initNetworkStatusMonitor() {
        const networkStatus = document.getElementById('networkStatus');
        
        function updateNetworkStatus() {
            const isOnline = navigator.onLine;
            const statusIcon = networkStatus.querySelector('i');
            const statusText = networkStatus.querySelector('.status-text');
            
            if (isOnline) {
                networkStatus.className = 'network-status online';
                statusIcon.className = 'fas fa-wifi';
                statusText.textContent = 'Online';
                
                // Show sync notification if data is pending
                if (window.offlineStorage) {
                    window.offlineStorage.getSyncQueue().then(queue => {
                        if (queue.length > 0) {
                            showSyncNotification(queue.length);
                        }
                    });
                }
            } else {
                networkStatus.className = 'network-status offline';
                statusIcon.className = 'fas fa-wifi-slash';
                statusText.textContent = 'Offline';
                
                // Show offline mode notification
                showOfflineNotification();
            }
        }
        
        // Initial status check
        updateNetworkStatus();
        
        // Listen for network changes
        window.addEventListener('online', updateNetworkStatus);
        window.addEventListener('offline', updateNetworkStatus);
        
        // Periodic connectivity check (every 30 seconds)
        setInterval(() => {
            // Try to fetch a small resource to verify real connectivity
            fetch('/manifest.json', { 
                method: 'HEAD',
                cache: 'no-cache',
                mode: 'no-cors'
            }).then(() => {
                if (!navigator.onLine) {
                    // Browser thinks we're offline but we can actually fetch
                    navigator.onLine = true;
                    updateNetworkStatus();
                }
            }).catch(() => {
                if (navigator.onLine) {
                    // Browser thinks we're online but we can't fetch
                    navigator.onLine = false;
                    updateNetworkStatus();
                }
            });
        }, 30000);
    }
    
    function showSyncNotification(pendingItems) {
        const notification = document.createElement('div');
        notification.className = 'sync-notification';
        notification.innerHTML = `
            <div class="sync-content">
                <i class="fas fa-sync-alt"></i>
                <span>Sinhronizovanje ${pendingItems} stavki...</span>
                <button onclick="this.parentElement.parentElement.remove()" class="close-btn">✕</button>
            </div>
        `;
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: #22c55e;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            animation: slideIn 0.3s ease;
        `;
        
        document.body.appendChild(notification);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 5000);
    }
    
    function showOfflineNotification() {
        const notification = document.createElement('div');
        notification.className = 'offline-notification';
        notification.innerHTML = `
            <div class="offline-content">
                <i class="fas fa-wifi-slash"></i>
                <span>Offline režim - promene će biti sinhronizovane kada se vratite online</span>
                <button onclick="this.parentElement.parentElement.remove()" class="close-btn">✕</button>
            </div>
        `;
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: #ef4444;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        `;
        
        document.body.appendChild(notification);
        
        // Auto remove after 10 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 10000);
    }
    
    // Initialize network monitoring when DOM is loaded
    document.addEventListener('DOMContentLoaded', initNetworkStatusMonitor);
    
    </script>
</body>
</html>

