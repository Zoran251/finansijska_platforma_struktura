<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golden Balance | Finansijska platforma</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            /* Enhanced Gold Palette */
            --gold-bright: #FFD700; /* Svetlija zlatna */
            --gold-medium: #D4AF37; /* Osnovna zlatna */
            --gold-dark: #B8860B; /* Tamnija zlatna */
            --gold-pale: #F0E68C; /* Bleda zlatna */
            --gold-glow: rgba(255, 215, 0, 0.3); /* Zlatni sjaj za efekte */
            
            /* Gradijenti */
            --gradient-gold: linear-gradient(135deg, #FFD700, #D4AF37, #B8860B);
            --gradient-gold-light: linear-gradient(135deg, #F0E68C, #FFD700);
            --gradient-gold-dark: linear-gradient(135deg, #B8860B, #8B6914);
            
            /* Tamna paleta */
            --dark-bg: #0A0A0A; /* Tamnija pozadina */
            --dark-card: #121212; /* Tamnija kartica */
            --dark-accent: #1E1E1E; /* Tamni akcent */
            
            /* Tekst */
            --light-text: #FFFFFF; /* Čist beli tekst za bolji kontrast */
            --muted-text: #CCCCCC; /* Svetliji sivi za bolju čitljivost */
            
            /* Dodatni efekti */
            --border-light: rgba(212, 175, 55, 0.3);
            --glass-effect: rgba(255, 215, 0, 0.05);
            --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 6px 20px rgba(0, 0, 0, 0.2);
            --box-shadow-hover: 0 8px 30px rgba(255, 215, 0, 0.15);
            
            /* Dimenzije i razmaci */
            --border-radius: 0.75rem;
            --border-radius-lg: 1.25rem;
            --spacing-xs: 0.5rem;
            --spacing-sm: 0.75rem;
            --spacing-md: 1.25rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
            
            /* Tranzicije */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            color: var(--light-text);
            line-height: 1.7;
            background: var(--dark-bg);
            background-image: 
                radial-gradient(at 20% 20%, rgba(255, 215, 0, 0.05) 0%, transparent 40%),
                radial-gradient(at 80% 80%, rgba(184, 134, 11, 0.05) 0%, transparent 40%);
            position: relative;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Modern Background Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.03) 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.03) 0%, transparent 30%);
            pointer-events: none;
            z-index: -1;
        }

        /* Enhanced background animation */
        @keyframes backgroundAnimation {
            0% {
                transform: scale(1) rotate(0deg);
                opacity: 0.1;
            }
            50% {
                opacity: 0.15;
            }
            100% {
                transform: scale(1.1) rotate(5deg);
                opacity: 0.1;
            }
        }
        
        @keyframes backgroundAnimation {
            0% {
                transform: rotate(0deg) scale(1);
            }
            100% {
                transform: rotate(5deg) scale(1.1);
            }
        }
        
        @keyframes morph {
            0% {
                border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            }
            25% { 
                border-radius: 58% 42% 75% 25% / 76% 46% 54% 24%;
            }
            50% {
                border-radius: 50% 50% 33% 67% / 55% 27% 73% 45%;
            }
            75% {
                border-radius: 33% 67% 58% 42% / 63% 68% 32% 37%;
            }
            100% {
                border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            }
        }

        .container {
            background: rgba(16, 16, 18, 0.3);
            border-radius: var(--border-radius-lg);
            margin: 2rem auto;
            padding: 2.5rem;
            width: 90%;
            max-width: 1200px;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-light);
            backdrop-filter: blur(10px);
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.03), transparent);
            pointer-events: none;
        }

        .chart-container {
            background: rgba(25, 25, 25, 0.98);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            margin-top: var(--spacing-xl);
            border: 1px solid rgba(212, 175, 55, 0.15);
        }

        .section-card {
            background: var(--dark-card);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            transform: translateY(0);
        }
        
        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .section-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, transparent, var(--glass-effect));
            border-radius: 0 0 0 100%;
            pointer-events: none;
            opacity: 0.5;
        }

        /* Navigation Header */
        .nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 2rem;
            background: rgba(10, 10, 12, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(212, 175, 55, 0.15);
        }

        .brand {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: #f8f8f8;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.3s ease;
        }
        
        .logo img {
            height: 40px;
            width: auto;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
        }
        
        .logo:hover img {
            filter: drop-shadow(0 0 15px rgba(212, 175, 55, 0.5));
        }

        .brand i {
            font-size: 1.8rem;
            background: linear-gradient(45deg, #2563eb, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        button, .button {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            background: var(--gradient-gold);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
            z-index: 1;
            letter-spacing: 0.5px;
        }
        
        button:hover, .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.1);
        }
        
        button:active, .button:active {
            transform: translateY(0);
        }
        
        button::before, .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, rgba(255,255,255,0), rgba(255,255,255,0.2), rgba(255,255,255,0));
            transform: translateX(-100%);
            transition: transform 0.6s ease;
            z-index: -1;
        }
        
        button:hover::before, .button:hover::before {
            transform: translateX(100%);
        }

        .ai-chat-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: white;
            padding: 0.5rem 1.2rem;
            border: none;
            border-radius: 2rem;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            text-decoration: none;
            white-space: nowrap;
        }

        .ai-chat-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .ai-chat-button i {
            font-size: 1.2rem;
        }

        /* AI Chat Interface */
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 320px;
            height: 400px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 1000;
            transform: translateY(120%);
            transition: transform 0.3s ease;
        }

        .chat-container.active {
            transform: translateY(0);
        }

        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: linear-gradient(45deg, #2563eb, #059669);
            color: white;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .close-chat {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .bot-message {
            align-self: flex-start;
            background: #f0f0f0;
            border-bottom-left-radius: 5px;
        }

        .user-message {
            align-self: flex-end;
            background: linear-gradient(45deg, #2563eb, #059669);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .chat-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        .chat-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-size: 0.9rem;
        }

        .send-button {
            background: linear-gradient(45deg, #2563eb, #059669);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-group {
            background: rgba(255, 255, 255, 0.9);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            max-width: 500px;
        }

        /* Background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            opacity: 0.1;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(34, 197, 94, 0.1) 0%, transparent 50%);
        }

        /* Hero section enhancement */
        .hero-section {
            background: linear-gradient(135deg, #f8fafc 0%, #f0f9ff 100%);
            padding: var(--spacing-xl) 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.05) 0%, transparent 40%);
            z-index: -1;
            opacity: 0.8;
        }

        .hero-title {
            font-size: 3.75rem;
            font-weight: 800;
            margin-bottom: var(--spacing-md);
            background: linear-gradient(45deg, #FFD700, #D4AF37, #B8860B);
            -webkit-background-clip: text;
            -moz-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
            letter-spacing: -0.02em;
            line-height: 1.2;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-description {
            font-size: 1.25rem;
            color: var(--muted-text);
            margin-bottom: var(--spacing-xl);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            padding: var(--spacing-md);
            background: rgba(30, 30, 30, 0.7);
            border-radius: var(--border-radius);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);
            border: 1px solid rgba(255, 215, 0, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            line-height: 1.7;
        }

        .button-group {
            display: flex;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
            justify-content: center;
            margin-top: var(--spacing-xl);
        }

        .primary-button {
            padding: 1rem 2.5rem;
            background: linear-gradient(45deg, #FFD700, #D4AF37);
            color: #1a1a1a;
            border: none;
            font-weight: 600;
            border-radius: 50px;
            position: relative;
            overflow: hidden;
            z-index: 1;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.2);
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        .primary-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(212, 175, 55, 0.2), 0 3px 6px rgba(212, 175, 55, 0.15);
            background: linear-gradient(45deg, #FFC107, #D4AF37);
            box-shadow: 0 6px 15px rgba(59, 130, 246, 0.2);
        }
        
        .submit-button {
            background: linear-gradient(45deg, #2563eb, #059669);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 1rem;
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
            width: 100%;
            margin-top: var(--spacing-md);
        }
        
        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(37, 99, 235, 0.3);
        }
        
        .submit-button i {
            font-size: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: var(--spacing-xl);
            max-width: 600px;
            margin: 2rem auto;
            position: relative;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(5px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
        }

        .hero-section {
            padding: var(--spacing-xl) 0;
            text-align: center;
            max-width: 1200px;
            margin: 0 auto;
            color: #fff;
            background: linear-gradient(135deg, #0a0a0c 0%, #1a1a1f 100%);
            border-radius: 16px;
            padding: 3rem 2rem;
            margin: 2rem auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.15);
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: var(--spacing-md);
            background: linear-gradient(45deg, #ffd700, #d4af37);
            background-clip: text;
            -webkit-background-clip: text;
            -moz-background-clip: text;
            -o-background-clip: text;
            -webkit-text-fill-color: transparent;
            -moz-text-fill-color: transparent;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hero-description {
            font-size: 1.25rem;
            color: #d4d4d8;
            margin-bottom: var(--spacing-xl);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
            padding: 0 1rem;
            perspective: 1000px;
        }
        
        .feature-card {
            background: linear-gradient(145deg, #1e1e24, #2a2a32);
            border-radius: 1rem;
            padding: 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(212, 175, 55, 0.2);
            text-align: left;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2), 0 6px 6px rgba(0, 0, 0, 0.23), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d4af37, #f1c40f, #d4af37);
            transform: translateY(-4px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .feature-card:hover {
            transform: translateY(-8px) rotateX(5deg) rotateY(5deg);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3), 0 12px 12px rgba(0, 0, 0, 0.25);
            border-color: rgba(212, 175, 55, 0.4);
            -webkit-background-clip: padding-box;
            background-clip: padding-box;
        }
        
        .feature-card:hover::before {
            transform: translateY(0);
        }
        
        .feature-card i {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #d4af37, #f1c40f);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            margin-bottom: 1.5rem;
            display: inline-block;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .feature-card h3 {
            color: #f8f8f8;
            margin-bottom: 1rem;
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .feature-card p {
            color: #a1a1aa;
            font-size: 1rem;
            line-height: 1.7;
            margin: 0;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
        }

        .button-group {
            display: flex;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
            justify-content: center;
            margin-top: var(--spacing-xl);
        }

        .primary-button {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #d4af37 0%, #f1c40f 100%);
            color: #1a1a1f !important;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            min-width: 200px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.2);
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.3);
            z-index: 1;
        }

        .primary-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #f1c40f 0%, #d4af37 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
            border-radius: 50px;
        }

        .primary-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
            color: #1a1a1a;
        }

        .primary-button:hover::before {
            opacity: 1;
        }

        .primary-button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 10px rgba(212, 175, 55, 0.3);
        }

        .primary-button i {
            color: #1a1a1f;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .primary-button:hover i {
            transform: scale(1.1);
        }

        .primary-button:active {
            transform: translateY(0);
        }

        .primary-button i {
            font-size: 1.25rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
            padding: 1rem;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            box-sizing: border-box;
        }
        
        /* Prevent body scroll when modal is open */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            max-height: calc(100vh - 2rem);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }
        
        /* Make sure the modal is scrollable on mobile */
        @media (max-width: 768px) {
            .modal {
                padding: 0.5rem;
                align-items: stretch;
                justify-content: flex-start;
                display: flex;
                flex-direction: column;
            }
            
            .modal-content {
                max-height: calc(100vh - 1rem);
                padding: 1.25rem 1rem;
                margin: 0.5rem auto;
                width: 100%;
                flex: 0 1 auto;
                border-radius: 0.75rem;
            }
            
            /* Ensure form elements are properly sized on mobile */
            .form-group {
                margin-bottom: 1rem;
            }
            
            input, select, textarea {
                padding: 0.75rem 1rem;
                font-size: 1rem;
                width: 100%;
                box-sizing: border-box;
            }
            
            /* Fix for iOS zoom on input focus */
            @supports (-webkit-overflow-scrolling: touch) {
                input, select, textarea {
                    font-size: 16px; /* Prevent iOS zoom */
                    color: #000000;
                }
            }
            
            /* Ensure buttons are tappable on mobile */
            button, input[type="submit"] {
                min-height: 44px; /* Minimum touch target size */
            }
        }

        .close-modal {
            position: absolute;
            right: var(--spacing-md);
            top: var(--spacing-md);
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--secondary-color);
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--primary-color);
        }

        .upload-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .upload-input {
            padding: var(--spacing-md);
            border: 2px dashed #e2e8f0;
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: white;
        }

        .upload-input:hover {
            background-color: #f8fafc;
            border-color: var(--primary-color);
        }

        .budget-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .calculator-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .input-group {
            display: flex;
            gap: var(--spacing-md);
            flex-direction: column;
        }

        .form-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
            letter-spacing: 0.01em;
        }

        input, select {
            padding: 0.8rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-family: inherit;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s ease;
            background-color: #f9fafc;
            color: #000000;
        }
        
        /* Keep financial calculator inputs larger */
        .calculator-section input {
            padding: var(--spacing-lg);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .result {
            padding: var(--spacing-xl);
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--border-radius);
            margin-top: var(--spacing-lg);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(5px);
        }

        .result h3 {
            margin-bottom: var(--spacing-lg);
            color: var(--text-color);
        }

        .result-container {
            margin-top: var(--spacing-lg);
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }

        .result span {
            font-weight: 600;
            color: var(--primary-color);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            margin-top: var(--spacing-xl);
            backdrop-filter: blur(5px);
        }

        .note {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--secondary-color);
            font-size: 0.9rem;
            padding: var(--spacing-md);
            background: rgba(243, 244, 246, 0.9);
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(5px);
            margin-top: var(--spacing-md);
        }

        .note i {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .button-group {
                flex-direction: column;
                align-items: center;
            }

            .modal-content {
                padding: var(--spacing-md);
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .form-group label {
                font-size: 1rem;
            }

            .primary-button {
                width: 100%;
                min-width: auto;
            }
        }

        /* Plutajući chat bot stilovi */
        .floating-chat-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #D4AF37, #FFD700);
            border: none;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.4);
            cursor: pointer;
            z-index: 1001;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }
        
        .floating-chat-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(212, 175, 55, 0.6);
        }
        
        .floating-chat-btn i {
            font-size: 24px;
            color: #1a1a1a;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 4px 20px rgba(212, 175, 55, 0.4);
            }
            50% {
                box-shadow: 0 4px 20px rgba(212, 175, 55, 0.8);
            }
            100% {
                box-shadow: 0 4px 20px rgba(212, 175, 55, 0.4);
            }
        }
        
        .chat-container {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 380px;
            height: 500px;
            max-height: 80vh;
            background: rgba(18, 18, 22, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .chat-container.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(45deg, #D4AF37, #FFD700);
            color: #1a1a1a;
            font-weight: 600;
        }
        
        .chat-header h3 {
            margin: 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .close-chat {
            background: none;
            border: none;
            color: #1a1a1a;
            cursor: pointer;
            font-size: 1.2rem;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .close-chat:hover {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            background: var(--dark-bg);
        }
        
        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.9rem;
            line-height: 1.4;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: var(--light-text);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            background: rgba(212, 175, 55, 0.5);
            color: var(--dark-bg);
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .chat-input {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(22, 22, 26, 0.8);
            border-top: 1px solid var(--border-light);
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid var(--border-light);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.9);
            color: #000000;
            font-size: 0.95rem;
        }
        
        .chat-input input:focus {
            outline: none;
            border-color: var(--gold-medium);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.2);
        }
        
        .chat-input input::placeholder {
            color: var(--muted-text);
        }
        
        .send-button {
            background: var(--gradient-gold);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-left: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--dark-bg);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4);
        }
        
        /* Chat suggestion buttons */
        .chat-suggestion-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .chat-suggestion {
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 18px;
            padding: 8px 15px;
            font-size: 0.9rem;
            color: var(--light-text);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .chat-suggestion:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: translateY(-1px);
        }
        
        .typing {
            color: #888;
            font-style: italic;
        }
        
        /* Responsive design za chat */
        @media (max-width: 768px) {
            .floating-chat-btn {
                bottom: 20px;
                right: 20px;
                width: 55px;
                height: 55px;
            }
            
            .chat-container {
                width: calc(100vw - 40px);
                height: 70vh;
                right: 20px;
                bottom: 85px;
            }
        }
    </style>
</head>
<body>
    <!-- Modern Navigation Header -->
    <header class="nav-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 2.5rem; background: rgba(10, 10, 12, 0.95); backdrop-filter: blur(10px); box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2); position: fixed; top: 0; z-index: 1000; border-bottom: 1px solid rgba(212, 175, 55, 0.15);">
        <div class="brand" style="font-size: 1.6rem; font-weight: 800; display: flex; align-items: center; gap: 1.2rem; cursor: pointer;" onclick="window.location.href='#'">
            <img id="siteLogo" src="https://i.imgur.com/yQGiMd5.png" alt="Golden Balance Logo" style="height: 60px; width: auto; display: block;">
            <span style="background: var(--gradient-gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Golden Balance</span>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOM loaded - logo će se učitati kroz updateUI funkciju');
                
                // Storage event listener za logo promene iz admin panela
                window.addEventListener('storage', function(e) {
                    if (e.key === 'site_logo' && e.newValue) {
                        const logoElement = document.getElementById('siteLogo');
                        if (logoElement) {
                            logoElement.src = e.newValue;
                            console.log('✅ Logo ažuriran iz admin panela preko storage event');
                        }
                    }
                });
                
                // Provera da li je korisnik administrator
                const adminEmail = 'zorandostica2@gmail.com';
                const loggedInUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const isAdmin = loggedInUser.email === adminEmail || localStorage.getItem('admin_logged_in') === 'true';
                
                // Prikaz admin dugmeta samo ako je korisnik administrator
                const adminBtn = document.getElementById('adminSettingsBtn');
                if (adminBtn) {
                    if (isAdmin) {
                        adminBtn.style.display = 'block';
                    } else {
                        // Osigurajmo da je dugme skriveno ako korisnik nije admin
                        adminBtn.style.display = 'none';
                    }
                }
                
                // Dodavanje hover animacije za zupčanik
                const spinIcon = document.querySelector('.fa-spin-hover');
                if (spinIcon) {
                    spinIcon.addEventListener('mouseover', function() {
                        this.classList.add('fa-spin');
                    });
                    spinIcon.addEventListener('mouseout', function() {
                        this.classList.remove('fa-spin');
                    });
                }
                
                // Provera da li treba otvoriti register modal
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('register') === 'true') {
                    // Otvaramo register modal nakon što se stranica učita
                    setTimeout(function() {
                        const registerModal = document.getElementById('registerModal');
                        if (registerModal) {
                            registerModal.style.display = 'block';
                        }
                    }, 100);
                }
            });
        </script>
        
        <!-- Action Buttons -->
        <div class="header-actions" style="display: flex; gap: 1.2rem; align-items: center;">
            <!-- Admin Settings Button (Initially Hidden) -->
            <a href="admin.html" id="adminSettingsBtn" style="display: none; text-decoration: none;">
                <button class="ai-chat-button" style="background: var(--gradient-gold-dark); border: none; padding: 0.7rem 1.3rem; border-radius: var(--border-radius); display: flex; align-items: center; gap: 0.5rem; transition: all 0.3s ease; box-shadow: var(--box-shadow); font-weight: 500; color: white; transform: translateY(0);" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    <i class="fas fa-cog fa-spin-hover"></i>
                    <span>Admin Panel</span>
                </button>
            </a>
            
            <!-- Notification Bell Button -->
            <div class="notification-bell-container" style="position: relative; margin-right: 0.5rem;">
                <button id="notificationBtn" style="background: transparent; border: none; padding: 0.7rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; position: relative; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                    <i class="fas fa-bell" style="color: var(--gold-bright); font-size: 1.2rem;"></i>
                    <span class="notification-badge" style="position: absolute; top: 0.2rem; right: 0.2rem; background-color: #D4AF37; color: #0E0E10; font-size: 0.7rem; font-weight: bold; width: 1.2rem; height: 1.2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; display: none;">0</span>
                </button>
                
                <!-- Notification Dropdown -->
                <div id="notificationDropdown" class="notification-dropdown" style="display: none; position: absolute; top: 100%; right: 0; width: 300px; background: rgba(14, 14, 16, 0.95); border: 1px solid var(--gold-dark); border-radius: var(--border-radius); box-shadow: var(--box-shadow); z-index: 1000; margin-top: 0.5rem;">
                    <style>
                        /* Stilovi za notifikacije */
                        .notification-list {
                            max-height: 280px; /* smanjena visina da se vidi skrolbar */
                            overflow-y: scroll !important; /* forsiramo skrol */
                            scrollbar-width: thin;
                            scrollbar-color: #D4AF37 rgba(14, 14, 16, 0.3);
                            -webkit-overflow-scrolling: touch;
                            display: block !important;
                        }
                        .notification-list::-webkit-scrollbar {
                            width: 5px;
                            display: block !important;
                        }
                        .notification-list::-webkit-scrollbar-track {
                            background: rgba(14, 14, 16, 0.3);
                            border-radius: 3px;
                            display: block !important;
                        }
                        .notification-list::-webkit-scrollbar-thumb {
                            background-color: #D4AF37;
                            border-radius: 3px;
                            display: block !important;
                        }
                        .notification-item {
                            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
                            padding: 0.8rem 1rem;
                            display: flex;
                            gap: 0.8rem;
                            align-items: flex-start;
                            transition: background 0.2s ease;
                            cursor: pointer;
                        }
                        .notification-item:hover {
                            background: rgba(212, 175, 55, 0.1);
                        }
                    </style>
                    <div style="padding: 1rem; border-bottom: 1px solid var(--gold-dark); display: flex; justify-content: space-between; align-items: center; background: rgba(14, 14, 16, 0.95); z-index: 2; position: sticky; top: 0;">
                        <h4 style="margin: 0; color: var(--light-text);">Notifikacije</h4>
                        <button id="markAllRead" style="background: rgba(212, 175, 55, 0.1); border: 1px solid var(--gold-dark); border-radius: 4px; color: var(--gold-bright); cursor: pointer; font-size: 0.8rem; padding: 0.3rem 0.7rem; transition: all 0.2s ease;" onmouseover="this.style.background='rgba(212, 175, 55, 0.2)'; this.style.transform='translateY(-1px)';" onmouseout="this.style.background='rgba(212, 175, 55, 0.1)'; this.style.transform='translateY(0)';">
                            <i class="fas fa-check-double" style="margin-right: 4px; font-size: 0.75rem;"></i>Označi sve kao pročitano
                        </button>
                    </div>
                    <div class="notification-list" id="notificationList">
                        <div class="notification-item" data-id="notif1" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-chart-line" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Novi finansijski izveštaj</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Vaš mesečni izveštaj je dostupan za pregled</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 5 minuta</span>
                            </div>
                        </div>
                        <div class="notification-item" data-id="notif2" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-calendar-alt" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Podsetnik za plaćanje</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Vaša rata kredita dospeva za 2 dana</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">danas</span>
                            </div>
                        </div>
                        <div class="notification-item" data-id="notif3" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-gift" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Posebna ponuda</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Ekskluzivna ponuda za štednju sa 5% kamatom</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">juče</span>
                            </div>
                        </div>
                        
                        <!-- Dodatne notifikacije za demonstraciju scrollovanja -->
                        <div class="notification-item" data-id="notif4" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-percentage" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Ažuriranje kamatnih stopa</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Nove kamatne stope za štednju od narednog meseca</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 2 dana</span>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-id="notif5" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-user-shield" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Bezbednosno ažuriranje</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Promenite vašu lozinku radi bolje zaštite naloga</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 3 dana</span>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-id="notif6" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-coins" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Investiciona prilika</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Nova investiciona prilika: obveznice sa prinosom od 4.5%</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 5 dana</span>
                            </div>
                        </div>
                        
                        <!-- Dodatne notifikacije za osiguravanje skrolovanja -->
                        <div class="notification-item" data-id="notif7" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-university" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Bankarsko obaveštenje</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Nove pogodnosti za korisnike Gold paketa bankarskih usluga. Proverite sve detalje u najbližoj filijali.</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 6 dana</span>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-id="notif8" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer;" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                            <div style="background: rgba(212, 175, 55, 0.2); width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas fa-shield-alt" style="color: var(--gold-bright);"></i>
                            </div>
                            <div>
                                <p style="margin: 0 0 0.3rem 0; font-weight: 500; color: var(--light-text);">Preporuke za osiguranje</p>
                                <p style="margin: 0; font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Na osnovu vaših prihoda i imovine, pripremili smo personalizovane preporuke za osiguranje. Pogledajte detalje u sekciji "Osiguranje".</p>
                                <span style="font-size: 0.7rem; color: var(--gold-bright); display: block; margin-top: 0.3rem;">pre 7 dana</span>
                            </div>
                        </div>
                    </div>
                    <div style="padding: 0.8rem; text-align: center; border-top: 1px solid var(--gold-dark); background: rgba(14, 14, 16, 0.95);">
                        <a href="#" style="color: var(--gold-bright); text-decoration: none; font-size: 0.9rem;">Prikaži sve notifikacije</a>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Link to Profile -->
            <a href="profile.html" style="text-decoration: none;" onclick="localStorage.setItem('activeProfileTab', '0'); return true;">
                <button class="ai-chat-button" style="background: transparent; border: 1px solid var(--gold-dark); padding: 0.7rem 1.3rem; border-radius: var(--border-radius); display: flex; align-items: center; gap: 0.5rem; transition: all 0.3s ease; font-weight: 500; color: var(--light-text); transform: translateY(0);" onmouseover="this.style.transform='translateY(-2px)'; this.style.background='rgba(212, 175, 55, 0.1)';" onmouseout="this.style.transform='translateY(0)'; this.style.background='transparent';">
                    <i class="fas fa-user" style="color: var(--gold-bright);"></i>
                    <span>Profil</span>
                </button>
            </a>
            
            <!-- When user is not logged in -->
            <div id="guestUser" class="auth-buttons" style="display: flex; gap: 1rem; align-items: center;">
                <button class="ai-chat-button" id="loginBtn" style="background: var(--dark-accent); border: 1px solid var(--gold-medium); padding: 0.7rem 1.3rem; border-radius: var(--border-radius); display: flex; align-items: center; gap: 0.5rem; transition: all 0.3s ease; box-shadow: var(--box-shadow); font-weight: 500; color: var(--gold-pale); transform: translateY(0);" onmouseover="this.style.transform='translateY(-2px)'; this.style.borderColor='var(--gold-bright)';" onmouseout="this.style.transform='translateY(0)'; this.style.borderColor='var(--gold-medium)';">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Prijava</span>
                </button>
                <button class="ai-chat-button" id="registerBtn" style="background: var(--gradient-gold-dark); border: none; padding: 0.7rem 1.3rem; border-radius: var(--border-radius); display: flex; align-items: center; gap: 0.5rem; transition: all 0.3s ease; box-shadow: var(--box-shadow); font-weight: 500; color: white; transform: translateY(0);" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    <i class="fas fa-user-plus"></i>
                    <span>Registracija</span>
                </button>
            </div>
            
            <!-- When user is logged in -->
            <div id="loggedInUser" class="logged-in-user" style="display: none; margin-left: 1rem;">
                <div class="profile-pic-container" style="position: relative;">
                    <img id="userProfilePic" src="https://via.placeholder.com/40" alt="Profilna slika" class="profile-pic" style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 2px solid #e2e8f0;" onclick="toggleProfileDropdown()">
                    <div id="profileDropdown" class="profile-dropdown" style="display: none; position: absolute; right: 0; top: 100%; background: white; min-width: 240px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 0.5rem; overflow: hidden; z-index: 1000;">
                        <div class="dropdown-header" style="padding: 0.75rem 1rem; background: #f8fafc; border-bottom: 1px solid #f1f5f9;">
                            <div style="font-weight: 600; font-size: 0.9rem;" id="dropdownUserName">Ime Prezime</div>
                            <div style="font-size: 0.8rem; color: #64748b;" id="dropdownUserEmail">email@example.com</div>
                        </div>
                        <a href="profile.html" class="dropdown-item" id="navProfileLink" style="display: flex; align-items: center; padding: 0.75rem 1rem; color: #1a1a1a; text-decoration: none; transition: background 0.2s; font-size: 0.9rem; border-bottom: 1px solid #f1f5f9;">
                            <i class="fas fa-user-edit" style="width: 20px; margin-right: 0.5rem; color: #3b82f6;"></i> Moj Profil
                        </a>
                        <a href="profile.html" class="dropdown-item" id="navBudgetLink" style="display: flex; align-items: center; padding: 0.75rem 1rem; color: #1a1a1a; text-decoration: none; transition: background 0.2s; font-size: 0.9rem; border-bottom: 1px solid #f1f5f9;">
                            <i class="fas fa-wallet" style="width: 20px; margin-right: 0.5rem; color: #10b981;"></i> Moj Budžet
                        </a>
                        <a href="profile.html" class="dropdown-item" id="navSettingsLink" style="display: flex; align-items: center; padding: 0.75rem 1rem; color: #1a1a1a; text-decoration: none; transition: background 0.2s; font-size: 0.9rem; border-bottom: 1px solid #f1f5f9;">
                            <i class="fas fa-cog" style="width: 20px; margin-right: 0.5rem; color: #6b7280;"></i> Podešavanja
                        </a>
                        <div style="padding: 0.5rem 1rem; border-top: 1px solid #f1f5f9;">
                            <a href="#" id="logoutBtn" class="dropdown-item" style="display: flex; align-items: center; padding: 0.5rem 0; color: #dc2626; text-decoration: none; font-size: 0.9rem; font-weight: 500;">
                                <i class="fas fa-sign-out-alt" style="width: 20px; margin-right: 0.5rem;"></i> Odjava
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            // Button click handlers
            document.getElementById('loginBtn')?.addEventListener('click', () => {
                document.getElementById('loginModal').style.display = 'block';
            });
            
            document.getElementById('registerBtn')?.addEventListener('click', () => {
                document.getElementById('registerModal').style.display = 'block';
            });
            
            document.getElementById('supportBtn')?.addEventListener('click', () => {
                // Otvori plutajući chat umesto modala
                window.toggleChat();
            });
            
            // Toggle profile dropdown
            function toggleProfileDropdown() {
                const dropdown = document.getElementById('profileDropdown');
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
            
            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                const dropdown = document.getElementById('profileDropdown');
                const profilePic = document.getElementById('userProfilePic');
                if (dropdown && !dropdown.contains(e.target) && e.target !== profilePic) {
                    dropdown.style.display = 'none';
                }
            });
        </script>
    </header>
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content auth-modal">
            <span class="close-modal">&times;</span>
            <h2><i class="fas fa-sign-in-alt"></i> Prijava</h2>
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email adresa</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Lozinka</label>
                    <div class="password-input">
                        <input type="password" id="loginPassword" name="loginPassword" required autocomplete="off">
                        <button type="button" class="toggle-password" onclick="togglePassword('loginPassword')">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-footer">
                    <label class="remember-me">
                        <input type="checkbox" id="rememberMe"> Zapamti me
                    </label>
                    <a href="#" class="forgot-password">Zaboravili ste lozinku?</a>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Prijavi se</button>
                <div class="divider">ili se prijavite sa</div>
                <div class="social-login">
                    <button type="button" class="btn btn-google">
                        <i class="fab fa-google"></i> Google
                    </button>
                    <button type="button" class="btn btn-facebook">
                        <i class="fab fa-facebook-f"></i> Facebook
                    </button>
                </div>
                <p class="auth-switch">Nemate nalog? <a href="#" id="showRegister">Registrujte se</a></p>
            </form>
        </div>
    </div>
    
    <!-- Registration Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content auth-modal">
            <span class="close-modal">&times;</span>
            <h2><i class="fas fa-user-plus"></i> Registracija</h2>
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label for="regFullName">Ime i prezime</label>
                    <input type="text" id="regFullName" required>
                </div>
                <div class="form-group">
                    <label for="regEmail">Email adresa</label>
                    <input type="email" id="regEmail" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Lozinka</label>
                    <div class="password-input">
                        <input type="password" id="regPassword" name="regPassword" required autocomplete="off">
                        <button type="button" class="toggle-password" onclick="togglePassword('regPassword')">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-strength">
                        <div class="strength-bar"></div>
                        <span class="strength-text">Jačina lozinke: <span id="strengthText">Slaba</span></span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="regConfirmPassword">Potvrdi lozinku</label>
                    <input type="password" id="regConfirmPassword" name="regConfirmPassword" required autocomplete="off">
                </div>
                <div class="form-group">
                    <label class="profile-picture-upload">
                        <input type="file" id="profilePictureUpload" accept="image/*" style="display: none;">
                        <i class="fas fa-camera"></i> <span>Dodajte profilnu sliku</span>
                    </label>
                    <div id="previewContainer" class="preview-container" style="display: none;">
                        <img id="imagePreview" src="" alt="Preview">
                        <button type="button" id="removeImage" class="remove-image">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group terms">
                    <label class="checkbox-container">
                        <input type="checkbox" id="agreeTerms" required>
                        <span class="checkmark"></span>
                        Prihvatam <a href="#" class="terms-link">uslove korišćenja</a> i 
                        <a href="#" class="terms-link">politiku privatnosti</a>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Registruj se</button>
                <p class="auth-switch">Već imate nalog? <a href="#" id="showLogin">Prijavite se</a></p>
            </form>
        </div>
    </div>

    <div class="container">
        <div class="hero-section">
            <h1 class="hero-title">Optimizujte vaše finansije uz našu pomoć.</h1>
            <p class="hero-description">
                Dobrodošli u Golden Balance - vašeg pouzdanog partnera u upravljanju ličnim finansijama. 
                Naša platforma vam pruža sve što vam je potrebno da postignete finansijsku stabilnost i sigurnost.
            </p>
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fas fa-chart-pie"></i>
                    <h3>Pratite troškove</h3>
                    <p>Pratite sve vaše troškove na jednom mestu i identifikujte gde možete uštedeti.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-coins"></i>
                    <h3>Ušteda i štednja</h3>
                    <p>Postavite ciljeve štednje i pratite vaš napredak ka njihovom ostvarenju.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-chart-line"></i>
                    <h3>Pametno investiranje</h3>
                    <p>Koristite naše alate za praćenje i analizu vaših investicija.</p>
                </div>
            </div>
        </div>
        
        <!-- Sadržaj je premešten u modal prozor -->
        
            <div class="button-group">
                <a href="profile.html" class="primary-button" style="text-decoration: none; text-align: center;" id="personalFinanceBtn">
                    <i class="fas fa-wallet"></i>
                    Lične finansije
                </a>
                <a href="profile.html" class="primary-button" style="text-decoration: none; text-align: center;" id="budgetTrackingBtn">
                    <i class="fas fa-chart-bar"></i>
                    Praćenje budžeta
                </a>
                <button class="primary-button" onclick="openModal('calculatorModal')">
                    <i class="fas fa-calculator"></i>
                    Finansijski kalkulator
                </button>

                <button class="primary-button" onclick="openModal('consultationModal')">
                    <i class="fas fa-calendar-check"></i>
                    Zakažite konsultacije
                </button>
            </div>
        </div>
    </div>

    <!-- Statistike sa animacijom brojčanika -->
    <section style="background: var(--dark-bg); padding: var(--spacing-xl) 0; position: relative; overflow: hidden; margin-top: 0.5rem;">
        <!-- Hero-style background effect -->
        <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%), radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.05) 0%, transparent 40%); z-index: -1; opacity: 0.8;"></div>
        
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: var(--spacing-md);">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; text-align: center;">
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h3 id="counterUsers" style="font-size: 3rem; font-weight: 800; background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);">0</h3>
                    <p style="color: var(--muted-text); font-size: 1rem; margin-top: 0.5rem;">Aktivnih korisnika</p>
                </div>
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h3 style="font-size: 3rem; font-weight: 800; background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);">98%</h3>
                    <p style="color: var(--muted-text); font-size: 1rem; margin-top: 0.5rem;">Zadovoljnih korisnika</p>
                </div>
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h3 style="font-size: 3rem; font-weight: 800; background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);">24/7</h3>
                    <p style="color: var(--muted-text); font-size: 1rem; margin-top: 0.5rem;">Podrška dostupna</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Modals -->
    <div id="uploadModal" class="modal">
        <div class="modal-content" style="max-width: 650px;">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            
            <!-- Step 1: Financial Information -->
            <div id="financialInfoStep" class="form-step active">
                <h2><i class="fas fa-file-invoice-dollar"></i> Unos finansijskih podataka</h2>
                <p class="form-description">Unesite vaše osnovne finansijske podatke kako bismo vam pomogli sa analizom.</p>
                
                <div class="form-group">
                    <label for="monthlyIncome">Mesečni prihodi (RSD)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-wallet"></i>
                        <input type="number" id="monthlyIncome" placeholder="Unesite iznos" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="monthlyExpenses">Mesečni troškovi (RSD)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-shopping-cart"></i>
                        <input type="number" id="monthlyExpenses" placeholder="Unesite iznos" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Kategorije troškova (opciono)</label>
                    <div id="expenseCategories">
                        <!-- Dynamic expense categories will be added here -->
                    </div>
                    <button type="button" class="btn-outline" onclick="addExpenseCategory()" style="margin-top: 0.5rem;">
                        <i class="fas fa-plus"></i> Dodaj kategoriju
                    </button>
                </div>
                
                <div class="form-actions" style="margin-top: 2rem;">
                    <button type="button" class="btn btn-primary" onclick="showGoalsSection()" style="width: 100%;">
                        Dalje <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Financial Goals -->
            <div id="goalsStep" class="form-step" style="display: none;">
                <h2><i class="fas fa-bullseye"></i> Vaši finansijski ciljevi</h2>
                <p class="form-description">Izaberite ciljeve koje želite da postignete kako bismo vam pomogli da ih ostvarite.</p>
                
                <div class="goals-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 1.5rem 0;">
                    <div class="goal-card" data-goal="savings" onclick="selectGoal(this)" style="padding: 1.5rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fas fa-piggy-bank" style="font-size: 2rem; color: #3b82f6; margin-bottom: 0.5rem;"></i>
                        <div>Štednja</div>
                    </div>
                    <div class="goal-card" data-goal="investment" onclick="selectGoal(this)" style="padding: 1.5rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fas fa-chart-line" style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;"></i>
                        <div>Investiranje</div>
                    </div>
                    <div class="goal-card" data-goal="property" onclick="selectGoal(this)" style="padding: 1.5rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fas fa-home" style="font-size: 2rem; color: #8b5cf6; margin-bottom: 0.5rem;"></i>
                        <div>Kupovina stana/kuće</div>
                    </div>
                    <div class="goal-card" data-goal="retirement" onclick="selectGoal(this)" style="padding: 1.5rem; border: 2px solid #e2e8f0; border-radius: 0.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                        <i class="fas fa-umbrella-beach" style="font-size: 2rem; color: #f59e0b; margin-bottom: 0.5rem;"></i>
                        <div>Penziono osiguranje</div>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 1.5rem;">
                    <label for="goalDescription">Detaljnije opišite vaše ciljeve (opciono)</label>
                    <textarea id="goalDescription" rows="3" placeholder="Šta želite da postignete? Kada? Koliko vam je novca potrebno?" style="width: 100%; padding: 0.75rem; border: 1px solid #e2e8f0; border-radius: 0.5rem; font-family: inherit; resize: vertical; min-height: 100px; background-color: #f9fafc; color: #000000;"></textarea>
                </div>
                
                <div class="form-actions" style="display: flex; justify-content: space-between; margin-top: 2rem;">
                    <button type="button" class="btn btn-outline" onclick="backToFinancialInfo()">
                        <i class="fas fa-arrow-left"></i> Nazad
                    </button>
                    <button type="button" class="btn btn-primary" onclick="submitFinancialData()">
                        Potvrdi i pošalji <i class="fas fa-check"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Results & Advisor -->
            <div id="resultsStep" class="form-step" style="display: none; text-align: center;">
                <div style="font-size: 4rem; color: #10b981; margin: 1rem 0;">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>Hvala na unosu podataka!</h2>
                <p class="form-description">Na osnovu unetih podataka, evo vaše finansijske analize i preporuka.</p>
                
                <div style="background: #f8fafc; border-radius: 0.5rem; padding: 1.5rem; margin: 2rem 0; text-align: left;">
                    <h3 style="margin-top: 0; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.75rem; margin-bottom: 1.25rem; color: #1e293b;">Pregled vaših finansija</h3>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem;">
                        <span>Mesečni prihodi:</span>
                        <strong id="summaryIncome">0 RSD</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.75rem;">
                        <span>Mesečni troškovi:</span>
                        <strong id="summaryExpenses">0 RSD</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 1rem; padding-top: 0.75rem; border-top: 1px solid #e2e8f0; font-size: 1.1rem; color: #1e293b; font-weight: 600;">
                        <span>Raspoloživo mesečno:</span>
                        <strong id="summaryAvailable">0 RSD</strong>
                    </div>
                </div>
                
                <div style="background: #f0fdf4; border-left: 4px solid #10b981; padding: 1rem; margin: 2rem 0; text-align: left; border-radius: 0 0.5rem 0.5rem 0;">
                    <h3 style="margin-top: 0; margin-bottom: 0.5rem; color: #065f46; font-size: 1.1rem;">
                        <i class="fas fa-lightbulb" style="margin-right: 0.5rem;"></i> Naša preporuka
                    </h3>
                    <p id="recommendationText" style="margin: 0; color: #065f46; line-height: 1.5;">
                        Na osnovu vaših ciljeva, preporučujemo vam da zakažete sastanak sa finansijskim savetnikom kako biste razvili detaljan plan za postizanje vaših ciljeva.
                    </p>
                </div>
                
                <div style="margin-top: 2rem;">
                    <button type="button" class="btn btn-primary" onclick="scheduleAdvisorMeeting()" style="padding: 0.75rem 2rem; font-size: 1rem;">
                        <i class="fas fa-calendar-check" style="margin-right: 0.5rem;"></i> Zakaži sastanak sa savetnikom
                    </button>
                </div>
                
                <div style="margin-top: 1.5rem;">
                    <button type="button" class="btn btn-outline" onclick="closeModal()" style="padding: 0.5rem 1.5rem;">
                        Zatvori
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="budgetModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2>Praćenje svakodnevnih troškova</h2>
            <div class="budget-section">
                <div class="form-group">
                    <label for="date">Datum</label>
                    <input type="date" id="date">
                </div>
                <div class="form-group">
                    <label for="category">Kategorija</label>
                    <select id="category">
                        <option value="hrana">Hrana</option>
                        <option value="transport">Transport</option>
                        <option value="zabava">Zabava</option>
                        <option value="kupovina">Kupovina</option>
                        <option value="ostalo">Ostalo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="amount">Iznos</label>
                    <input type="number" id="amount" required>
                </div>
                <div class="form-group">
                    <label for="description">Opis</label>
                    <input type="text" id="description">
                </div>
                <button class="primary-button" onclick="addExpense()" style="width: 100%;">
                    <i class="fas fa-plus"></i>
                    Dodaj trošak
                </button>
                <div class="expenses-list" style="margin-top: 1rem;"></div>
                <div class="total-expenses" style="margin-top: 1rem; text-align: right;"></div>
            </div>
        </div>
    </div>

    <div id="calculatorModal" class="modal">
        <div class="modal-content" style="background: #ffffff; border: 1px solid #D4AF37; border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
            <span class="close-modal" onclick="closeModal()" style="color: #000000;">&times;</span>
            <h2 style="color: #D4AF37; text-align: center; margin-bottom: 1.5rem; font-size: 1.8rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <i class="fas fa-calculator" style="margin-right: 10px; color: #D4AF37;"></i>Finansijski kalkulator
            </h2>
            
            <div class="calculator-section" style="padding: 0 1.5rem 1.5rem;">
                <div class="calculator-instructions" style="margin-bottom: 2rem; background: #FFF9E6; padding: 1.25rem; border-radius: 10px; border-left: 4px solid #D4AF37; color: #333333; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);">
                    <h3 style="margin-top: 0; color: #D4AF37; font-weight: 700; font-size: 1.2rem; margin-bottom: 0.75rem; display: flex; align-items: center;">
                        <i class="fas fa-info-circle" style="margin-right: 8px; color: #D4AF37;"></i>Kako koristiti kalkulator:
                    </h3>
                    <ul style="margin: 0; padding-left: 1.5rem; color: #333333; line-height: 1.7;">
                        <li style="margin-bottom: 0.5rem;"><span style="color: #D4AF37; font-weight: 600;">Period štednje</span> - Ukupan broj godina planirane štednje</li>
                        <li style="margin-bottom: 0.5rem;"><span style="color: #D4AF37; font-weight: 600;">Godišnja uplata</span> - Iznos koji planirate da ulažete svake godine</li>
                        <li><span style="color: #D4AF37; font-weight: 600;">Stopa prinosa</span> - Očekivani godišnji prinos (podrazumevano 7%)</li>
                    </ul>
                </div>
                
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label for="investmentPeriod" style="display: block; margin-bottom: 0.5rem; color: #333333; font-weight: 600;">Period štednje (godine)</label>
                    <div style="position: relative;">
                        <input type="number" id="investmentPeriod" required 
                               placeholder="Unesite broj godina" 
                               min="1" 
                               step="1"
                               style="width: 100%; padding: 0.85rem 1rem; background: #ffffff; border: 2px solid #D4AF37; border-radius: 8px; color: #333333; font-size: 1rem; transition: all 0.3s ease;"
                               onfocus="this.borderColor='#B8860B'; this.boxShadow='0 0 0 3px rgba(212, 175, 55, 0.2)';"
                               onblur="this.borderColor='#D4AF37'; this.boxShadow='none';">
                        <i class="fas fa-calendar-alt" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #D4AF37;"></i>
                    </div>
                </div>
                
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label for="annualDeposit" style="display: block; margin-bottom: 0.5rem; color: #333333; font-weight: 600;">Godišnja uplata (RSD)</label>
                    <div style="position: relative;">
                        <input type="number" id="annualDeposit" required 
                               placeholder="Unesite iznos u RSD" 
                               min="1" 
                               step="1000"
                               style="width: 100%; padding: 0.85rem 1rem; background: #ffffff; border: 2px solid #D4AF37; border-radius: 8px; color: #333333; font-size: 1rem; transition: all 0.3s ease;"
                               onfocus="this.borderColor='#B8860B'; this.boxShadow='0 0 0 3px rgba(212, 175, 55, 0.2)';"
                               onblur="this.borderColor='#D4AF37'; this.boxShadow='none';">
                        <i class="fas fa-wallet" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #D4AF37;"></i>
                    </div>
                </div>
                
                <div class="note" style="background: #FFF9E6; color: #333333; border-left: 3px solid #D4AF37; padding: 0.85rem 1rem; border-radius: 8px; margin: 1.5rem 0; display: flex; align-items: center;">
                    <i class="fas fa-info-circle" style="color: #D4AF37; font-size: 1.1rem; margin-right: 10px;"></i>
                    <span>Podrazumevana godišnja kamatna stopa iznosi <strong style="color: #D4AF37;">7%</strong></span>
                </div>
                <button class="primary-button" onclick="calculateInvestment()" style="width: 100%; margin-top: 0.5rem; padding: 1rem; font-size: 1.05rem; background: linear-gradient(135deg, #D4AF37 0%, #F1C40F 100%); border: none; border-radius: 8px; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3); color: #1a1a1f; font-weight: 600; transition: all 0.3s ease; cursor: pointer;" 
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(212, 175, 55, 0.4)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(212, 175, 55, 0.3)';">
                    <i class="fas fa-calculator" style="margin-right: 8px;"></i>
                    Izračunaj povrat
                </button>
                
                <div id="investmentResult" style="display: none; margin-top: 2rem; background: #ffffff; border-radius: 10px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); border: 1px solid #E5E7EB;">
                    <h3 style="color: #D4AF37; border-bottom: 1px solid #E5E7EB; padding-bottom: 0.75rem; margin-top: 0; font-size: 1.4rem; display: flex; align-items: center;">
                        <i class="fas fa-chart-line" style="margin-right: 10px; color: #D4AF37;"></i>Rezultati investicije
                    </h3>
                    <div class="chart-container" style="margin: 1.5rem 0; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 16px; padding: 24px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08), 0 4px 10px rgba(0, 0, 0, 0.03); border: 1px solid rgba(203, 213, 225, 0.3);">
                        <canvas id="investmentChart" style="width: 100%; height: 320px; border-radius: 12px;"></canvas>
                    </div>
                    <div class="result-details" style="margin-top: 1.5rem; color: #333333;">
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #F3F4F6;">
                            <span style="color: #4B5563;">Ukupno investirano:</span>
                            <strong style="color: #1F2937; font-weight: 700;" id="totalInvested"></strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #F3F4F6;">
                            <span style="color: #4B5563;">Ukupan povrat:</span>
                            <strong style="color: #10B981; font-weight: 700;" id="totalReturn"></strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #F3F4F6;">
                            <span style="color: #4B5563;">Ukupan profit:</span>
                            <strong style="color: #10B981; font-weight: 700;" id="totalProfit"></strong>
                        </div>
                        <div style="display: none; justify-content: space-between; padding: 0.75rem 0;">
                            <span style="color: #4B5563;">Kamatni dohodak:</span>
                            <strong style="color: #10B981; font-weight: 700;" id="compoundInterest"></strong>
                        </div>
                        </div>

                        <script>
                            document.getElementById('compoundInterest').textContent = compoundInterest;
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="supportModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="color: #D4AF37; text-align: center; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                <i class="fas fa-headset"></i>
                Tehnička podrška
            </h2>
            
            <div style="text-align: center; padding: 2rem;">
                <p style="color: var(--muted-text); font-size: 1.1rem; margin-bottom: 2rem;">
                    Za tehničku podršku i pomoć oko finansijskih pitanja, molimo koristite naš AI chat bot koji se nalazi u donjem desnom uglu stranice.
                </p>
                
                <div style="background: rgba(212, 175, 55, 0.1); border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 2rem;">
                    <h4 style="color: #D4AF37; margin-bottom: 1rem;">
                        <i class="fas fa-robot"></i>
                        AI Chat Asistent
                    </h4>
                    <p style="color: var(--light-text); margin: 0; font-size: 0.95rem;">
                        Naš AI asistent može odgovoriti na pitanja o budžetu, štednji, investiranju i drugim finansijskim temama. Za složenija pitanja o ulaganju, automatski će vam preporučiti konsultaciju sa našim stručnjakom.
                    </p>
                </div>
                
                <button onclick="closeModal()" style="background: linear-gradient(45deg, #D4AF37, #FFD700); color: white; border: none; border-radius: 25px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 600;">
                    <i class="fas fa-check"></i>
                    Razumem
                </button>
            </div>
        </div>
    </div>

    <div id="consultationModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="color: #D4AF37; text-align: center; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                <i class="fas fa-calendar-alt"></i>
                Zakazivanje Konsultacija
            </h2>
            <div class="consultation-section">
                <p style="color: var(--muted-text); text-align: center; margin-bottom: 1.5rem;">
                    Popunite obrazac ispod da biste zakazali finansijsku konsultaciju. Nakon što pošaljete zahtev, administrator će pregledati Vaš zahtev i poslati Vam potvrdu putem notifikacija.
                </p>
                
                <form id="consultationForm" class="consultation-form">
                    <div class="form-group">
                        <label for="clientName">Ime i prezime</label>
                        <input type="text" id="clientName" name="clientName" required placeholder="Unesite vaše ime i prezime" style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark); padding: 0.75rem; border-radius: 6px; width: 100%; box-sizing: border-box;">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientEmail">Email adresa</label>
                        <input type="email" id="clientEmail" name="clientEmail" required placeholder="Unesite vašu email adresu" style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark); padding: 0.75rem; border-radius: 6px; width: 100%; box-sizing: border-box;">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientPhone">Telefon (opcionalno)</label>
                        <input type="tel" id="clientPhone" name="clientPhone" placeholder="Unesite vaš broj telefona" style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark); padding: 0.75rem; border-radius: 6px; width: 100%; box-sizing: border-box;">
                    </div>
                    
                    <div class="form-group">
                        <label for="consultationDate">Datum konsultacije</label>
                        <input type="date" id="consultationDate" name="consultationDate" required min="" style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark); padding: 0.75rem; border-radius: 6px; width: 100%; box-sizing: border-box;">
                    </div>
                    
                    <div class="form-group">
                        <label for="consultationTime">Vrijeme konsultacije</label>
                        <select id="consultationTime" name="consultationTime" required style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark);">
                            <option value="" disabled selected>Odaberite vrijeme</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="consultationTopic">Tema konsultacije</label>
                        <select id="consultationTopic" name="consultationTopic" required style="background: rgba(25, 25, 30, 0.8); color: var(--light-text); border: 1px solid var(--gold-dark);">
                            <option value="" disabled selected>Odaberite temu</option>
                            <option value="Investicije">Investicije</option>
                            <option value="Štednja">Štednja</option>
                            <option value="Upravljanje dugom">Upravljanje dugom</option>
                            <option value="Penzijsko planiranje">Penzijsko planiranje</option>
                            <option value="Poreski savjeti">Poreski savjeti</option>
                            <option value="Kupovina nekretnine">Kupovina nekretnine</option>
                            <option value="Osiguranje">Osiguranje</option>
                            <option value="Drugo">Drugo</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="consultationNote">Napomena (opcionalno)</label>
                        <textarea id="consultationNote" name="consultationNote" rows="4" placeholder="Opišite detaljnije vaše finansijske ciljeve ili specifična pitanja koja želite raspraviti tokom konsultacije..." style="background: rgba(255, 255, 255, 0.9); color: #000000; border: 1px solid var(--gold-dark); resize: vertical;"></textarea>
                    </div>
                    
                    <button type="submit" style="background: linear-gradient(45deg, #D4AF37, #FFD700); color: white; border: none; border-radius: 6px; padding: 0.75rem 1.5rem; width: 100%; cursor: pointer; font-weight: 600; margin-top: 1rem; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        <i class="fas fa-calendar-check"></i>
                        Zakaži konsultaciju
                    </button>
                </form>
                
                <div id="consultationSuccess" style="display: none; text-align: center; margin-top: 2rem; padding: 1.5rem; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 6px;">
                    <i class="fas fa-check-circle" style="color: #10b981; font-size: 2rem; margin-bottom: 1rem;"></i>
                    <h3 style="color: #10b981; margin-bottom: 0.5rem;">Zahtev za konsultaciju je uspešno poslat!</h3>
                    <p style="color: var(--light-text); margin-bottom: 1rem;">Vaš zahtev za konsultaciju je poslat administratoru na pregled. Bićete obavešteni putem notifikacija kada zahtev bude potvrđen.</p>
                    <button onclick="closeModal()" style="background: #10b981; color: white; border: none; border-radius: 6px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-check"></i>
                        U redu
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <!-- Add Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chat Bot Scripts -->
    <script src="finansijska_platforma_struktura/pages/js/kb.js"></script>
    <script src="finansijska_platforma_struktura/pages/js/chat.js"></script>
    <script>
        // Filtriranje grešaka browser ekstenzija
        window.addEventListener('error', function(e) {
            if (e.message && e.message.includes('Could not establish connection')) {
                console.log('🔕 Greška browser ekstenzije ignorisana:', e.message);
                e.preventDefault();
                return false;
            }
        });
        
        // Filtriranje promise grešaka ekstenzija
        window.addEventListener('unhandledrejection', function(e) {
            if (e.reason && e.reason.message && e.reason.message.includes('Could not establish connection')) {
                console.log('🔕 Promise greška browser ekstenzije ignorisana:', e.reason.message);
                e.preventDefault();
                return false;
            }
        });
        
        // Funkcija za zatvaranje modala
        function closeModal() {
            // Zatvori sve modale
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.style.display = 'none';
            });
            
            // Ukloni modal-open klasu sa body-ja
            document.body.classList.remove('modal-open');
            
            // Vrati scroll na vrh
            window.scrollTo(0, 0);
            
            // Resetuj samo input polja za kalkulator
            const investmentPeriod = document.getElementById('investmentPeriod');
            const annualDeposit = document.getElementById('annualDeposit');
            
            if (investmentPeriod) investmentPeriod.value = '';
            if (annualDeposit) annualDeposit.value = '';
            
            // Sakrij samo rezultate kalkulatora
            const resultDiv = document.getElementById('investmentResult');
            if (resultDiv) {
                resultDiv.style.display = 'none';
            }
            
            // Uništi grafikone kalkulatora
            const chartCanvas = document.getElementById('investmentChart');
            if (chartCanvas) {
                const chartInstance = Chart.getChart(chartCanvas);
                if (chartInstance) {
                    chartInstance.destroy();
                }
            }
        }
        
        // Funkcija za otvaranje modala
        function openModal(modalId) {
            console.log('Otvaram modal:', modalId);
            const modal = document.getElementById(modalId);
            if (modal) {
                // Zatvori sve druge modale prvo
                closeModal();
                
                // Postavi event listener za ESC taster
                const handleKeyDown = (e) => {
                    if (e.key === 'Escape') {
                        closeModal();
                        document.removeEventListener('keydown', handleKeyDown);
                    }
                };
                
                // Dodaj event listener
                document.addEventListener('keydown', handleKeyDown);
                
                // Prikaži željeni modal
                modal.style.display = 'flex';
                document.body.classList.add('modal-open');
                
                // Postavi event listener za klik izvan modala
                modal.addEventListener('click', function outsideClick(e) {
                    if (e.target === modal) {
                        closeModal();
                        modal.removeEventListener('click', outsideClick);
                    }
                });
                
                // Fokusiraj prvo input polje u modalu ako postoji
                setTimeout(() => {
                    const firstInput = modal.querySelector('input:not([type="hidden"]), select, textarea, button');
                    if (firstInput) firstInput.focus();
                }, 100);
            } else {
                console.error('Modal sa ID-jem', modalId, 'nije pronađen');
            }
        }
        
        // Funkcija za izračunavanje investicije
        function calculateInvestment() {
            const period = parseFloat(document.getElementById('investmentPeriod').value);
            const annualDeposit = parseFloat(document.getElementById('annualDeposit').value);
            
            if (!period || !annualDeposit) {
                alert('Molimo unesite sve potrebne podatke.');
                return;
            }
            
            // Konstante za izračun
            const annualRate = 0.07; // 7% godišnja kamatna stopa
            const years = period;
            const monthlyRate = annualRate / 12;
            const months = years * 12;
            
            // Nizovi za čuvanje podataka za grafikon
            const labels = [];
            const totalInvestedData = [];
            const totalValueData = [];
            
            // Promenljive za praćenje
            let totalInvested = 0;
            let totalValue = 0;
            
            // Godišnji priliv
            const yearlyDeposit = annualDeposit;
            
            // Izračun za svaku godinu
            for (let year = 0; year <= years; year++) {
                // Dodajemo godišnji ulog na početku svake godine (osim prve)
                if (year > 0) {
                    totalInvested += yearlyDeposit;
                    totalValue += yearlyDeposit;
                }
                
                // Ako nije poslednja godina, primenjujemo kamatu
                if (year < years) {
                    // Mesečni prinos
                    totalValue *= Math.pow(1 + monthlyRate, 12);
                }
                
                // Dodajemo podatke za grafikon
                labels.push(`Godina ${year}`);
                totalInvestedData.push(totalInvested);
                totalValueData.push(totalValue);
            }
            
            // Prikaz rezultata
            const resultDiv = document.getElementById('investmentResult');
            document.getElementById('totalInvested').textContent = formatCurrency(totalInvested, false) + ' RSD';
            document.getElementById('totalReturn').textContent = formatCurrency(totalValue, false) + ' RSD';
            document.getElementById('totalProfit').textContent = formatCurrency(totalValue - totalInvested, false) + ' RSD';
            
            // Prikaz rezultata
            resultDiv.style.display = 'block';
            
            // Kreiranje grafika
            createChart(labels, totalInvestedData, totalValueData);
            
            // Funkcija za formatiranje valute
            function formatCurrency(amount, includeCurrency = true) {
                return amount.toLocaleString('de-DE', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).replace(/\./g, 'X').replace(/,/g, '.').replace(/X/g, ',');
            }
            
            // Funkcija za kreiranje grafika
            function createChart(labels, investedData, valueData) {
                const ctx = document.getElementById('investmentChart').getContext('2d');
                
                // Uništi postojeći grafik ako postoji
                const existingChart = Chart.getChart('investmentChart');
                if (existingChart) {
                    existingChart.destroy();
                }
                
                // Kreiramo gradijente za moderniji izgled
                const gradientInvested = ctx.createLinearGradient(0, 0, 0, 300);
                gradientInvested.addColorStop(0, 'rgba(59, 130, 246, 0.6)');
                gradientInvested.addColorStop(1, 'rgba(59, 130, 246, 0.05)');
                
                const gradientTotal = ctx.createLinearGradient(0, 0, 0, 300);
                gradientTotal.addColorStop(0, 'rgba(16, 185, 129, 0.6)');
                gradientTotal.addColorStop(1, 'rgba(16, 185, 129, 0.05)');
                
                // Kreiranje novog modernog grafika
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '💰 Ukupno uloženo',
                            data: investedData,
                            borderColor: '#3B82F6',
                            backgroundColor: gradientInvested,
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#3B82F6',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            pointHoverBackgroundColor: '#3B82F6',
                            pointHoverBorderColor: '#ffffff',
                            pointHoverBorderWidth: 3,
                            borderJoinStyle: 'round'
                        }, {
                            label: '📈 Ukupna vrednost',
                            data: valueData,
                            borderColor: '#10B981',
                            backgroundColor: gradientTotal,
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#10B981',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            pointHoverBackgroundColor: '#10B981',
                            pointHoverBorderColor: '#ffffff',
                            pointHoverBorderWidth: 3,
                            borderJoinStyle: 'round'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        animation: {
                            duration: 2500,
                            easing: 'easeInOutQuart',
                            delay: (context) => {
                                return context.dataIndex * 100;
                            }
                        },
                        layout: {
                            padding: {
                                top: 20,
                                bottom: 10,
                                left: 15,
                                right: 15
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '📊 Rast vaše investicije tokom vremena',
                                color: '#1F2937',
                                font: {
                                    family: "'Inter', 'Segoe UI', sans-serif",
                                    size: 18,
                                    weight: '700'
                                },
                                padding: {
                                    top: 15,
                                    bottom: 25
                                }
                            },
                            tooltip: {
                                enabled: true,
                                backgroundColor: 'rgba(17, 24, 39, 0.95)',
                                titleColor: '#F9FAFB',
                                bodyColor: '#F9FAFB',
                                borderColor: 'rgba(59, 130, 246, 0.3)',
                                borderWidth: 1,
                                cornerRadius: 12,
                                padding: 16,
                                bodySpacing: 8,
                                titleSpacing: 8,
                                displayColors: true,
                                usePointStyle: true,
                                mode: 'index',
                                intersect: false,
                                titleFont: {
                                    family: "'Inter', 'Segoe UI', sans-serif",
                                    size: 14,
                                    weight: '600'
                                },
                                bodyFont: {
                                    family: "'Inter', 'Segoe UI', sans-serif",
                                    size: 13,
                                    weight: '500'
                                },
                                callbacks: {
                                    title: function(tooltipItems) {
                                        return `📅 ${tooltipItems[0].label}`;
                                    },
                                    label: function(context) {
                                        const dataset = context.dataset.label;
                                        const value = formatCurrency(context.parsed.y, false) + ' RSD';
                                        
                                        // Dodajemo procenat rasta za ukupnu vrednost
                                        if (context.datasetIndex === 1 && context.dataIndex > 0) {
                                            const investedValue = context.chart.data.datasets[0].data[context.dataIndex];
                                            const growth = ((context.parsed.y - investedValue) / investedValue * 100).toFixed(1);
                                            return `${dataset}: ${value} (+${growth}%)`;
                                        }
                                        
                                        return `${dataset}: ${value}`;
                                    },
                                    afterLabel: function(context) {
                                        if (context.datasetIndex === 1) {
                                            const investedValue = context.chart.data.datasets[0].data[context.dataIndex];
                                            const profit = context.parsed.y - investedValue;
                                            return `💡 Profit: ${formatCurrency(profit, false)} RSD`;
                                        }
                                        return '';
                                    }
                                }
                            },
                            legend: {
                                position: 'top',
                                align: 'center',
                                labels: {
                                    usePointStyle: true,
                                    pointStyle: 'circle',
                                    padding: 25,
                                    color: '#374151',
                                    font: {
                                        family: "'Inter', 'Segoe UI', sans-serif",
                                        size: 13,
                                        weight: '600'
                                    },
                                    generateLabels: function(chart) {
                                        const original = Chart.defaults.plugins.legend.labels.generateLabels;
                                        const labels = original.call(this, chart);
                                        
                                        labels.forEach(label => {
                                            label.fillStyle = label.strokeStyle;
                                        });
                                        
                                        return labels;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: '📅 Godine',
                                    color: '#4B5563',
                                    font: {
                                        family: "'Inter', 'Segoe UI', sans-serif",
                                        size: 12,
                                        weight: '600'
                                    }
                                },
                                ticks: {
                                    color: '#6B7280',
                                    font: {
                                        family: "'Inter', 'Segoe UI', sans-serif",
                                        size: 11,
                                        weight: '500'
                                    },
                                    maxRotation: 0
                                },
                                grid: {
                                    display: false
                                },
                                border: {
                                    display: false
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: '💰 Iznos (RSD)',
                                    color: '#4B5563',
                                    font: {
                                        family: "'Inter', 'Segoe UI', sans-serif",
                                        size: 12,
                                        weight: '600'
                                    }
                                },
                                ticks: {
                                    color: '#6B7280',
                                    font: {
                                        family: "'Inter', 'Segoe UI', sans-serif",
                                        size: 11,
                                        weight: '500'
                                    },
                                    padding: 8,
                                    callback: function(value) {
                                        const formatter = new Intl.NumberFormat('sr-RS', {
                                            style: 'currency',
                                            currency: 'RSD',
                                            minimumFractionDigits: 0,
                                            notation: value >= 1000000 ? 'compact' : 'standard'
                                        });
                                        return formatter.format(value);
                                    }
                                },
                                grid: {
                                    color: 'rgba(107, 114, 128, 0.1)',
                                    lineWidth: 1
                                },
                                border: {
                                    display: false
                                }
                            }
                        },
                        interaction: {
                            mode: 'nearest',
                            axis: 'x',
                            intersect: false
                        }
                    }
                });
            }
        }
        
        // Otvaranje čarobnjaka za kreiranje budžeta
        function openBudgetWizard() {
            const isLoggedIn = localStorage.getItem('currentUser') !== null;
            
            if (!isLoggedIn) {
                // Ako korisnik nije prijavljen, prikaži login modal
                alert('Molimo vas da se prijavite kako biste pristupili funkcijama ličnih finansija.');
                document.getElementById('loginModal').style.display = 'flex';
                return;
            }
            
            // Ako je korisnik prijavljen, preusmeri ga na profil stranicu u sekciju budžeta
            window.location.href = 'profile.html#budget';
        }

        // Formatiranje valute
        function formatCurrency(value, includeCurrency = true) {
            const formatter = new Intl.NumberFormat('sr-RS', {
                style: includeCurrency ? 'currency' : 'decimal',
                currency: 'RSD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
            return formatter.format(value);
        }

        // Toggle password visibility
        function togglePassword(passwordFieldId) {
            const passwordField = document.getElementById(passwordFieldId);
            const toggleButton = passwordField.nextElementSibling;
            const icon = toggleButton.querySelector('i');
            
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Password strength calculator
        function calculatePasswordStrength(password) {
            let score = 0;
            let feedback = [];
            
            // Length check
            if (password.length >= 8) score += 2;
            else if (password.length >= 6) score += 1;
            
            // Character variety checks
            if (/[a-z]/.test(password)) score += 1;
            if (/[A-Z]/.test(password)) score += 1;
            if (/[0-9]/.test(password)) score += 1;
            if (/[^A-Za-z0-9]/.test(password)) score += 1;
            
            // Determine strength
            if (score <= 2) {
                return { percentage: 25, color: '#ff4757', text: 'Slaba' };
            } else if (score <= 4) {
                return { percentage: 50, color: '#ffa502', text: 'Srednja' };
            } else if (score <= 5) {
                return { percentage: 75, color: '#26de81', text: 'Jaka' };
            } else {
                return { percentage: 100, color: '#05c46b', text: 'Vrlo jaka' };
            }
        }

        // User State
        let currentUser = null; // Inicijalno null
        
        // Initialize modals
        const modals = {
            aiChat: document.getElementById('aiChatModal'),
            login: document.getElementById('loginModal'),
            register: document.getElementById('registerModal')
        };
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                document.body.classList.remove('modal-open');
                document.activeElement.blur();
            }
        }
        
        // Toggle modals
        document.querySelectorAll('[data-modal]').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const modalId = btn.getAttribute('data-modal');
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'block';
                    document.body.classList.add('modal-open');
                    
                    // Focus first input if exists
                    const firstInput = modal.querySelector('input:not([type="hidden"]), select, textarea');
                    if (firstInput) {
                        setTimeout(() => firstInput.focus(), 100);
                    }
                }
            });
        });
        
        // Close buttons
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const modal = btn.closest('.modal');
                modal.style.display = 'none';
                document.body.classList.remove('modal-open');
                document.activeElement.blur();
            });
        });
        
        // Toggle between login and register forms
        document.getElementById('showRegister')?.addEventListener('click', (e) => {
            e.preventDefault();
            modals.login.style.display = 'none';
            modals.register.style.display = 'block';
        });
        
        document.getElementById('showLogin')?.addEventListener('click', (e) => {
            e.preventDefault();
            modals.register.style.display = 'none';
            modals.login.style.display = 'block';
        });
        
        // Profile picture upload preview
        const profilePicUpload = document.getElementById('profilePicUpload');
        const profilePicPreview = document.getElementById('profilePicPreview');
        const previewImage = document.getElementById('previewImage');
        
        if (profilePicUpload) {
            profilePicUpload.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        previewImage.src = event.target.result;
                        profilePicPreview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            document.getElementById('removeProfilePic')?.addEventListener('click', () => {
                profilePicUpload.value = '';
                profilePicPreview.style.display = 'none';
            });
        }
        
        // Login form submission
        document.getElementById('loginForm')?.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            // Validacija
            if (!email || !password) {
                alert('Molimo unesite email i lozinku.');
                return;
            }
            
            // In a real app, you would validate credentials with a server
            // For demo purposes, we'll simulate a successful login
            simulateLogin({
                name: email.split('@')[0],
                email: email,
                profilePic: 'https://via.placeholder.com/150'
            }, rememberMe);
            
            // Zatvori modal
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }
        });
        
        // Register form submission
        document.addEventListener('DOMContentLoaded', function() {
            const registerForm = document.getElementById('registerForm');
            const profilePicUpload = document.getElementById('profilePictureUpload');
            const profilePicPreview = document.getElementById('previewContainer');
            
            // Password strength checker
            const passwordField = document.getElementById('regPassword');
            const strengthBar = document.querySelector('.strength-bar');
            const strengthText = document.getElementById('strengthText');
            
            if (passwordField && strengthBar && strengthText) {
                passwordField.addEventListener('input', function() {
                    const password = this.value;
                    const strength = calculatePasswordStrength(password);
                    
                    // Update strength bar
                    strengthBar.style.width = strength.percentage + '%';
                    strengthBar.style.backgroundColor = strength.color;
                    
                    // Update text
                    strengthText.textContent = strength.text;
                    strengthText.style.color = strength.color;
                });
            }
            
            // Profile picture preview
            if (profilePicUpload) {
                profilePicUpload.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imagePreview = document.getElementById('imagePreview');
                            if (imagePreview) {
                                imagePreview.src = e.target.result;
                                profilePicPreview.style.display = 'block';
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                // Remove image functionality
                document.getElementById('removeImage')?.addEventListener('click', function() {
                    profilePicUpload.value = '';
                    profilePicPreview.style.display = 'none';
                });
            }
            
            if (registerForm) {
                registerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form values
                    const name = document.getElementById('regFullName').value.trim();
                    const email = document.getElementById('regEmail').value.trim();
                    const password = document.getElementById('regPassword').value;
                    const confirmPassword = document.getElementById('regConfirmPassword').value;
                    const agreeTerms = document.getElementById('agreeTerms').checked;
                    
                    // Validate form
                    if (!name || !email || !password || !confirmPassword) {
                        alert('Molimo popunite sva obavezna polja!');
                        return;
                    }
                    
                    if (!agreeTerms) {
                        alert('Morate prihvatiti uslove korišćenja!');
                        return;
                    }
                    
                    if (password !== confirmPassword) {
                        alert('Lozinke se ne podudaraju!');
                        return;
                    }
                    
                    // Create user object
                    const userData = {
                        name: name,
                        email: email,
                        profilePic: 'https://via.placeholder.com/150'
                    };
                    
                    // Handle profile picture if uploaded
                    if (profilePicUpload.files && profilePicUpload.files[0]) {
                        userData.profilePic = URL.createObjectURL(profilePicUpload.files[0]);
                    }
                    
                    // Simulate registration (in real app, you would send this to a server)
                    simulateLogin(userData, true);
                    
                    // Close modal and reset form
                    const registerModal = document.getElementById('registerModal');
                    if (registerModal) registerModal.style.display = 'none';
                    registerForm.reset();
                    if (profilePicPreview) profilePicPreview.style.display = 'none';
                    
                    // Show success message
                    alert('Uspešno ste se registrovali!');
                    
                    // Redirect to home page
                    window.location.href = 'index.html';
                });
            }
        });
        
        // Logout
        document.getElementById('logoutBtn')?.addEventListener('click', (e) => {
            e.preventDefault();
            logout();
        });
        
        // Simulate login function
        function simulateLogin(userData, remember) {
            currentUser = userData;
            console.log('Simulacija prijave, korisnik:', userData);
            
            if (remember) {
                localStorage.setItem('currentUser', JSON.stringify(userData));
                console.log('Korisnik sačuvan u localStorage');
            } else {
                sessionStorage.setItem('currentUser', JSON.stringify(userData));
                console.log('Korisnik sačuvan u sessionStorage');
            }
            
            updateUI();
        }
        
        // Logout function
        function logout() {
            console.log('Odjavljivanje korisnika:', currentUser);
            currentUser = null;
            localStorage.removeItem('currentUser');
            sessionStorage.removeItem('currentUser');
            console.log('Korisnik odjavljen, stanje:', currentUser);
            updateUI();
        }
        
        // Update UI based on auth state
        function updateUI() {
            const guestUser = document.getElementById('guestUser');
            const loggedInUser = document.getElementById('loggedInUser');
            
            if (!guestUser || !loggedInUser) {
                console.error('UI elementi za autentifikaciju nisu pronađeni.');
                return;
            }
            
            console.log('updateUI pozvan, currentUser:', currentUser);
            
            // Ažuriraj logo svaki put kada se pozove updateUI
            const logoElement = document.getElementById('siteLogo');
            const savedLogo = localStorage.getItem('site_logo');
            
            console.log('🔍 Debug logo loading u preview-fixed.html:');
            console.log('Logo element:', logoElement);
            console.log('Saved logo:', savedLogo);
            console.log('Saved logo length:', savedLogo ? savedLogo.length : 'null');
            console.log('Logo type:', savedLogo ? (savedLogo.startsWith('data:') ? 'data URL' : 'regular URL') : 'none');
            
            if (logoElement && savedLogo) {
                logoElement.src = savedLogo;
                console.log('✅ Logo ažuriran iz localStorage u updateUI');
                
                // Dodatni debug za greške u učitavanju
                logoElement.onload = function() {
                    console.log('✅ Logo uspešno učitan i prikazan u preview-fixed.html');
                };
                logoElement.onerror = function() {
                    console.error('❌ Greška pri učitavanju loga u preview-fixed.html');
                    console.error('Logo src:', logoElement.src);
                };
            } else {
                console.log('❌ Logo element ili sačuvani logo ne postoji u preview-fixed.html');
            }
            
            // Proveri admin status i prikaži dugme ako je potrebno
            const adminEmail = 'zorandostica2@gmail.com';
            const isAdmin = (currentUser && currentUser.email === adminEmail) || localStorage.getItem('admin_logged_in') === 'true';
            const adminBtn = document.getElementById('adminSettingsBtn');
            
            if (adminBtn) {
                if (isAdmin) {
                    adminBtn.style.display = 'block';
                    console.log('✅ Admin dugme prikazano');
                } else {
                    adminBtn.style.display = 'none';
                }
            }
            
            if (currentUser) {
                guestUser.style.display = 'none';
                loggedInUser.style.display = 'flex';
                
                // Update profile picture
                const userProfilePic = document.getElementById('userProfilePic');
                if (userProfilePic && currentUser.profilePic) {
                    userProfilePic.src = currentUser.profilePic;
                }
                
                // Update dropdown user info
                const dropdownUserName = document.getElementById('dropdownUserName');
                const dropdownUserEmail = document.getElementById('dropdownUserEmail');
                
                if (dropdownUserName) {
                    dropdownUserName.textContent = currentUser.name || 'Korisnik';
                }
                
                if (dropdownUserEmail) {
                    dropdownUserEmail.textContent = currentUser.email || '';
                }
            } else {
                guestUser.style.display = 'flex';
                loggedInUser.style.display = 'none';
            }
        }
        
        // Financial Form State
        let selectedGoals = [];
        let expenseCategories = [];
        
        // Add Expense Category
        function addExpenseCategory() {
            const categoryId = 'category-' + Date.now();
            const categoryHtml = `
                <div class="form-row" id="${categoryId}" style="margin-bottom: 0.75rem;">
                    <div class="form-group" style="flex: 2;">
                        <div class="input-with-icon">
                            <i class="fas fa-tag"></i>
                            <input type="text" placeholder="Naziv kategorije" class="category-name">
                        </div>
                    </div>
                    <div class="form-group" style="flex: 1.5;">
                        <div class="input-with-icon">
                            <i class="fas fa-money-bill"></i>
                            <input type="number" placeholder="Iznos (RSD)" class="category-amount">
                        </div>
                    </div>
                    <button type="button" class="btn btn-outline" onclick="removeExpenseCategory('${categoryId}')" style="align-self: flex-end; margin-bottom: 0.75rem;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            document.getElementById('expenseCategories').insertAdjacentHTML('beforeend', categoryHtml);
        }
        
        // Remove Expense Category
        function removeExpenseCategory(id) {
            const element = document.getElementById(id);
            if (element) element.remove();
        }
        
        // Select/Deselect Goal
        function selectGoal(element) {
            const goal = element.getAttribute('data-goal');
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                selectedGoals = selectedGoals.filter(g => g !== goal);
            } else {
                element.classList.add('selected');
                selectedGoals.push(goal);
            }
        }
        
        // Navigation between form steps
        function showGoalsSection() {
            const income = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            const expenses = parseFloat(document.getElementById('monthlyExpenses').value) || 0;
            
            if (!income || !expenses) {
                alert('Molimo unesite sve obavezne podatke.');
                return;
            }
            
            // Collect expense categories
            expenseCategories = [];
            document.querySelectorAll('.form-row[id^="category-"]').forEach(row => {
                const name = row.querySelector('.category-name').value;
                const amount = parseFloat(row.querySelector('.category-amount').value) || 0;
                if (name && amount > 0) {
                    expenseCategories.push({ name, amount });
                }
            });
            
            document.getElementById('financialInfoStep').classList.remove('active');
            document.getElementById('goalsStep').style.display = 'block';
            document.getElementById('goalsStep').classList.add('active');
        }
        
        function backToFinancialInfo() {
            document.getElementById('goalsStep').classList.remove('active');
            document.getElementById('financialInfoStep').style.display = 'block';
            document.getElementById('financialInfoStep').classList.add('active');
        }
        
        // Submit Financial Data
        function submitFinancialData() {
            const income = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            const expenses = parseFloat(document.getElementById('monthlyExpenses').value) || 0;
            const goalDescription = document.getElementById('goalDescription').value;
            
            // Update summary
            document.getElementById('summaryIncome').textContent = income.toLocaleString() + ' RSD';
            document.getElementById('summaryExpenses').textContent = expenses.toLocaleString() + ' RSD';
            document.getElementById('summaryAvailable').textContent = (income - expenses).toLocaleString() + ' RSD';
            
            // Generate recommendation
            const recommendation = generateRecommendation(income, expenses, selectedGoals, expenseCategories);
            document.getElementById('recommendationText').textContent = recommendation;
            
            // Show results
            document.getElementById('goalsStep').classList.remove('active');
            document.getElementById('resultsStep').style.display = 'block';
            document.getElementById('resultsStep').classList.add('active');
        }
        
        // Generate Recommendation
        function generateRecommendation(income, expenses, goals, categories) {
            const available = income - expenses;
            let recommendation = '';
            
            if (available <= 0) {
                return 'Na osnovu unetih podataka, troškovi premašuju vaše prihode. Preporučujemo da razmotrite smanjenje troškova kako biste izbegli dugove.';
            }
            
            const savingsRatio = (available / income) * 100;
            
            if (savingsRatio < 10) {
                recommendation += 'Preporučujemo vam da razmotrite načine za povećanje uštede. ';
            } else if (savingsRatio >= 20) {
                recommendation += 'Odlično štedite! ';
            }
            
            if (goals.length > 0) {
                recommendation += `Vaši izabrani ciljevi (${goals.join(', ').replace(/, ([^,]*)$/, ' i $1')}) zahtevaju redovno planiranje. `;
            }
            
            if (categories.length > 0) {
                const largestCategory = categories.reduce((prev, current) => 
                    (prev.amount > current.amount) ? prev : current
                );
                recommendation += `Najveći deo vaših troškova čini kategorija "${largestCategory.name}" (${(largestCategory.amount/expenses*100).toFixed(0)}%). `;
            }
            
            recommendation += 'Za personalizovane savete, preporučujemo sastanak sa našim finansijskim savetnikom.';
            
            return recommendation;
        }
        
        // Schedule Advisor Meeting
        function scheduleAdvisorMeeting() {
            // Otvaranje stranice za zakazivanje sastanka
            window.location.href = 'https://tvoj-finansijski-savetnik.carrd.co/';
            closeModal();
        }
        
        // Check auth state on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Check for user in session storage first, then local storage
            const sessionUser = sessionStorage.getItem('currentUser');
            const localUser = localStorage.getItem('currentUser');
            
            if (sessionUser) {
                currentUser = JSON.parse(sessionUser);
                console.log('Učitan korisnik iz session storage:', currentUser);
            } else if (localUser) {
                currentUser = JSON.parse(localUser);
                console.log('Učitan korisnik iz local storage:', currentUser);
            }
            
            updateUI();
            
            // Add initial expense category
            addExpenseCategory();
        });
        
        // AI Chat modal
        const aiChatButton = document.querySelector('.ai-chat-button');
        if (aiChatButton) {
            aiChatButton.onclick = function() {
                modals.aiChat.style.display = 'block';
            };
        }
        
        const closeButton = document.querySelector('.close');
        if (closeButton) {
            closeButton.onclick = function() {
                modals.aiChat.style.display = 'none';
            };
        }

        // Budget tracking functionality
        function addExpense() {
            const date = document.getElementById('date').value;
            const category = document.getElementById('category').value;
            const amount = document.getElementById('amount').value;
            const description = document.getElementById('description').value;

            const expensesList = document.querySelector('.expenses-list');
            const totalExpenses = document.querySelector('.total-expenses');

            const expenseItem = document.createElement('div');
            expenseItem.className = 'expense-item';
            expenseItem.innerHTML = `
                <div class="expense-details">
                    <p><strong>Datum:</strong> ${date}</p>
                    <p><strong>Kategorija:</strong> ${category}</p>
                    <p><strong>Iznos:</strong> ${amount} RSD</p>
                    <p><strong>Opis:</strong> ${description}</p>
                </div>
                <button onclick="removeExpense(this)" class="remove-expense">&times;</button>
            `;

            expensesList.appendChild(expenseItem);

            // Calculate total expenses
            const total = Array.from(expensesList.children)
                .reduce((sum, item) => sum + parseFloat(item.querySelector('.expense-details p:nth-child(3)').textContent.split(' ')[1]), 0);
            
            totalExpenses.textContent = `Ukupni troškovi: ${total} RSD`;
        }

        function removeExpense(button) {
            const expenseItem = button.parentElement;
            expenseItem.remove();
            
            const expensesList = document.querySelector('.expenses-list');
            const totalExpenses = document.querySelector('.total-expenses');
            
            const total = Array.from(expensesList.children)
                .reduce((sum, item) => sum + parseFloat(item.querySelector('.expense-details p:nth-child(3)').textContent.split(' ')[1]), 0);
            
            totalExpenses.textContent = `Ukupni troškovi: ${total} RSD`;
        }

        // Investment calculator functionality
        function calculateInvestment() {
            const period = parseFloat(document.getElementById('investmentPeriod').value);
            const annualDeposit = parseFloat(document.getElementById('annualDeposit').value);
            
            if (!period || !annualDeposit) return;

            // Constants
            const annualRate = 0.07; // 7% annual rate
            const n = 12; // Compounded monthly
            const totalMonths = period * 12;

            // Arrays to store monthly values for chart
            const monthlyDeposits = [];
            const monthlyReturns = [];
            let totalInvestment = 0;
            let monthlyBalance = 0;
            
            for (let i = 0; i < totalMonths; i++) {
                // Add monthly deposit
                monthlyBalance += annualDeposit / 12;
                
                // Apply monthly interest
                monthlyBalance *= (1 + annualRate/12);
                
                // Store values for chart
                monthlyDeposits.push(monthlyBalance);
                monthlyReturns.push(monthlyBalance);
                
                // Update total investment at end of each year
                if ((i + 1) % 12 === 0) {
                    totalInvestment = monthlyBalance;
                }
            }

            // Calculate final results using compound interest formula
            const totalInvested = (annualDeposit * period).toFixed(2);
            const finalReturn = totalInvestment.toFixed(2);
            const totalProfit = (parseFloat(finalReturn) - parseFloat(totalInvested)).toFixed(2);
            const compoundInterest = (parseFloat(finalReturn) - parseFloat(totalInvested) - (annualDeposit * period)).toFixed(2);

            // Format numbers with thousand separators and 2 decimal places
            const formatNumber = (num) => {
                return parseFloat(num).toLocaleString('de-DE', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).replace(/\./g, 'X').replace(/,/g, '.').replace(/X/g, ',');
            };
            
            // Update result display
            const resultDiv = document.getElementById('investmentResult');
            resultDiv.style.display = 'block';
            
            document.getElementById('totalInvested').textContent = formatNumber(totalInvested) + ' RSD';
            document.getElementById('totalReturn').textContent = formatNumber(finalReturn) + ' RSD';
            document.getElementById('totalProfit').textContent = formatNumber(totalProfit) + ' RSD';

            // Hide form elements
            const formElements = document.querySelectorAll('.form-group, .note, button');
            formElements.forEach(element => {
                element.style.display = 'none';
            });

            // Prepare data for chart
            const cumulativeDeposits = [];
            const annualTotals = [];
            const labels = [];
            let totalDeposits = 0;
            
            for (let year = 0; year < period; year++) {
                const yearStart = year * 12;
                const yearEnd = (year + 1) * 12 - 1;
                
                // Add annual deposit to total
                totalDeposits += annualDeposit;
                cumulativeDeposits.push(totalDeposits);
                
                // Calculate total for the year (deposit + interest)
                const totalForYear = monthlyReturns[yearEnd];
                annualTotals.push(totalForYear);
                
                labels.push(`Godina ${year + 1}`);
            }

            // Create chart
            const ctx = document.getElementById('investmentChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Ukupno uplaćeno (RSD)',
                            data: cumulativeDeposits,
                            borderColor: '#3b82f6',
                            backgroundColor: '#3b82f6',
                            fill: false,
                            tension: 0.1,
                            order: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointStyle: 'circle'
                        },
                        {
                            label: 'Uplata + Kamata (RSD)',
                            data: annualTotals,
                            borderColor: '#22c55e',
                            backgroundColor: '#22c55e',
                            fill: false,
                            tension: 0.1,
                            order: 1,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointStyle: 'circle'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Iznos (RSD)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return new Intl.NumberFormat('sr-RS', { style: 'currency', currency: 'RSD' }).format(value);
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Godine'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y;
                                    const formatted = value.toLocaleString('de-DE', {
                                        minimumFractionDigits: 2,
                                        maximumFractionDigits: 2
                                    }).replace(/\./g, 'X').replace(/,/g, '.').replace(/X/g, ',');
                                    return context.dataset.label + ': ' + formatted + ' RSD';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Chat functionality

        // Initialize chat when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listener for budget tracking button
            const budgetTrackingBtn = document.getElementById('budgetTrackingBtn');
            if (budgetTrackingBtn) {
                budgetTrackingBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Check if user is logged in
                    const isLoggedIn = localStorage.getItem('isLoggedIn');
                    if (isLoggedIn === 'true') {
                        // Redirect to profile page where budget tracking is available
                        window.location.href = 'profile.html';
                    } else {
                        // Show login modal if not logged in
                        const loginModal = document.getElementById('loginModal');
                        if (loginModal) {
                            loginModal.style.display = 'flex';
                        }
                    }
                });
            }
        });
    </script>
    
    <script>
        // Chat bot JavaScript logika
        if (typeof window.chatContainer === 'undefined') window.chatContainer = null;
        if (typeof window.floatingChatBtn === 'undefined') window.floatingChatBtn = null;
        if (typeof window.chatMessages === 'undefined') window.chatMessages = null;
        if (typeof window.chatInput === 'undefined') window.chatInput = null;
        
        function initializeChat() {
            console.log('🔧 Inicijalizujem chat...');
            window.chatContainer = document.getElementById('chatContainer');
            window.floatingChatBtn = document.getElementById('chatToggle');
            window.chatMessages = document.getElementById('chatMessages');
            window.chatInput = document.getElementById('userInput');
            
            console.log('📦 Chat elementi:', {
                chatContainer: !!window.chatContainer,
                floatingChatBtn: !!window.floatingChatBtn,
                chatMessages: !!window.chatMessages,
                chatInput: !!window.chatInput
            });
            
            // Event listeneri
            if (floatingChatBtn) {
                console.log('✅ Dodajem event listener za plutajuće dugme');
                floatingChatBtn.addEventListener('click', toggleChat);
            } else {
                console.log('❌ Plutajuće dugme nije pronađeno!');
            }
            
            document.getElementById('closeChat')?.addEventListener('click', toggleChat);
            
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
            
            document.getElementById('sendMessage')?.addEventListener('click', sendMessage);
            
            // Dodaj dobrodošlicu poruku
            addWelcomeMessage();
        }
        
        // Globalna funkcija za toggle chat-a
        window.toggleChat = function() {
            const chatContainer = document.getElementById('chatContainer');
            console.log('🔄 toggleChat pozvan!', { chatContainer: !!chatContainer });
            if (chatContainer) {
                const isActive = chatContainer.classList.contains('active');
                console.log('📝 Chat container pre toggle:', { isActive, display: chatContainer.style.display });
                
                chatContainer.classList.toggle('active');
                
                const newIsActive = chatContainer.classList.contains('active');
                console.log('📝 Chat container posle toggle:', { newIsActive });
                
                // Fokusiraj na input kada se otvori chat
                if (chatContainer.classList.contains('active')) {
                    const chatInput = document.getElementById('userInput');
                    if (chatInput) {
                        setTimeout(() => chatInput.focus(), 300);
                    }
                }
            } else {
                console.log('❌ chatContainer je null!');
            }
        };
        
        function addWelcomeMessage() {
            if (chatMessages && chatMessages.children.length === 0) {
                const welcomeMessage = `
                    <div class="ai-message">
                        <strong>🤖 Golden Balance AI</strong><br>
                        Dobrodošli! Ja sam vaš lični finansijski savetnik. Mogu da vam pomognem sa:
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Investicionim strategijama</li>
                            <li>Budžetiranjem i štednjom</li>
                            <li>Analizo tržišta</li>
                            <li>Finansijskim planovima</li>
                        </ul>
                        Postavite mi bilo koje pitanje o finansijama!
                    </div>
                `;
                chatMessages.innerHTML = welcomeMessage;
            }
        }
        
        function sendMessage() {
            const message = chatInput?.value.trim();
            if (!message) return;
            
            // Dodaj korisničku poruku
            addMessage(message, 'user');
            
            // Očisti input
            chatInput.value = '';
            
            // Simuliraj typing indikator
            showTypingIndicator();
            
            // Generiši AI odgovor
            setTimeout(() => {
                hideTypingIndicator();
                const aiResponse = generateAIResponse(message);
                addMessage(aiResponse, 'ai');
            }, 1500 + Math.random() * 1000); // Random delay 1.5-2.5s
        }
        
        function addMessage(message, sender) {
            if (!window.chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = sender === 'user' ? 'user-message' : 'ai-message';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<strong>Vi:</strong><br>${message}`;
            } else {
                messageDiv.innerHTML = `<strong>🤖 Golden Balance AI:</strong><br>${message}`;
            }
            
            window.chatMessages.appendChild(messageDiv);
            window.chatMessages.scrollTop = window.chatMessages.scrollHeight;
        }
        
        function showTypingIndicator() {
            if (!window.chatMessages) return;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'ai-message typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <strong>🤖 Golden Balance AI:</strong><br>
                <span class="typing-dots">
                    <span>.</span><span>.</span><span>.</span>
                </span>
            `;
            
            window.chatMessages.appendChild(typingDiv);
            window.chatMessages.scrollTop = window.chatMessages.scrollHeight;
            
            // Dodaj CSS za animaciju
            const style = document.createElement('style');
            style.textContent = `
                .typing-dots span {
                    animation: typing 1.4s infinite;
                    animation-fill-mode: both;
                }
                .typing-dots span:nth-child(2) { animation-delay: .2s; }
                .typing-dots span:nth-child(3) { animation-delay: .4s; }
                @keyframes typing {
                    0%, 60%, 100% { opacity: 0.3; }
                    30% { opacity: 1; }
                }
            `;
            if (!document.getElementById('typingStyles')) {
                style.id = 'typingStyles';
                document.head.appendChild(style);
            }
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function generateAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Finansijska pitanja i odgovori
            if (message.includes('investicij') || message.includes('ulaganj')) {
                return `Odličo pitanje o investicijama! 📊
                
                Evo nekoliko ključnih principa za početak:
                
                🎯 <strong>Diversifikacija</strong> - Ne stavljajte sva jaja u jednu korpu
                📈 <strong>Dugoročno planiranje</strong> - Vreme je vaš najbolji saveznik
                💡 <strong>Dollar Cost Averaging</strong> - Redovno ulaganje umanjuje rizik
                
                Za početak preporučujem:
                • S&P 500 indeksni fondovi (7% prosečni godišnji povrat)
                • Diversifikovani ETF-ovi
                • Kratkoročne državne obveznice za stabilnost
                
                Da li vas zanima neki specifičan tip investicije?`;
            }
            
            if (message.includes('budžet') || message.includes('štednja') || message.includes('štednja')) {
                return `Budžetiranje je osnova finansijske stabilnosti! 💰
                
                Preporučujem <strong>50/30/20 pravilo</strong>:
                • 50% - Osnovne potrebe (stanovanje, hrana, transport)
                • 30% - Želje i zabava
                • 20% - Štednja i investicije
                
                <strong>Korisni saveti:</strong>
                📱 Pratite troškove dnevno
                🎯 Postavite specifične finansijske ciljeve
                💳 Izbegavajte nepotrebne dugove
                🏆 Nagradite sebe kada dostignete cilj
                
                Želite li da vam pomognem sa kreiranjem ličnog budžeta?`;
            }
            
            if (message.includes('kripto') || message.includes('bitcoin') || message.includes('ethereum')) {
                return `Kriptovalute su veoma volatilan segment! ⚡
                
                <strong>Važne napomene:</strong>
                ⚠️ Visok rizik - mogu izgubiti vrednost preko noći
                📊 Uložite samo ono što možete da izgubite
                🔍 Temeljno istražite pre ulaganja
                
                <strong>Za početnike:</strong>
                • Počnite sa malim iznosima (5-10% portfelja)
                • Fokusirajte se na Bitcoin i Ethereum
                • Koristite renomirane menjačnice
                
                Konsultujte se sa Zoranom Dostićem za detaljnu analizu kripoto tržišta.`;
            }
            
            if (message.includes('nekretnin') || message.includes('stan') || message.includes('kuća')) {
                return `Nekretnine su tradicionalno dobra investicija! 🏠
                
                <strong>Prednosti:</strong>
                ✅ Fizička imovina
                ✅ Redovni prihod od najma
                ✅ Potencijal rasta vrednosti
                
                <strong>Šta treba razmotriti:</strong>
                📍 Lokacija je ključna
                💰 Potreban značajan početni kapital
                🔧 Održavanje i upravljanje
                📈 Tržišni ciklusi
                
                U Srbiji, nekretnine u Beogradu i Novom Sadu pokazuju stabilnost. 
                
                Da li razmatrate kupovinu za lično korišćenje ili kao investiciju?`;
            }
            
            if (message.includes('penzij') || message.includes('penzion')) {
                return `Planiranje penzije nikad nije prerano! 👴👵
                
                <strong>Državna vs privatna penzija:</strong>
                🏛️ Državna - obavezna, ali možda neće biti dovoljna
                💼 Privatna - dobrovoljno dodatno obezbeđenje
                
                <strong>Strategije:</strong>
                📊 Počnite što ranije (compound interest!)
                💰 Odvojite 10-15% prihoda za penziju
                🎯 Kombinujte različite penzijske fondove
                
                Za 30-godišnjaka koji ulaže 20.000 RSD mesečno:
                U 35 godina = ~25 miliona RSD! 
                
                Želite li simulaciju za vaš slučaj?`;
            }
            
            if (message.includes('kredit') || message.includes('zajam') || message.includes('loan')) {
                return `Krediti mogu biti korisni, ali pažljivo! 💳
                
                <strong>Kada uzeti kredit:</strong>
                ✅ Za nekretnine (najčešće isplativo)
                ✅ Za obrazovanje (investicija u sebe)
                ✅ Za pokretanje biznisa (sa solidnim planom)
                
                <strong>Kada izbegavati:</strong>
                ❌ Za luksuz i potrošnju
                ❌ Visoka kamata (>10%)
                ❌ Kada nemate stabilan prihod
                
                <strong>Korisni saveti:</strong>
                📊 Uporedite ponude različitih banaka
                💰 Nikad više od 30% prihoda za rate
                📋 Pročitajte ceo ugovor
                
                Trebam li da vam pomognem sa kalkulatorom kredita?`;
            }
            
            if (message.includes('zoran') || message.includes('dostić') || message.includes('konsultacij')) {
                return `Zoran Dostić je naš glavni finansijski konsultant! 👨‍💼
                
                <strong>Ekspertiza:</strong>
                📈 15+ godina iskustva na finansijskim tržištima
                🎯 Specijalizovan za portfolio menadžment
                💼 Konsultacije za privatne investitore
                🏆 Sertifikovani finansijski planer
                
                <strong>Usluge:</strong>
                • Personalizovane investicione strategije
                • Analiza rizika i diverzifikacija
                • Penzijsko planiranje
                • Optimizacija poreske efikasnosti
                
                Za zakazivanje konsultacije koristite dugme "Zakaži konsultaciju" 
                ili pozovite: +381 11 123-4567`;
            }
            
            if (message.includes('hvala') || message.includes('thanks')) {
                return `Nema na čemu! 😊 
                
                Uvek sam tu da pomognem sa vašim finansijskim pitanjima. 
                Zapamtite - pametno upravljanje finansijama je ključ finansijske slobode!
                
                Da li imate još neko pitanje?`;
            }
            
            // Default odgovor
            return `Hvala na pitanju! 🤔
            
            Kao vaš AI finansijski savetnik, mogu da vam pomognem sa:
            
            💰 <strong>Investicije:</strong> akcije, obveznice, fondovi, ETF-ovi
            🏠 <strong>Nekretnine:</strong> kupovina, prodaja, rentabilnost  
            📊 <strong>Budžetiranje:</strong> pravilno upravljanje troškovima
            💳 <strong>Krediti:</strong> vrste, kamata, otplata
            🎯 <strong>Finansijski ciljevi:</strong> kratkoročni i dugoročni planovi
            
            Molim vas postavite konkretnije finansijsko pitanje, ili se konsultujte 
            sa našim ekspertom Zoranom Dostićem za detaljnu analizu.
            
            Kako mogu da vam pomognem danas?`;
        }
        
        // Inicijalizuj chat kad se učita stranica
        document.addEventListener('DOMContentLoaded', function() {
            // Sačekaj malo da se sve učita
            setTimeout(initializeChat, 100);
        });
        
    </script>
    <!-- Loan Calculator Form -->
    <div class="modal" id="loanCalculatorModal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div class="form-header">
                <h2><i class="fas fa-chart-line"></i> Investicioni kalkulator - S&P 500</h2>
                <p>Izračunajte potencijalni rast vaše investicije u S&P 500 indeksni fond (prosečni godišnji povrat 7%)</p>
            </div>
            
            <form id="loanForm" class="loan-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="loanAmount">Početna investicija (RSD)</label>
                        <div class="input-with-icon">
                            <i class="fas fa-money-bill-wave"></i>
                            <input type="number" id="loanAmount" min="10000" step="10000" value="500000" required>
                        </div>
                        <div class="range-container">
                            <input type="range" id="loanAmountRange" min="10000" max="10000000" step="10000" value="500000" class="slider">
                            <div class="range-labels">
                                <span>10.000 RSD</span>
                                <span>10.000.000 RSD</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="loanTerm">Period investiranja (godine)</label>
                        <div class="input-with-icon">
                            <i class="far fa-calendar-alt"></i>
                            <input type="number" id="loanTerm" min="1" max="40" value="10" required>
                        </div>
                        <div class="range-container">
                            <input type="range" id="loanTermRange" min="1" max="40" value="10" class="slider">
                            <div class="range-labels">
                                <span>1 godina</span>
                                <span>40 godina</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="yearlyContribution">Godišnja uplata (RSD)</label>
                        <div class="input-with-icon">
                            <i class="fas fa-coins"></i>
                            <input type="number" id="yearlyContribution" min="0" max="1000000" step="10000" value="100000" required>
                        </div>
                        <div class="range-container">
                            <input type="range" id="yearlyContributionRange" min="0" max="1000000" step="10000" value="100000" class="slider">
                            <div class="range-labels">
                                <span>0 RSD</span>
                                <span>1.000.000 RSD</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">
                        <i class="fas fa-redo"></i> Poništi
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-calculator"></i> Izračunaj
                    </button>
                </div>
            </form>
            
            <div id="results" class="results-container">
                <h3>Rezultati investiranja</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <div class="result-label">Početna investicija:</div>
                        <div class="result-value" id="initialInvestment">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Ukupno uloženo:</div>
                        <div class="result-value" id="totalContributed">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Ukupan povrat:</div>
                        <div class="result-value">
                            <span id="totalReturnValue">-</span>
                            <br>
                            <span id="roiValue" style="color: #10b981; font-size: 0.9em; font-weight: bold;">ROI: 0,00%</span>
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Konačna vrednost:</div>
                        <div class="result-value" id="finalValue">-</div>
                    </div>
                </div>
                <div class="chart-container" style="margin-top: 20px; background-color: #f8fafc; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="margin-top: 0; margin-bottom: 15px; color: #334155;">Rast investicije kroz godine</h4>
                    <div id="investmentChartSimple" style="width: 100%; min-height: 350px; display: flex; flex-direction: column;">
                        <div style="display: flex; justify-content: center; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; margin-right: 20px;">
                                <span style="display: inline-block; width: 15px; height: 15px; background-color: #1976d2; margin-right: 8px;"></span>
                                <span>Ukupno uloženo</span>
                            </div>
                            <div style="display: flex; align-items: center;">
                                <span style="display: inline-block; width: 15px; height: 15px; background-color: #2ecc71; margin-right: 8px;"></span>
                                <span>Prinos investicije</span>
                            </div>
                        </div>
                        
                        <div id="graphContainer" style="display: flex; height: 280px; border-bottom: 1px solid #ccc; padding-bottom: 20px; margin-bottom: 10px; overflow-x: auto;">
                            <!-- Ovde će se generisati grafikon kroz JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="form-actions" style="margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="printResults()">
                        <i class="fas fa-print"></i> Štampaj rezultate
                    </button>
                    <button type="button" class="btn btn-primary" onclick="learnMoreInvestment()">
                        <i class="fas fa-book"></i> Saznajte više o investiranju
                    </button>
                    <button type="button" class="btn btn-success" onclick="resetForm()">
                        <i class="fas fa-redo"></i> Novi proračun
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Modal funkcije
        function openModal(modalId) {
            console.log('Otvaram modal:', modalId);
            const modal = document.getElementById(modalId);
            if (modal) {
                // Zatvori sve druge modale prvo
                closeModal();
                
                // Postavi event listener za ESC taster
                const handleKeyDown = (e) => {
                    if (e.key === 'Escape') {
                        closeModal();
                        document.removeEventListener('keydown', handleKeyDown);
                    }
                };
                
                // Dodaj event listener
                document.addEventListener('keydown', handleKeyDown);
                
                // Prikaži željeni modal
                modal.style.display = 'flex';
                document.body.classList.add('modal-open');
                
                // Postavi event listener za klik izvan modala
                modal.addEventListener('click', function outsideClick(e) {
                    if (e.target === modal) {
                        closeModal();
                        modal.removeEventListener('click', outsideClick);
                    }
                });
                
                // Fokusiraj prvo input polje u modalu ako postoji
                setTimeout(() => {
                    const firstInput = modal.querySelector('input:not([type="hidden"]), select, textarea, button');
                    if (firstInput) firstInput.focus();
                }, 100);
            } else {
                console.error('Modal sa ID-jem', modalId, 'nije pronađen');
            }
        }
        
        // S&P 500 Investment Calculator Functionality (7% godišnji prinos)
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize form elements
            const loanForm = document.getElementById('loanForm');
            const loanAmount = document.getElementById('loanAmount');
            const loanAmountRange = document.getElementById('loanAmountRange');
            const loanTerm = document.getElementById('loanTerm');
            const loanTermRange = document.getElementById('loanTermRange');
            const yearlyContribution = document.getElementById('yearlyContribution');
            const yearlyContributionRange = document.getElementById('yearlyContributionRange');
            
            // Definisanje fiksne stope prinosa (S&P 500 prosečan prinos 7%)
            const ANNUAL_RETURN_RATE = 0.07;
            
            // Chart instance
            let investmentChart = null;
            
            // Sync range inputs with number inputs
            loanAmount.addEventListener('input', () => {
                loanAmountRange.value = loanAmount.value;
                calculateInvestment();
            });
            
            loanAmountRange.addEventListener('input', () => {
                loanAmount.value = loanAmountRange.value;
                calculateInvestment();
            });
            
            loanTerm.addEventListener('input', () => {
                loanTermRange.value = loanTerm.value;
                calculateInvestment();
            });
            
            loanTermRange.addEventListener('input', () => {
                loanTerm.value = loanTermRange.value;
                calculateInvestment();
            });
            
            yearlyContribution.addEventListener('input', () => {
                yearlyContributionRange.value = yearlyContribution.value;
                calculateInvestment();
            });
            
            yearlyContributionRange.addEventListener('input', () => {
                yearlyContribution.value = yearlyContributionRange.value;
                calculateInvestment();
            });
            
            // Form submission
            loanForm.addEventListener('submit', function(e) {
                e.preventDefault();
                calculateInvestment(true);
            });
            
            // Inicijalno izračunavanje - prikaži podrazumevane vrednosti
            function calculateInitialValues() {
                // Dobavljanje trenutnih vrednosti iz inputa
                const initialAmount = parseFloat(loanAmount.value) || 500000;
                const years = parseInt(loanTerm.value) || 20;
                const yearlyAmount = parseFloat(yearlyContribution.value) || 75000;
                
                // Izvrši izračun
                let currentValue = initialAmount;
                let totalContributed = initialAmount;
                
                // Izračunavanje za svaku godinu
                for (let year = 1; year <= years; year++) {
                    // Dodavanje godišnjeg doprinosa
                    currentValue += yearlyAmount;
                    totalContributed += yearlyAmount;
                    
                    // Dodavanje godišnjeg prinosa
                    currentValue *= (1 + ANNUAL_RETURN_RATE);
                }
                
                // Izračunavanje povrata i ROI
                const totalReturn = currentValue - totalContributed;
                const roi = (totalReturn / totalContributed) * 100;
                
                // Formatiranje brojeva za prikaz
                document.getElementById('initialInvestment').textContent = formatCurrency(initialAmount);
                document.getElementById('totalContributed').textContent = formatCurrency(totalContributed);
                document.getElementById('totalReturn').innerHTML = formatCurrency(totalReturn) + 
                    `<br><span style="color: #10b981; font-size: 0.9em; font-weight: bold;">ROI: ${roi.toFixed(2)}%</span>`;
                document.getElementById('finalValue').textContent = formatCurrency(currentValue);
            }
            
            calculateInitialValues();
            
            // Function to calculate investment growth
            function calculateInvestment(showResults = false) {
                const initialAmount = parseFloat(loanAmount.value) || 500000;
                const years = parseInt(loanTerm.value) || 20;
                const yearlyAmount = parseFloat(yearlyContribution.value) || 75000;
                
                // Niz za praćenje rasta investicije po godinama
                let yearlyData = [];
                let currentValue = initialAmount;
                
                // Početna vrednost ulaganja
                yearlyData.push({
                    year: 0,
                    invested: initialAmount,
                    value: initialAmount,
                    return: 0
                });
                
                // Izračunavanje za svaku godinu
                for (let year = 1; year <= years; year++) {
                    // Dodavanje godišnjeg doprinosa
                    currentValue += yearlyAmount;
                    
                    // Dodavanje godišnjeg prinosa
                    currentValue *= (1 + ANNUAL_RETURN_RATE);
                    
                    // Ukupno uloženo do sada
                    const totalInvested = initialAmount + (yearlyAmount * year);
                    
                    // Dodavanje podataka za godinu
                    yearlyData.push({
                        year: year,
                        invested: totalInvested,
                        value: currentValue,
                        return: currentValue - totalInvested
                    });
                }
                
                // Ukupno investirano
                const totalContributed = initialAmount + (yearlyAmount * years);
                
                // Izračunavanje ROI (Return on Investment)
                const totalReturn = currentValue - totalContributed;
                const roi = (totalReturn / totalContributed) * 100;
                
                console.log('Izračunavanje:', {
                    initialAmount,
                    years,
                    yearlyAmount,
                    currentValue,
                    totalContributed,
                    totalReturn,
                    roi: roi.toFixed(2) + '%'
                });
                
                // Prikaz rezultata
                if (showResults) {
                    // Formatiranje brojeva za prikaz
                    document.getElementById('initialInvestment').textContent = formatCurrency(initialAmount);
                    document.getElementById('totalContributed').textContent = formatCurrency(totalContributed);
                    document.getElementById('finalValue').textContent = formatCurrency(currentValue);
                    
                    // Postavljanje povrata i ROI-a koristeći nove elemente
                    document.getElementById('totalReturnValue').textContent = formatCurrency(totalReturn);
                    document.getElementById('roiValue').textContent = `ROI: ${roi.toFixed(2).replace('.', ',')}%`;
                    
                    // Sakrivanje forme i prikaz samo grafikona i rezultata
                    loanForm.style.display = 'none';
                    const resultsContainer = document.getElementById('results');
                    resultsContainer.style.display = 'block';
                    
                    // Forsiranje reflow-a za bolji prikaz grafikona
                    setTimeout(() => {
                        window.dispatchEvent(new Event('resize'));
                    }, 10);
                    
                    // Kreiranje grafikona sa proverom Chart.js biblioteke
                    setTimeout(() => {
                        if (typeof Chart !== 'undefined') {
                            createInvestmentChart(yearlyData);
                        } else {
                            console.error('Chart.js biblioteka nije učitana! Pokušavamo ponovo učitati...');
                            loadChartJS(() => createInvestmentChart(yearlyData));
                        }
                    }, 300);
                }
            }
            
            // Kreiranje HTML grafikona investicije
            function createInvestmentChart(data) {
                console.log('Kreiranje HTML grafikona investicije...', data);
                
                // Proveravamo da li je kontejner dostupan
                const graphContainer = document.getElementById('graphContainer');
                if (!graphContainer) {
                    console.error('Kontejner za grafikon nije pronađen!');
                    return;
                }
                
                // Brišemo prethodni sadržaj
                graphContainer.innerHTML = '';
                
                // Filtriramo samo relevantne godine (preskacemo nultu godinu i ostavljamo samo godinu 1+)
                const relevantData = data.filter(item => item.year > 0);
                
                // Nalazimo maksimalnu vrednost za skaliranje
                const maxValue = Math.max(...relevantData.map(item => item.value));
                
                // Kreiramo vizuelni prikaz za svaku godinu
                relevantData.forEach(item => {
                    const yearContainer = document.createElement('div');
                    yearContainer.style.display = 'flex';
                    yearContainer.style.flexDirection = 'column';
                    yearContainer.style.alignItems = 'center';
                    yearContainer.style.minWidth = '80px';
                    yearContainer.style.flex = '1';
                    yearContainer.style.marginRight = '10px';
                    
                    // Bar graf
                    const barContainer = document.createElement('div');
                    barContainer.style.display = 'flex';
                    barContainer.style.flexDirection = 'column-reverse';
                    barContainer.style.width = '60px';
                    barContainer.style.height = '100%';
                    barContainer.style.position = 'relative';
                    
                    // Izračunavamo visinu za investirani deo i prinos kao procenat maksimalne vrednosti
                    const investedHeight = (item.invested / maxValue) * 100;
                    const returnHeight = (item.return / maxValue) * 100;
                    
                    // Dodajemo deo za uloženo
                    const investedBar = document.createElement('div');
                    investedBar.style.height = `${investedHeight}%`;
                    investedBar.style.backgroundColor = '#1976d2';
                    investedBar.style.width = '100%';
                    investedBar.style.borderTopLeftRadius = '4px';
                    investedBar.style.borderTopRightRadius = '4px';
                    investedBar.style.position = 'relative';
                    investedBar.title = `Uloženo: ${formatCurrency(item.invested)}`;
                    barContainer.appendChild(investedBar);
                    
                    // Dodajemo deo za prinos
                    if (item.return > 0) {
                        const returnBar = document.createElement('div');
                        returnBar.style.height = `${returnHeight}%`;
                        returnBar.style.backgroundColor = '#2ecc71';
                        returnBar.style.width = '100%';
                        returnBar.style.borderTopLeftRadius = '4px';
                        returnBar.style.borderTopRightRadius = '4px';
                        returnBar.style.position = 'absolute';
                        returnBar.style.bottom = `${investedHeight}%`;
                        returnBar.style.left = '0';
                        
                        // Izračunavamo ROI
                        const roi = (item.return / item.invested) * 100;
                        returnBar.title = `Prinos: ${formatCurrency(item.return)} (ROI: ${roi.toFixed(2)}%)`;
                        barContainer.appendChild(returnBar);
                    }
                    
                    yearContainer.appendChild(barContainer);
                    
                    // Dodajemo oznaku godine
                    const yearLabel = document.createElement('div');
                    yearLabel.textContent = `Godina ${item.year}`;
                    yearLabel.style.marginTop = '8px';
                    yearLabel.style.fontWeight = 'bold';
                    yearLabel.style.fontSize = '12px';
                    yearContainer.appendChild(yearLabel);
                    
                    // Dodajemo vrednost
                    const valueLabel = document.createElement('div');
                    valueLabel.textContent = formatCurrency(item.value, false);
                    valueLabel.style.marginTop = '4px';
                    valueLabel.style.fontSize = '11px';
                    yearContainer.appendChild(valueLabel);
                    
                    graphContainer.appendChild(yearContainer);
                });
                
                // Dodajemo liniju koja predstavlja rast investicije
                const svgContainer = document.createElement('div');
                svgContainer.style.position = 'absolute';
                svgContainer.style.top = '0';
                svgContainer.style.left = '0';
                svgContainer.style.width = '100%';
                svgContainer.style.height = '100%';
                svgContainer.style.pointerEvents = 'none';
                
                // Dodajemo poruku ako nema podataka
                if (relevantData.length === 0) {
                    const noDataMsg = document.createElement('div');
                    noDataMsg.textContent = 'Nema podataka za prikaz. Izračunajte investiciju.';
                    graphContainer.appendChild(noDataMsg);
                }
            }
            
            // Formatiranje valute
            function formatCurrency(value, includeCurrency = true) {
                const formatter = new Intl.NumberFormat('sr-RS', {
                    style: includeCurrency ? 'currency' : 'decimal',
                    currency: 'RSD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                });
                return formatter.format(value);
            }
            
            // Resetovanje forme
            window.resetForm = function() {
                loanAmount.value = 500000;
                loanAmountRange.value = 500000;
                loanTerm.value = 10;
                loanTermRange.value = 10;
                yearlyContribution.value = 100000;
                yearlyContributionRange.value = 100000;
                document.getElementById('results').style.display = 'none';
                if (loanForm) loanForm.style.display = 'block';
                if (typeof calculateInvestment === 'function') calculateInvestment();
            };
            
            // Funkcija za više informacija o investiranju
            window.learnMoreInvestment = function() {
                alert('Za više informacija o investiranju u indeksne fondove poput S&P 500 i kako možete započeti, kontaktirajte naše finansijske savetnike putem korisničke podrške.');
            };
            
            // Funkcija za štampanje rezultata
            window.printResults = function() {
                window.print();
            };
            
            // Inicijalno izračunavanje
            calculateInvestment();
        });
        
        // Chat funkcionalnost je prebačena u DOMContentLoaded event listener
        
        // Funkcija za prikazivanje predloženih pitanja
function showSuggestedQuestions() {
    if (!window.chatMessages) return;
    window.chatMessages.innerHTML = '';
    const welcomeMessage = document.createElement('div');
    welcomeMessage.classList.add('message', 'bot-message');
    welcomeMessage.innerHTML = ChatBotKB.getGreeting();
    window.chatMessages.appendChild(welcomeMessage);
    const suggestions = ['Kako da postavim budžet?', 'Imam problem sa prijavom', 'Saveti za investiranje'];
    const suggestionsContainer = document.createElement('div');
    suggestionsContainer.classList.add('suggestions-container');
    suggestions.forEach(suggestion => {
        const suggestionElement = document.createElement('div');
        suggestionElement.classList.add('suggestion');
        suggestionElement.textContent = suggestion;
        suggestionElement.onclick = () => sendMessage(suggestion);
        suggestionsContainer.appendChild(suggestionElement);
    });
    window.chatMessages.appendChild(suggestionsContainer);
    window.chatMessages.scrollTop = window.chatMessages.scrollHeight;
}

// Funkcija za zatvaranje chata
function closeChatFunction() {
    if (chatContainer) {
        chatContainer.style.opacity = '0';
        chatContainer.style.transform = 'translateY(20px)';
        setTimeout(() => {
            chatContainer.style.display = 'none';
        }, 300);
    }
}

// Funkcija za pronalaženje odgovora u bazi znanja
function findAnswer(question) {
    // Koristi ChatBotKB API za generisanje odgovora
    const response = ChatBotKB.getResponse(question);
    
    if (response) {
        return {
            response: response,
            isDefault: false
        };
    }
    
    // Ako nije pronađen odgovor, vrati null
    return null;
}

// Funkcija za prikazivanje kontakt forme
function showContactForm(question) {
    // Sačuvaj pitanje u privremenu promenljivu
    window.currentQuestion = question;
    
    // Kreiraj HTML za kontakt formu
    const contactFormHTML = `
        <div class="contact-form">
            <p>Nažalost, trenutno nemam odgovor na vaše pitanje. Da biste dobili pomoć, molimo unesite sledeće podatke i naš broker će vas kontaktirati u najkraćem mogućem roku.</p>
            <div class="form-group">
                <label for="contactEmail">Vaša email adresa:</label>
                <input type="email" id="contactEmail" class="form-control" placeholder="unesite@email.com" required>
            </div>
            <div class="form-group">
                <label for="contactPhone">Broj telefona (opciono):</label>
                <input type="tel" id="contactPhone" class="form-control" placeholder="+381 6x xxx xxxx">
            </div>
            <button id="submitContactForm" class="btn btn-primary">Pošalji zahtev</button>
        </div>
    `;
    
    if (chatMessages) {
        const botMessageElement = document.createElement('div');
        botMessageElement.classList.add('message', 'bot-message');
        botMessageElement.innerHTML = contactFormHTML;
        chatMessages.appendChild(botMessageElement);
        
        // Dodaj event listener za dugme za slanje
        setTimeout(() => {
            const submitBtn = document.getElementById('submitContactForm');
            if (submitBtn) {
                submitBtn.addEventListener('click', submitContactForm);
            }
        }, 100);
    }
    
    // Scroll to bottom
    if (chatMessages) chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Funkcija za slanje kontakt podataka
function submitContactForm() {
    const email = document.getElementById('contactEmail')?.value.trim();
    const phone = document.getElementById('contactPhone')?.value.trim() || 'Nije naveden';
    const question = window.currentQuestion || 'Nije navedeno pitanje';
    
    if (!email) {
        alert('Molimo unesite vašu email adresu.');
        return;
    }
    
    // Sačuvaj pitanje
    const questionId = saveUnansweredQuestion(question, email, phone);
    
    // Prikaži poruku o uspehu
    const successMessage = document.createElement('div');
    successMessage.classList.add('message', 'bot-message');
    successMessage.innerHTML = `
        <p>Hvala vam! Vaš upit je uspešno poslat. Broj vašeg tiket-a je: <strong>#${questionId}</strong></p>
        <p>Naš tim će vam se obratiti u najkraćem mogućem roku na email adresu: <strong>${email}</strong></p>
        <p>Hvala na strpljenju!</p>
    `;
    
    // Zameni formu porukom o uspehu
    const contactForm = document.querySelector('.contact-form');
    if (contactForm) {
        contactForm.replaceWith(successMessage);
    } else if (chatMessages) {
        chatMessages.appendChild(successMessage);
    }
    
    // Scroll to bottom
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Funkcija za čuvanje neodgovorenog pitanja u localStorage
function saveUnansweredQuestion(question, email = '', phone = 'Nije naveden') {
    // Proveri da li već postoje sačuvana pitanja
    const savedQuestions = JSON.parse(localStorage.getItem('unansweredQuestions') || '[]');
    
    // Dodaj novo pitanje
    const newQuestion = {
        id: Date.now(),
        question: question,
        email: email || 'Nije naveden',
        phone: phone || 'Nije naveden',
        timestamp: new Date().toISOString(),
        status: 'new' // Može biti 'new', 'in_progress', 'resolved'
    };
    
    // Dodaj novo pitanje na početak niza
    savedQuestions.unshift(newQuestion);
    
    // Sačuvaj u localStorage
    localStorage.setItem('unansweredQuestions', JSON.stringify(savedQuestions));
    
    // Event koji će obavestiti admin stranicu o novom pitanju
    window.dispatchEvent(new Event('unansweredQuestionAdded'));
    
    return newQuestion.id; // Vraćamo ID za referencu ako je potrebno
}

// Funkcija za prikazivanje kontakt forme
function showContactForm(question) {
    const chatMessages = document.getElementById('chatMessages');
    if (!chatMessages) return;
    
    const contactForm = `
        <div class="contact-form">
            <p>Nažalost, nisam siguran kako da vam pomognem sa pitanjem: "${question}"</p>
            <p>Molimo popunite sledeći formular i naš tim će vam se javiti u najkraćem mogućem roku.</p>
            <form id="supportForm">
                <input type="hidden" name="question" value="${question}">
                <div class="form-group">
                    <label for="name">Ime i prezime:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email adresa:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Dodatne napomene (opciono):</label>
                    <textarea id="message" name="message" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Pošalji upit</button>
            </form>
        </div>
    `;

    const formContainer = document.createElement('div');
    formContainer.innerHTML = contactForm;
    chatMessages.appendChild(formContainer);
    
    // Dodajemo event listener za formu
    const supportForm = document.getElementById('supportForm');
    if (supportForm) {
        supportForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Simuliramo slanje podataka
            const response = document.createElement('div');
            response.classList.add('message', 'bot-message');
            response.innerHTML = 'Hvala vam na upitu! Naš tim će vam se javiti u najkraćem mogućem roku.';
            chatMessages.appendChild(response);
            
            // Brišemo formu
            formContainer.remove();
            chatMessages.scrollTop = chatMessages.scrollHeight;
        });
    }
    
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Glavna funkcija za slanje poruke
function sendMessage(suggestedMessage) {
    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');
    
    if (!chatMessages || !userInput) return;
    
    const messageText = suggestedMessage || userInput.value.trim();
    if (!messageText) return;
    
    // Dodajemo korisnikovu poruku u chat
    const messageElement = document.createElement('div');
    messageElement.classList.add('message', 'user-message');
    messageElement.textContent = messageText;
    chatMessages.appendChild(messageElement);
    
    // Brišemo input samo ako nije predložena poruka (sugestija)
    if (!suggestedMessage) {
        userInput.value = '';
    }
    
    // Prikazujemo indikator kucanja
    const typingIndicator = document.createElement('div');
    typingIndicator.classList.add('message', 'bot-message', 'typing');
    typingIndicator.id = 'typingIndicator';
    typingIndicator.textContent = 'Pišem...';
    chatMessages.appendChild(typingIndicator);
    chatMessages.scrollTop = chatMessages.scrollHeight;
    
    // Simuliramo kašnjenje odgovora
    setTimeout(() => {
        // Uklanjamo indikator kucanja
        const indicator = document.getElementById('typingIndicator');
        if (indicator) {
            indicator.remove();
        }

        // Proveravamo da li postoji odgovor u bazi znanja
        const answer = findAnswer(messageText);

        if (answer) {
            // Ako postoji odgovor u bazi znanja, prikažemo ga
            const responseElement = document.createElement('div');
            responseElement.classList.add('message', 'bot-message');
            responseElement.innerHTML = answer.response;
            chatMessages.appendChild(responseElement);
        } else {
            // Ako ne postoji odgovor, prikažemo kontakt formu
            showContactForm(messageText);
        }

        // Skrolujemo na dno čata
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }, 1500); // Simuliramo vreme potrebno za pisanje odgovora
}

// Inicijalizacija chat-a kada se stranica učita
        // Chat je već inicijalizovan u prethodnom DOMContentLoaded listeneru
        
        
        // Funkcija za rukovanje slanjem forme za konsultacije
        function submitConsultationForm(event) {
            event.preventDefault();
            
            // Preuzimanje vrednosti iz forme
            const name = document.getElementById('clientName').value.trim();
            const email = document.getElementById('clientEmail').value.trim();
            const phone = document.getElementById('clientPhone').value.trim();
            const date = document.getElementById('consultationDate').value;
            const time = document.getElementById('consultationTime').value;
            const topic = document.getElementById('consultationTopic').value;
            const note = document.getElementById('consultationNote').value.trim();
            
            // Validacija obaveznih polja
            if (!name || !email || !date || !time || !topic) {
                alert('Molimo popunite sva obavezna polja (ime, email, datum, vreme i tema).');
                return;
            }
            
            // Validacija email formata
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Molimo unesite ispravnu email adresu.');
                return;
            }
            
            // Validacija datuma (ne može biti u prošlosti)
            const selectedDate = new Date(date);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (selectedDate < today) {
                alert('Datum konsultacije ne može biti u prošlosti.');
                return;
            }
            
            console.log('📅 Kreiram zahtev za konsultaciju:', { name, email, phone, date, time, topic, note });
            
            // Kreiranje objekta za čuvanje u admin panelu
            const consultationRequest = {
                id: 'consultation_' + Date.now(),
                client: name,
                email: email,
                phone: phone || 'Nije unet',
                date: date,
                time: time,
                type: topic,
                notes: note || 'Nema dodatnih napomena',
                status: 'pending', // Na čekanju odobrenja
                approval: 'pending', // Status odobrenja
                link: 'https://us05web.zoom.us/j/5031740065?pwd=VYHmLjM3CGXI4WxXgD8TOdC4mNuDLX.1', // Direktni Zoom link
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                approvedBy: null,
                rejectedReason: null,
                notified: false
            };
            
            // Sačuvaj zahtev u localStorage za admin panel
            let consultations = JSON.parse(localStorage.getItem('consultations') || '[]');
            consultations.push(consultationRequest);
            localStorage.setItem('consultations', JSON.stringify(consultations));
            
            console.log('✅ Zahtev za konsultaciju sačuvan u localStorage');
            
            // Skrij formu i prikaži success poruku
            document.getElementById('consultationForm').style.display = 'none';
            document.getElementById('consultationSuccess').style.display = 'block';
            
            // Resetuj formu za buduće korišćenje
            document.getElementById('consultationForm').reset();
            
            // Dodaj notifikaciju za administratora (opcionalno)
            addAdminNotification({
                id: 'notif_' + Date.now(),
                title: 'Nova konsultacija zahtev',
                message: `${name} je zatražio konsultaciju za ${date} u ${time}. Link za sastanak: https://us05web.zoom.us/j/5031740065?pwd=VYHmLjM3CGXI4WxXgD8TOdC4mNuDLX.1`,
                type: 'consultation',
                read: false,
                timestamp: new Date().toISOString()
            });
        }
        
        // Funkcija za dodavanje notifikacija administratoru
        function addAdminNotification(notification) {
            try {
                let adminNotifications = JSON.parse(localStorage.getItem('admin_notifications') || '[]');
                adminNotifications.unshift(notification); // Dodaj na vrh
                
                // Ograniči na poslednje 50 notifikacija
                if (adminNotifications.length > 50) {
                    adminNotifications = adminNotifications.slice(0, 50);
                }
                
                localStorage.setItem('admin_notifications', JSON.stringify(adminNotifications));
                console.log('📢 Admin notifikacija dodana:', notification.title);
            } catch (error) {
                console.error('Greška pri čuvanju admin notifikacije:', error);
            }
        }
    </script>
    
    <!-- Consultation Modal -->
    <div id="consultationModal" class="modal">
        <div class="modal-content" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 style="color: #D4AF37; text-align: center; margin-bottom: 1.5rem;">Zakažite Konsultacije</h2>
            
            <form id="consultationForm" onsubmit="submitConsultationForm(event)">
                <div class="form-group">
                    <label for="clientName">Ime i prezime</label>
                    <input type="text" id="clientName" required 
                           style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px;" />
                </div>
                
                <div class="form-group">
                    <label for="clientEmail">Email adresa</label>
                    <input type="email" id="clientEmail" required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px;" />
                </div>
                
                <div class="form-group">
                    <label for="location">Mjesto i država</label>
                    <input type="text" id="location" required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px;" />
                </div>
                
                <div class="form-group">
                    <label for="consultationTopic">Tema konsultacije</label>
                    <select id="consultationTopic" required
                            style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px; background-color: #fff;">
                        <option value="">Izaberite temu</option>
                        <option value="Licne finansije">Lične finansije</option>
                        <option value="Investicije">Investicije</option>
                        <option value="Penziisko osiguranje">Penzijsko osiguranje</option>
                        <option value="Porezi">Porezi</option>
                        <option value="Ostalo">Ostalo</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="consultationDate">Datum i vreme</label>
                    <input type="datetime-local" id="consultationDate" required
                           style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px;" />
                    <small style="color: #666; font-size: 0.8rem;">Dostupni termini: radnim danima između 09:00 i 17:00</small>
                </div>
                
                <div class="form-group">
                    <label for="description">Opis teme</label>
                    <textarea id="description" rows="4" required
                              style="width: 100%; padding: 0.75rem; border: 1px solid #D4AF37; border-radius: 4px;"></textarea>
                </div>
                
                <div id="formSuccess" style="display: none; color: #28a745; margin: 1rem 0; text-align: center;">
                    Uspešno ste zakazali konsultacije! Kontaktiraćemo vas u najkraćem roku.
                </div>
                
                <div id="formError" style="display: none; color: #dc3545; margin: 1rem 0; text-align: center;">
                </div>
                
                <button type="submit" class="primary-button" 
                        style="width: 100%; padding: 1rem; margin-top: 1rem;">
                    Zakaži konsultacije
                </button>
            </form>
        </div>
    </div>

    <!-- Testimonijal sekcija -->
    <section id="testimonials" style="background: var(--dark-bg); padding: var(--spacing-xl) 0; text-align: center; position: relative; overflow: hidden; margin-top: 0.5rem;">
        <!-- Hero-style background effect -->
        <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%), radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.05) 0%, transparent 40%); z-index: -1; opacity: 0.8;"></div>
        
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: var(--spacing-md);">
            <div style="text-align: center; margin-bottom: 3rem;">
                <h2 style="font-size: 3.75rem; font-weight: 800; margin-bottom: var(--spacing-md); background: linear-gradient(45deg, #FFD700, #D4AF37, #B8860B); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2); letter-spacing: -0.02em; line-height: 1.2; max-width: 900px; margin-left: auto; margin-right: auto;">
                    Šta kažu naši korisnici
                </h2>
                <p style="font-size: 1.25rem; color: var(--muted-text); margin-bottom: var(--spacing-xl); max-width: 800px; margin-left: auto; margin-right: auto; padding: var(--spacing-md); background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); line-height: 1.7;">
                    Pridružite se hiljadama zadovoljnih korisnika koji su transformisali svoje finansije uz Golden Balance
                </p>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
                <!-- Testimonijal 1 -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: 2rem; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=60&h=60&fit=crop&crop=face&auto=format" 
                             style="width: 60px; height: 60px; border-radius: 50%; margin-right: 1rem; border: 2px solid rgba(255, 215, 0, 0.3);" alt="Marko P.">
                        <div>
                            <h4 style="color: var(--light-text); margin-bottom: 0.25rem; font-weight: 600;">Marko Petrović</h4>
                            <p style="color: var(--muted-text); font-size: 0.9rem;">IT Menadžer, Beograd</p>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                    </div>
                    <p style="color: var(--light-text); line-height: 1.7; font-style: italic;">
                        "Golden Balance je potpuno promenio način na koji upravljam svojim finansijama. Sada imam jasnu sliku o svojim prihodima i rashodima, a budžet planer mi pomaže da štedim za buduće ciljeve."
                    </p>
                </div>

                <!-- Testimonijal 2 -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: 2rem; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                        <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=60&h=60&fit=crop&crop=face&auto=format" 
                             style="width: 60px; height: 60px; border-radius: 50%; margin-right: 1rem; border: 2px solid rgba(255, 215, 0, 0.3);" alt="Ana M.">
                        <div>
                            <h4 style="color: var(--light-text); margin-bottom: 0.25rem; font-weight: 600;">Ana Marković</h4>
                            <p style="color: var(--muted-text); font-size: 0.9rem;">Preduzetnica, Novi Sad</p>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                    </div>
                    <p style="color: var(--light-text); line-height: 1.7; font-style: italic;">
                        "Kao preduzetnica, potreban mi je pouzdan alat za praćenje poslovnih finansija. Golden Balance mi omogućava da lako pratim prihode, rashode i planiram investicije. Preporučujem svima!"
                    </p>
                </div>

                <!-- Testimonijal 3 -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: 2rem; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=60&h=60&fit=crop&crop=face&auto=format" 
                             style="width: 60px; height: 60px; border-radius: 50%; margin-right: 1rem; border: 2px solid rgba(255, 215, 0, 0.3);" alt="Stefan J.">
                        <div>
                            <h4 style="color: var(--light-text); margin-bottom: 0.25rem; font-weight: 600;">Stefan Jovanović</h4>
                            <p style="color: var(--muted-text); font-size: 0.9rem;">Finansijski savetnik, Kragujevac</p>
                        </div>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                        <i class="fas fa-star" style="color: #FFD700; text-shadow: 0 1px 3px rgba(255, 215, 0, 0.3);"></i>
                    </div>
                    <p style="color: var(--light-text); line-height: 1.7; font-style: italic;">
                        "Kao finansijski savetnik, preporučujem Golden Balance svim svojim klijentima. Jednostavan je za korišćenje, ima sve potrebne funkcionalnosti i odličan je za početak finansijskog planiranja."
                    </p>
                </div>
            </div>


        </div>
    </section>

    <!-- Sekcija o nama -->
    <section id="about" style="background: var(--dark-bg); padding: var(--spacing-xl) 0; position: relative; overflow: hidden; margin-top: 0.5rem;">
        <!-- Hero-style background effect -->
        <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%), radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.05) 0%, transparent 40%); z-index: -1; opacity: 0.8;"></div>
        
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: var(--spacing-md);">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: center;">
                <div>
                    <h2 style="font-size: 3.75rem; font-weight: 800; margin-bottom: var(--spacing-lg); background: linear-gradient(45deg, #FFD700, #D4AF37, #B8860B); -webkit-background-clip: text; -moz-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2); letter-spacing: -0.02em; line-height: 1.2;">
                        O Golden Balance
                    </h2>
                    <p style="font-size: 1.25rem; color: var(--muted-text); margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: rgba(30, 30, 30, 0.7); border-radius: var(--border-radius); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); border: 1px solid rgba(255, 215, 0, 0.1); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); line-height: 1.7;">
                        Golden Balance je napredna finansijska platforma kreirana da vam pomogne da potpuno kontrolišete svoje finansije. 
                        Naš tim stručnjaka za finansije i tehnologiju radi na tome da vam pruži alate koji su jednostavni za korišćenje, 
                        ali dovoljno moćni da zadovolje sve vaše potrebe.
                    </p>
                    <p style="font-size: 1.25rem; color: var(--muted-text); margin-bottom: var(--spacing-xl); padding: var(--spacing-md); background: rgba(30, 30, 30, 0.7); border-radius: var(--border-radius); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); border: 1px solid rgba(255, 215, 0, 0.1); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); line-height: 1.7;">
                        Verujemo da svako zaslužuje pristup profesionalnim finansijskim alatima, bez obzira na veličinu portfolija. 
                        Zato smo Golden Balance učinili dostupnim svima koji žele da poboljšaju svoje finansijsko zdravlje.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 1rem; background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-md); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);">
                            <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #FFD700, #D4AF37); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                                <i class="fas fa-shield-alt" style="color: var(--dark-bg); font-size: 1.2rem;"></i>
                            </div>
                            <div>
                                <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.25rem; font-weight: 600;">Sigurnost</h4>
                                <p style="color: var(--muted-text); font-size: 0.9rem;">Bank-level enkripcija</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 1rem; background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-md); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);">
                            <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #FFD700, #D4AF37); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                                <i class="fas fa-chart-line" style="color: var(--dark-bg); font-size: 1.2rem;"></i>
                            </div>
                            <div>
                                <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.25rem; font-weight: 600;">Analitika</h4>
                                <p style="color: var(--muted-text); font-size: 0.9rem;">Napredni izveštaji</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 1rem; background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-md); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);">
                            <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #FFD700, #D4AF37); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                                <i class="fas fa-users" style="color: var(--dark-bg); font-size: 1.2rem;"></i>
                            </div>
                            <div>
                                <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.25rem; font-weight: 600;">Podrška</h4>
                                <p style="color: var(--muted-text); font-size: 0.9rem;">24/7 stručna pomoć</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 1rem; background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius); padding: var(--spacing-md); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36);">
                            <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #FFD700, #D4AF37); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                                <i class="fas fa-mobile-alt" style="color: var(--dark-bg); font-size: 1.2rem;"></i>
                            </div>
                            <div>
                                <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.25rem; font-weight: 600;">Mobilnost</h4>
                                <p style="color: var(--muted-text); font-size: 0.9rem;">Pristup svugde</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="position: relative;">
                    <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius-lg); padding: 3rem; text-align: center; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); transform: rotate(3deg); position: relative; overflow: hidden;">
                        <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), transparent); pointer-events: none; z-index: -1;"></div>
                        <div style="background: rgba(10, 10, 10, 0.8); border-radius: var(--border-radius); padding: 2rem; transform: rotate(-3deg); border: 1px solid rgba(255, 215, 0, 0.2);">
                            <h3 style="font-size: 1.8rem; font-weight: 800; background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 1rem; text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);">Naša misija</h3>
                            <p style="color: var(--muted-text); line-height: 1.7; font-style: italic;">
                                "Učiniti finansijsko planiranje jednostavnim, dostupnim i efikasnim za sve ljude, 
                                omogućavajući im da ostvare svoje finansijske ciljeve i sanjaju veću budućnost."
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- Footer sekcija -->
    <footer style="background: var(--dark-bg); border-top: 1px solid rgba(255, 215, 0, 0.2); padding: var(--spacing-xl) 0 var(--spacing-md); position: relative; overflow: hidden; margin-top: 0.5rem;">
        <!-- Hero-style background effect -->
        <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%), radial-gradient(circle at 80% 70%, rgba(184, 134, 11, 0.05) 0%, transparent 40%); z-index: -1; opacity: 0.8;"></div>
        
        <div class="container" style="max-width: 1200px; margin: 0 auto; padding: var(--spacing-md);">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 2rem;">
                <!-- Logo i opis -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius-lg); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                        <div style="width: 50px; height: 50px; background: linear-gradient(45deg, #FFD700, #D4AF37); border-radius: var(--border-radius); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);">
                            <i class="fas fa-coins" style="color: var(--dark-bg); font-size: 1.5rem;"></i>
                        </div>
                        <h3 style="font-size: 1.5rem; font-weight: 800; background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                            Golden Balance
                        </h3>
                    </div>
                    <p style="color: var(--muted-text); line-height: 1.7; margin-bottom: 1.5rem;">
                        Vaša potpuna finansijska platforma za upravljanje budžetom, praćenje troškova i ostvarivanje finansijskih ciljeva.
                    </p>
                    <div style="display: flex; gap: 1rem;">
                        <a href="#" style="width: 40px; height: 40px; background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: var(--gold-bright); text-decoration: none; transition: all 0.3s ease; backdrop-filter: blur(4px);">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" style="width: 40px; height: 40px; background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: var(--gold-bright); text-decoration: none; transition: all 0.3s ease; backdrop-filter: blur(4px);">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" style="width: 40px; height: 40px; background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: var(--gold-bright); text-decoration: none; transition: all 0.3s ease; backdrop-filter: blur(4px);">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="#" style="width: 40px; height: 40px; background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: var(--gold-bright); text-decoration: none; transition: all 0.3s ease; backdrop-filter: blur(4px);">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>

                <!-- Linkovi -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius-lg); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600; margin-bottom: 1.5rem;">Funkcionalnosti</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#" onclick="showSection('dashboard')" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Dashboard</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="profile.html" onclick="localStorage.setItem('activeProfileTab', '1'); localStorage.setItem('activeExpenseTab', '0');" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Budžet planer</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="profile.html" onclick="localStorage.setItem('activeProfileTab', '1');" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Analitika</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#" onclick="openModal('calculatorModal')" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Investicioni kalkulator</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#" onclick="openModal('consultationModal')" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Konsultacije</a>
                        </li>
                    </ul>
                </div>

                <!-- Podrška -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius-lg); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600; margin-bottom: 1.5rem;">Podrška</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#" onclick="openModal('supportModal')" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Pomoć</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#about" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Česta pitanja</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#" onclick="showContactForm()" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Kontakt</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#privacy" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Privatnost</a>
                        </li>
                        <li style="margin-bottom: 0.75rem;">
                            <a href="#terms" style="color: var(--muted-text); text-decoration: none; transition: color 0.3s ease;">Uslovi korišćenja</a>
                        </li>
                    </ul>
                </div>

                <!-- Kontakt -->
                <div style="background: rgba(30, 30, 30, 0.7); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: var(--border-radius-lg); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                    <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                    <h4 style="background: linear-gradient(45deg, #FFD700, #D4AF37); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600; margin-bottom: 1.5rem;">Kontakt</h4>
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <i class="fas fa-envelope" style="color: var(--gold-bright); width: 16px;"></i>
                            <span style="color: var(--muted-text);">zorandostica2@gmail.com</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                            <i class="fas fa-phone" style="color: var(--gold-bright); width: 16px;"></i>
                            <span style="color: var(--muted-text);">+381 62 961 4625</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <i class="fas fa-map-marker-alt" style="color: var(--gold-bright); width: 16px;"></i>
                            <span style="color: var(--muted-text);">Beograd, Srbija</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Copyright -->
            <div style="border-top: 1px solid rgba(255, 215, 0, 0.2); padding-top: 2rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; background: rgba(30, 30, 30, 0.7); border-radius: var(--border-radius); padding: var(--spacing-lg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.36); position: relative; overflow: hidden;">
                <div style="content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(255, 215, 0, 0.03), transparent); pointer-events: none; z-index: -1;"></div>
                <p style="color: var(--muted-text); margin: 0;">
                    © 2025 Golden Balance. Sva prava zadržana.
                </p>
                <p style="color: var(--muted-text); margin: 0; font-size: 0.9rem;">
                    Kreiran sa ❤️ za vaše finansije
                </p>
            </div>
        </div>
    </footer>

    <!-- Finalni crni prostor -->
    <div style="background: var(--dark-bg); padding: 1.5rem 0;"></div>

    <script>
        // Inicijalizacija modala i drugih skripti ako je potrebno
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Glavna inicijalizacija stranice');
            
            // Eksplicitno učitavanje korisnika iz skladišta
            const sessionUser = sessionStorage.getItem('currentUser');
            const localUser = localStorage.getItem('currentUser');
            
            if (sessionUser) {
                currentUser = JSON.parse(sessionUser);
                console.log('Glavna inicijalizacija: Učitan korisnik iz session storage:', currentUser);
            } else if (localUser) {
                currentUser = JSON.parse(localUser);
                console.log('Glavna inicijalizacija: Učitan korisnik iz local storage:', currentUser);
            }
            
            // Provera da li je korisnik ulogovan i ažuriranje UI-ja
            updateUI();
            
            // Smooth scrolling za footer linkove
            document.querySelectorAll('footer a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Hover efekti za social media linkove
            const socialLinks = document.querySelectorAll('footer a[style*="background: rgba(212, 175, 55, 0.1)"]');
            if (socialLinks && socialLinks.length > 0) {
                socialLinks.forEach(link => {
                    link.addEventListener('mouseenter', function() {
                        this.style.background = 'var(--gradient-gold)';
                        this.style.color = 'var(--dark-bg)';
                    });
                    
                    link.addEventListener('mouseleave', function() {
                        this.style.background = 'rgba(212, 175, 55, 0.1)';
                        this.style.color = 'var(--gold-bright)';
                    });
                });
            }

            // Hover efekti za footer linkove
            const footerLinks = document.querySelectorAll('footer a[style*="color: var(--muted-text)"]');
            if (footerLinks && footerLinks.length > 0) {
                footerLinks.forEach(link => {
                    link.addEventListener('mouseenter', function() {
                        this.style.color = 'var(--gold-bright)';
                    });
                    
                    link.addEventListener('mouseleave', function() {
                        this.style.color = 'var(--muted-text)';
                    });
                });
            }

            // Animacija brojčanika za statistike
            function animateCounter(element, finalValue, duration = 2000) {
                let currentValue = 0;
                const increment = finalValue / (duration / 16); // 60fps
                
                const updateCounter = () => {
                    currentValue += increment;
                    if (currentValue >= finalValue) {
                        element.textContent = finalValue;
                    } else {
                        element.textContent = Math.floor(currentValue);
                        requestAnimationFrame(updateCounter);
                    }
                };
                
                updateCounter();
            }

            // Intersection Observer za pokretanje animacije kada korisnik vidi statistike
            const statsSection = document.querySelector('#counterUsers');
            if (statsSection) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            // Animiraj brojčanik za korisnike do 1000
                            animateCounter(document.getElementById('counterUsers'), 1000, 2500);
                            observer.unobserve(entry.target); // Animiraj samo jednom
                        }
                    });
                }, {
                    threshold: 0.5 // Pokreni animaciju kada je 50% elementa vidljivo
                });
                
                observer.observe(statsSection);
            }
            
            // Support Chat funkcionalnost
            window.sendSupportMessage = function(predefinedMessage) {
                const chatMessages = document.getElementById('supportChatMessages');
                const userInput = document.getElementById('supportUserInput');
                
                if (!chatMessages || !userInput) return;
                
                const messageText = predefinedMessage || userInput.value.trim();
                if (!messageText) return;
                
                // Dodaj korisničku poruku
                const userMessage = document.createElement('div');
                userMessage.style.cssText = 'max-width: 80%; padding: 0.75rem 1rem; background: linear-gradient(45deg, #D4AF37, #FFD700); color: white; border-radius: 18px; border-bottom-right-radius: 5px; align-self: flex-end; margin-left: auto;';
                userMessage.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; justify-content: flex-end;">
                        <strong>Vi</strong>
                        <i class="fas fa-user" style="color: white;"></i>
                    </div>
                    <p style="margin: 0; line-height: 1.4;">${messageText}</p>
                `;
                chatMessages.appendChild(userMessage);
                
                // Očisti input ako nije predefinisana poruka
                if (!predefinedMessage) {
                    userInput.value = '';
                }
                
                // Skroluj na dno
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Prikaži "kuca..." indikator
                const typingIndicator = document.createElement('div');
                typingIndicator.id = 'typingIndicator';
                typingIndicator.style.cssText = 'max-width: 80%; padding: 0.75rem 1rem; background: #f0f0f0; border-radius: 18px; border-bottom-left-radius: 5px; align-self: flex-start; display: flex; align-items: center; gap: 0.5rem;';
                typingIndicator.innerHTML = `
                    <i class="fas fa-robot" style="color: #D4AF37;"></i>
                    <span style="color: #666; font-style: italic;">AI asistent kuca...</span>
                `;
                chatMessages.appendChild(typingIndicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Simuliraj delay i pronađi odgovor
                setTimeout(() => {
                    // Ukloni indikator
                    typingIndicator.remove();
                    
                    // Pronađi odgovor u bazi znanja
                    const answer = findAnswer(messageText);
                    
                    // Kreiraj bot poruku
                    const botMessage = document.createElement('div');
                    botMessage.style.cssText = 'max-width: 80%; padding: 0.75rem 1rem; background: #f0f0f0; border-radius: 18px; border-bottom-left-radius: 5px; align-self: flex-start;';
                    
                    if (answer) {
                        botMessage.innerHTML = `
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <i class="fas fa-robot" style="color: #D4AF37;"></i>
                                <strong style="color: #D4AF37;">AI Asistent</strong>
                            </div>
                            <p style="margin: 0; line-height: 1.4;">${answer.response}</p>
                        `;
                    } else {
                        // Proveri da li je pitanje vezano za investiranje
                        const lowerQuestion = messageText.toLowerCase();
                        const investmentKeywords = ['ulaganje', 'investiranje', 'investicija', 'uložiti', 'investiraj', 'portfolio', 'portfelj', 'fond', 'akcije', 'obveznice', 'berza', 'tržište', 'profit', 'prinos', 'rizik'];
                        const isInvestmentQuestion = investmentKeywords.some(keyword => 
                            lowerQuestion.includes(keyword.toLowerCase())
                        );
                        
                        if (isInvestmentQuestion) {
                            botMessage.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <i class="fas fa-robot" style="color: #D4AF37;"></i>
                                    <strong style="color: #D4AF37;">AI Asistent</strong>
                                </div>
                                <p style="margin: 0; line-height: 1.4;">Za vaše pitanje "${messageText}" preporučujem da se konsultujete sa našim stručnjakom!</p>
                                <p style="margin: 0.5rem 0; line-height: 1.4; color: #D4AF37; font-weight: 600;">🎯 <strong>BESPLATNA KONSULTACIJA</strong> sa <strong>Zoranom Dosticom</strong></p>
                                <p style="margin: 0.5rem 0 0 0; line-height: 1.4;">Zoran je licencirani finansijski savetnik sa preko 10 godina iskustva. Specijalizovan je za investicione strategije i finansijsko planiranje. Kliknite na dugme "Zakažite konsultacije" da zakažete termin!</p>
                                <div style="margin-top: 1rem;">
                                    <button onclick="closeModal(); openModal('consultationModal');" style="background: linear-gradient(45deg, #D4AF37, #FFD700); color: white; border: none; border-radius: 25px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 600; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                                        <i class="fas fa-calendar-check" style="margin-right: 0.5rem;"></i>
                                        Zakaži konsultaciju sa Zoranom
                                    </button>
                                </div>
                            `;
                        } else {
                            botMessage.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <i class="fas fa-robot" style="color: #D4AF37;"></i>
                                    <strong style="color: #D4AF37;">AI Asistent</strong>
                                </div>
                                <p style="margin: 0; line-height: 1.4;">Izvinjavam se, trenutno nemam odgovor na vaše pitanje: "${messageText}"</p>
                                <p style="margin: 0.5rem 0 0 0; line-height: 1.4; color: #666;">Za dodatnu pomoć možete kontaktirati našu korisničku podršku na email: <strong>support@goldenbalance.com</strong> ili pozovite: <strong>+381 11 123 4567</strong></p>
                                <p style="margin: 0.5rem 0 0 0; line-height: 1.4; color: #666; font-style: italic;">Takođe možete zakažiti besplatnu konsultaciju sa našim finansijskim savetnikom Zoranom Dosticom!</p>
                            `;
                        }
                    }
                    
                    chatMessages.appendChild(botMessage);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1500);
            };
        });
    </script>

    <!-- Plutajući AI Chat Bot -->
    <div class="chat-container" id="chatContainer">
        <div class="chat-header">
            <h3><i class="fas fa-robot"></i> AI Finansijski Asistent</h3>
            <button class="close-chat" id="closeChat">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Poruke će se dodavati dinamički -->
        </div>
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="Postavite pitanje o finansijama...">
            <button class="send-button" id="sendMessage">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Plutajuće chat dugme -->
    <button class="floating-chat-btn" id="chatToggle" title="Otvori AI Chat">
        <i class="fas fa-comments"></i>
    </button>

    <!-- Chat Bot JavaScript -->
    <script>
        // Chat varijable - koristi se global scope za sprečavanje redefinisanja
        if (typeof window.chatContainer === 'undefined') window.chatContainer = null;
        if (typeof window.chatMessages === 'undefined') window.chatMessages = null;
        if (typeof window.userInput === 'undefined') window.userInput = null;

        // Inicijalizacija chat-a
        document.addEventListener('DOMContentLoaded', () => {
            window.chatContainer = document.getElementById('chatContainer');
            window.chatMessages = document.getElementById('chatMessages');
            window.userInput = document.getElementById('userInput');

            // Event listeneri za chat
            document.getElementById('chatToggle')?.addEventListener('click', toggleChat);
            document.getElementById('closeChat')?.addEventListener('click', toggleChat);
            document.getElementById('supportBtn')?.addEventListener('click', toggleChat);
            document.getElementById('sendMessage')?.addEventListener('click', sendMessage);
            
            if (userInput) {
                userInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }

            // Dodaj početnu poruku
            addMessage('Zdravo! Ja sam vaš AI finansijski asistent. Kako vam mogu pomoći danas?', 'ai');
        });

        // Toggle chat funkcija
        function toggleChat() {
            if (!chatContainer) return;
            chatContainer.classList.toggle('active');
            if (chatContainer.classList.contains('active') && userInput) {
                userInput.focus();
            }
        }

        // Funkcija za slanje poruke
        function sendMessage() {
            if (!window.userInput || !window.chatMessages) return;
            
            const message = window.userInput.value.trim();
            if (!message) return;

            // Dodaj korisničku poruku
            addMessage(message, 'user');
            
            // Očisti input
            window.userInput.value = '';

            // Simuliraj AI odgovor
            const typingIndicator = addTypingIndicator();
            
            setTimeout(() => {
                // Ukloni typing indicator
                if (typingIndicator) typingIndicator.remove();
                
                // Generiši i prikaži AI odgovor koristeći ChatBotKB API
                const aiResponse = generateResponse(message);
                addMessage(aiResponse, 'ai');
            }, 1000 + Math.random() * 1000);
        }

        // Dodaj poruku u chat
        function addMessage(text, sender) {
            if (!chatMessages) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = sender + '-message';
            
            const icon = sender === 'ai' ? '<i class="fas fa-robot"></i>' : '<i class="fas fa-user"></i>';
            const name = sender === 'ai' ? 'AI Asistent' : 'Vi';
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    ${icon} <strong>${name}</strong>
                </div>
                <div class="message-content">
                    ${text}
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Dodaj typing indicator
        function addTypingIndicator() {
            if (!chatMessages) return null;

            const typingDiv = document.createElement('div');
            typingDiv.className = 'ai-message typing-indicator';
            typingDiv.innerHTML = `
                <div class="message-header">
                    <i class="fas fa-robot"></i> <strong>AI Asistent</strong>
                </div>
                <div class="typing-dots">
                    <span>.</span><span>.</span><span>.</span>
                </div>
            `;
            
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            return typingDiv;
        }

        // Generiši odgovor koristeći ChatBotKB API
        function generateResponse(message) {
            console.log('📣 Pozivanje generateResponse sa porukom:', message);
            console.log('📣 Trenutno učitane skripte:', document.scripts.length);
            console.log('📣 ChatBotKB dostupnost:', typeof ChatBotKB);
            
            // Proveri da li je ChatBotKB API dostupan
            if (typeof ChatBotKB === 'undefined') {
                console.error('ChatBotKB API nije dostupan! Pokušavamo da učitamo ponovo...');
                
                // Pokušaj da učitaš skriptu ponovo
                const script = document.createElement('script');
                script.src = 'finansijska_platforma_struktura/pages/js/kb.js';
                script.onload = function() {
                    console.log('✅ KB script uspešno učitan!');
                };
                script.onerror = function() {
                    console.error('❌ Greška pri učitavanju KB skripte!');
                };
                document.head.appendChild(script);
                
                return 'Izvinite, trenutno ne mogu da pristupim bazi znanja. Molim vas pokušajte ponovo za nekoliko sekundi.';
            }

            try {
                // Koristi ChatBotKB API za dobijanje odgovora
                console.log('📣 ChatBotKB metode:', Object.keys(ChatBotKB));
                const response = ChatBotKB.getResponse(message);
                console.log('📣 Odgovor od ChatBotKB:', response);
                return response;
            } catch (error) {
                console.error('Greška pri dobijanju odgovora:', error);
                return 'Izvinite, došlo je do greške. Molim vas pokušajte ponovo kasnije.';
            }
        }

        // Event listeneri za dugmad u hero sekciji
        document.addEventListener('DOMContentLoaded', () => {
            // Lične finansije dugme - vodi na "Moj Budžet" karticu
            const personalFinanceBtn = document.getElementById('personalFinanceBtn');
            if (personalFinanceBtn) {
                personalFinanceBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Proveri da li korisnik već ima unesena mesečna primanja
                    const savedBudget = JSON.parse(localStorage.getItem('userBudget')) || { monthlyIncome: 0 };
                    
                    // Redirect to profil stranu i postavi drugu karticu (Moj Budžet) kao aktivnu
                    localStorage.setItem('activeProfileTab', '1'); // Indeks 1 za "Moj Budžet" karticu
                    
                    // Ako korisnik ima unesen mesečni prihod, skrolaj do sekcije za unos troškova
                    if (savedBudget.monthlyIncome > 0) {
                        localStorage.setItem('scrollToSection', 'expenses');
                    } else {
                        // Ako nema unet mesečni prihod, skrolaj do forme za unos prihoda
                        localStorage.setItem('scrollToSection', 'budget');
                    }
                    
                    window.location.href = 'profile.html';
                });
            }

            // Praćenje budžeta dugme - takođe vodi na "Moj Budžet" karticu
            const budgetTrackingBtn = document.getElementById('budgetTrackingBtn');
            if (budgetTrackingBtn) {
                budgetTrackingBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Redirect to profil stranu i postavi drugu karticu (Moj Budžet) kao aktivnu
                    localStorage.setItem('activeProfileTab', '1'); // Indeks 1 za "Moj Budžet" karticu
                    localStorage.setItem('scrollToSection', 'expense-tracker');
                    localStorage.setItem('openExpenseTab', 'true');
                    window.location.href = 'profile.html';
                });
            }
            
            // "Moj Budžet" link u navigaciji
            const navBudgetLink = document.getElementById('navBudgetLink');
            if (navBudgetLink) {
                navBudgetLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Postavi "Moj Budžet" karticu kao aktivnu
                    localStorage.setItem('activeProfileTab', '1'); // Indeks 1 za "Moj Budžet" karticu
                    window.location.href = '/profile';
                });
            }
            
            // "Moj Profil" link u navigaciji
            const navProfileLink = document.getElementById('navProfileLink');
            if (navProfileLink) {
                navProfileLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Postavi "Moj Profil" karticu kao aktivnu
                    localStorage.setItem('activeProfileTab', '0'); // Indeks 0 za "Moj Profil" karticu
                    window.location.href = 'profile.html';
                });
            }
            
            // "Podešavanja" link u navigaciji
            const navSettingsLink = document.getElementById('navSettingsLink');
            if (navSettingsLink) {
                navSettingsLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Postavi "Podešavanja" karticu kao aktivnu
                    localStorage.setItem('activeProfileTab', '2'); // Indeks 2 za "Podešavanja" karticu
                    window.location.href = 'profile.html';
                });
            }
        });

        // Funkcionalnost zvonceta za notifikacije
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM učitan - inicijalizacija notifikacijskog sistema");
            
            // Dohvati elemente
            globalNotificationBtn = document.getElementById('notificationBtn');
            globalNotificationDropdown = document.getElementById('notificationDropdown');
            globalNotificationList = document.getElementById('notificationList');
            globalMarkAllReadBtn = document.getElementById('markAllRead');
            globalNotificationBadge = document.querySelector('.notification-badge');
            
            // Provjera da li su elementi pronađeni
            console.log("notificationBtn:", globalNotificationBtn ? "pronađen" : "nije pronađen");
            console.log("notificationDropdown:", globalNotificationDropdown ? "pronađen" : "nije pronađen");
            console.log("notificationList:", globalNotificationList ? "pronađen" : "nije pronađen");
            console.log("markAllReadBtn:", globalMarkAllReadBtn ? "pronađen" : "nije pronađen");
            console.log("notificationBadge:", globalNotificationBadge ? "pronađen" : "nije pronađen");
            
            // Funkcija za učitavanje pročitanih notifikacija iz localStorage
            function loadReadNotifications() {
                const readNotifications = JSON.parse(localStorage.getItem('readNotifications') || '[]');
                return readNotifications;
            }
            
            // Funkcija za čuvanje pročitanih notifikacija u localStorage
            function saveReadNotifications(readNotifications) {
                localStorage.setItem('readNotifications', JSON.stringify(readNotifications));
            }
            
            // Funkcija za proveru da li je notifikacija pročitana
            function isNotificationRead(notificationId) {
                const readNotifications = loadReadNotifications();
                return readNotifications.includes(notificationId);
            }
            
            // Funkcija za označavanje notifikacije kao pročitane
            function markNotificationAsRead(notificationId) {
                console.log("Označavanje notifikacije kao pročitane:", notificationId);
                const readNotifications = loadReadNotifications();
                
                // Ako notifikacija nije već označena kao pročitana
                if (!readNotifications.includes(notificationId)) {
                    readNotifications.push(notificationId);
                    saveReadNotifications(readNotifications);
                    console.log("Notifikacija dodana u pročitane:", notificationId);
                    
                    // Ažuriraj i u userNotifications/adminNotifications ako postoji
                    try {
                        let userNotifications = JSON.parse(localStorage.getItem('userNotifications') || '[]');
                        let userUpdated = false;
                        
                        userNotifications.forEach(notification => {
                            if (notification.id === notificationId && !notification.read) {
                                notification.read = true;
                                userUpdated = true;
                            }
                        });
                        
                        if (userUpdated) {
                            localStorage.setItem('userNotifications', JSON.stringify(userNotifications));
                            console.log("Ažurirane user notifikacije za ID:", notificationId);
                        }
                        
                        let adminNotifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
                        let adminUpdated = false;
                        
                        adminNotifications.forEach(notification => {
                            if (notification.id === notificationId && !notification.read) {
                                notification.read = true;
                                adminUpdated = true;
                            }
                        });
                        
                        if (adminUpdated) {
                            localStorage.setItem('adminNotifications', JSON.stringify(adminNotifications));
                            console.log("Ažurirane admin notifikacije za ID:", notificationId);
                        }
                    } catch (error) {
                        console.error("Greška pri ažuriranju notifikacija u localStorage:", error);
                    }
                    
                    // Ažuriraj prikaz brojača
                    updateNotificationsDisplay();
                }
            }
            
            // Funkcija za označavanje svih notifikacija kao pročitanih
            function markAllNotificationsAsRead() {
                console.log("Izvršavanje funkcije markAllNotificationsAsRead");
                const notificationItems = document.querySelectorAll('.notification-item');
                console.log("Pronađene notifikacije:", notificationItems.length);
                
                const readNotifications = loadReadNotifications();
                console.log("Trenutno pročitane notifikacije:", readNotifications);
                
                let updated = false;
                
                notificationItems.forEach(item => {
                    const notificationId = item.getAttribute('data-id');
                    console.log("Notifikacija ID:", notificationId);
                    
                    if (notificationId && !readNotifications.includes(notificationId)) {
                        readNotifications.push(notificationId);
                        updated = true;
                    } else if (!notificationId) {
                        console.warn("Notifikacija nema data-id atribut:", item);
                    }
                    
                    // Primeni vizuelni efekat za pročitanu notifikaciju
                    item.style.opacity = '0.7';
                    item.classList.add('read');
                });
                
                if (updated) {
                    console.log("Čuvanje ažuriranih pročitanih notifikacija:", readNotifications);
                    saveReadNotifications(readNotifications);
                }
                
                // Sakrij bedž sa brojem notifikacija
                if (globalNotificationBadge) {
                    globalNotificationBadge.style.display = 'none';
                    globalNotificationBadge.textContent = '0';
                    console.log("Badge sakriven nakon označavanja svih notifikacija kao pročitane");
                } else {
                    console.warn("globalNotificationBadge nije pronađen pri pokušaju sakrivanja!");
                }
                
                // Označi i notifikacije iz admin panela kao pročitane
                try {
                    const adminNotifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
                    let adminUpdated = false;
                    
                    // Označimo sve admin notifikacije kao pročitane
                    adminNotifications.forEach(notification => {
                        if (!notification.read) {
                            notification.read = true;
                            adminUpdated = true;
                        }
                    });
                    
                    if (adminUpdated) {
                        localStorage.setItem('adminNotifications', JSON.stringify(adminNotifications));
                    }
                    
                    // Uradimo isto i za korisničke notifikacije
                    const userNotifications = JSON.parse(localStorage.getItem('userNotifications') || '[]');
                    let userUpdated = false;
                    
                    userNotifications.forEach(notification => {
                        if (!notification.read) {
                            notification.read = true;
                            userUpdated = true;
                        }
                    });
                    
                    if (userUpdated) {
                        localStorage.setItem('userNotifications', JSON.stringify(userNotifications));
                    }
                } catch (error) {
                    console.error("Greška pri ažuriranju notifikacija:", error);
                }
                
                // Dodajemo proveru da li je zaista promenjeno
                console.log("Sve notifikacije bi sada trebale biti označene kao pročitane");
                setTimeout(() => updateNotificationsDisplay(), 100);
            }
            
            // Funkcija za učitavanje notifikacija sa admin panela
            function loadAdminNotifications() {
                try {
                    // Učitaj standardne korisničke notifikacije
                    const userNotifications = JSON.parse(localStorage.getItem('userNotifications') || '[]');
                    
                    // Učitaj notifikacije kreirane u admin panelu
                    const adminNotifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
                    
                    // Kombinuj notifikacije
                    const combinedNotifications = [];
                    
                    // Dodaj standardne korisničke notifikacije
                    userNotifications.forEach(notification => {
                        combinedNotifications.push({
                            id: notification.id,
                            title: notification.title,
                            message: notification.message,
                            type: notification.type || 'Obaveštenje',
                            timestamp: notification.timestamp,
                            read: notification.read || false
                        });
                    });
                    
                    // Dodaj admin notifikacije koje su za sve korisnike
                    adminNotifications.forEach(notification => {
                        // Provjeri je li notifikacija za sve korisnike ili samo za admin korisnika
                        const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                        const adminEmail = 'zorandostica2@gmail.com';
                        const isAdmin = currentUser.email === adminEmail || localStorage.getItem('admin_logged_in') === 'true';
                        
                        // Ako je notifikacija za sve korisnike ili je trenutni korisnik admin
                        if (notification.recipients === 'Svi korisnici' || isAdmin) {
                            combinedNotifications.push({
                                id: notification.id,
                                title: notification.title,
                                message: notification.message,
                                type: notification.type || 'Obaveštenje',
                                timestamp: notification.date,
                                read: notification.read || false
                            });
                        }
                    });
                    
                    if (combinedNotifications.length > 0) {
                        // Očisti postojeće demo notifikacije
                        notificationList.innerHTML = '';
                        
                        // Sortiranje notifikacija (najnovije prvo)
                        combinedNotifications.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                        
                        // Generiši HTML za svaku notifikaciju
                        combinedNotifications.forEach(notification => {
                            const date = new Date(notification.timestamp);
                            const formattedDate = `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}.${date.getFullYear()} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                            
                            // Odredi klasu na osnovu pročitanog statusa
                            const isRead = isNotificationRead(notification.id);
                            const readClass = isRead ? 'read' : '';
                            const opacity = isRead ? '0.7' : '1';
                            
                            // Odredi ikonu na osnovu tipa notifikacije
                            let iconClass = 'fa-circle-info';
                            let iconColor = 'var(--gold-medium)';
                            
                            if (notification.type === 'Važno') {
                                iconClass = 'fa-exclamation-circle';
                                iconColor = '#FFD700';
                            } else if (notification.type === 'Upozorenje') {
                                iconClass = 'fa-triangle-exclamation';
                                iconColor = '#FF6B6B';
                            } else if (notification.type) {
                                // Za druge tipove notifikacija (ako ih ima)
                                switch (notification.type.toLowerCase()) {
                                    case 'important':
                                    case 'važno':
                                        iconClass = 'fa-exclamation-circle';
                                        iconColor = '#FFD700';
                                        break;
                                    case 'warning':
                                    case 'upozorenje':
                                        iconClass = 'fa-triangle-exclamation';
                                        iconColor = '#FF6B6B';
                                        break;
                                    default:
                                        iconClass = 'fa-circle-info';
                                        iconColor = 'var(--gold-medium)';
                                }
                            }
                            
                            // Formatiranje poruke da uključuje kliketabilan link - POBOLJŠANO ZA SVE LINKOVE
                            let formattedMessage = notification.message;
                            if (formattedMessage && (formattedMessage.includes('https://') || formattedMessage.includes('http://'))) {
                                // Izdvajamo bilo koji HTTP/HTTPS link iz poruke
                                const linkMatch = formattedMessage.match(/(https?:\/\/[^\s<>"]+)/g);
                                if (linkMatch) {
                                    linkMatch.forEach(link => {
                                        // Uklanjamo postojeće HTML tagove ako postoje
                                        if (!formattedMessage.includes(`<a href="${link}"`)) {
                                            formattedMessage = formattedMessage.replace(link, `<a href="${link}" target="_blank" style="color: var(--gold-bright); text-decoration: underline; font-weight: bold;">🎯 PRISTUPITE ONLINE SASTANKU</a>`);
                                        }
                                    });
                                }
                            }
                            
                            const notificationHTML = `
                                <div class="notification-item ${readClass}" data-id="${notification.id}" style="padding: 0.8rem 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); display: flex; gap: 0.8rem; align-items: flex-start; transition: background 0.2s ease; cursor: pointer; opacity: ${opacity};" onmouseover="this.style.background='rgba(212, 175, 55, 0.1)'" onmouseout="this.style.background='transparent'">
                                    <i class="fas ${iconClass}" style="color: ${iconColor}; font-size: 1.2rem; margin-top: 0.2rem;"></i>
                                    <div>
                                        <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.3rem;">
                                            <h5 style="margin: 0; color: var(--gold-pale);">${notification.title}</h5>
                                            <small style="font-size: 0.7rem; color: var(--muted-text);">${formattedDate}</small>
                                        </div>
                                        <p style="margin: 0; font-size: 0.9rem;">${formattedMessage}</p>
                                    </div>
                                </div>
                            `;
                            
                            notificationList.innerHTML += notificationHTML;
                        });
                        
                        // Dodaj event listener za označavanje pojedinačnih notifikacija kao pročitanih
                        document.querySelectorAll('.notification-item').forEach(item => {
                            item.addEventListener('click', function() {
                                const notificationId = this.getAttribute('data-id');
                                markNotificationAsRead(notificationId);
                                this.style.opacity = '0.7';
                                this.classList.add('read');
                                updateNotificationsDisplay();
                            });
                        });
                        
                        // Ažuriraj broj nepročitanih notifikacija
                        updateNotificationsDisplay();
                    }
                } catch (error) {
                    console.error("Greška pri učitavanju notifikacija:", error);
                }
            }
            
            // Funkcija za ažuriranje prikaza notifikacija na osnovu pročitanog statusa
            function updateNotificationsDisplay() {
                console.log("Pokrenuta updateNotificationsDisplay funkcija");
                
                // Koristimo globalnu promjenjivu ili je ponovo dohvaćamo ako nije dostupna
                if (!globalNotificationBadge) {
                    globalNotificationBadge = document.querySelector('.notification-badge');
                    console.log("Ponovno dohvaćanje globalNotificationBadge");
                }
                
                const notificationItems = document.querySelectorAll('.notification-item');
                console.log("Broj notifikacija za ažuriranje:", notificationItems.length);
                
                const readNotifications = loadReadNotifications();
                console.log("Učitane pročitane notifikacije:", readNotifications);
                
                // Učitavamo i korisničke i admin notifikacije da bismo dobili precizan broj nepročitanih
                const userNotifications = JSON.parse(localStorage.getItem('userNotifications') || '[]');
                const adminNotifications = JSON.parse(localStorage.getItem('adminNotifications') || '[]');
                
                // Prave nepročitane notifikacije bazirane na localStorage
                let realUnreadCount = 0;
                
                // Brojimo nepročitane notifikacije iz userNotifications
                userNotifications.forEach(notification => {
                    if (!notification.read && !readNotifications.includes(notification.id)) {
                        realUnreadCount++;
                    }
                });
                
                // Brojimo nepročitane notifikacije iz adminNotifications
                adminNotifications.forEach(notification => {
                    // Provjeri je li notifikacija za sve korisnike ili samo za admin korisnika
                    const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    const adminEmail = 'zorandostica2@gmail.com';
                    const isAdmin = currentUser.email === adminEmail || localStorage.getItem('admin_logged_in') === 'true';
                    
                    // Ako je notifikacija za sve korisnike ili je trenutni korisnik admin
                    if ((notification.recipients === 'Svi korisnici' || isAdmin) && 
                        !notification.read && !readNotifications.includes(notification.id)) {
                        realUnreadCount++;
                    }
                });
                
                // Brojimo i notifikacije prikazane u interfejsu (DOM) kao backup
                let unreadCount = 0;
                
                notificationItems.forEach(item => {
                    const notificationId = item.getAttribute('data-id');
                    console.log("Proveravanje notifikacije ID:", notificationId);
                    
                    if (notificationId && readNotifications.includes(notificationId)) {
                        console.log("Notifikacija je pročitana:", notificationId);
                        // Primeni vizuelni efekat za pročitanu notifikaciju
                        item.style.opacity = '0.7';
                        item.classList.add('read');
                    } else {
                        console.log("Notifikacija NIJE pročitana:", notificationId);
                        unreadCount++;
                    }
                });
                
                console.log("Broj nepročitanih notifikacija (DOM):", unreadCount);
                console.log("Broj stvarnih nepročitanih notifikacija (localStorage):", realUnreadCount);
                
                // Koristimo veću vrijednost između stvarnih i DOM notifikacija da ne propustimo nijednu
                const finalUnreadCount = Math.max(unreadCount, realUnreadCount);
                
                // Ažuriraj broj nepročitanih notifikacija
                if (globalNotificationBadge) {
                    if (finalUnreadCount > 0) {
                        globalNotificationBadge.textContent = finalUnreadCount;
                        globalNotificationBadge.style.display = 'flex';
                        console.log("Badge prikazuje:", finalUnreadCount);
                    } else {
                        globalNotificationBadge.style.display = 'none';
                        console.log("Badge sakriven");
                    }
                } else {
                    console.warn("globalNotificationBadge element nije pronađen!");
                }
            }
            
            // Funkcija za prikazivanje/sakrivanje dropdown menija sa notifikacijama
            function toggleNotificationDropdown() {
                console.log("Funkcija toggleNotificationDropdown pozvana");
                
                // Koristimo globalnu promjenjivu
                if (!globalNotificationDropdown) {
                    console.error("globalNotificationDropdown element nije pronađen!");
                    
                    // Pokušaj ponovo dohvatiti element
                    globalNotificationDropdown = document.getElementById('notificationDropdown');
                    if (!globalNotificationDropdown) {
                        console.error("Ni nakon ponovnog pokušaja globalNotificationDropdown nije pronađen!");
                        return;
                    }
                }
                
                globalNotificationDropdown.style.display = globalNotificationDropdown.style.display === 'none' ? 'block' : 'none';
                console.log("Prikazivanje dropdown-a: ", globalNotificationDropdown.style.display);
                
                // Učitaj notifikacije kada se dropdown otvori
                if (globalNotificationDropdown.style.display === 'block') {
                    loadAdminNotifications();
                    
                    // Resetovanje skrola na vrh kad se otvori dropdown
                    if (globalNotificationList) {
                        globalNotificationList.scrollTop = 0;
                    }
                    
                    // Ažuriraj prikaz notifikacija kad se otvori dropdown
                    updateNotificationsDisplay();
                }
            }
            
            // Event listener za klik na zvonce
            if (globalNotificationBtn) {
                console.log("globalNotificationBtn pronađen, dodajem event listener");
                
                // Uklonimo bilo koji postojeći event listener da izbjegnemo duplikate (iako to nije moguće direktno)
                // Umjesto toga, koristićemo jedan imenovani event handler za lakše upravljanje
                
                function notificationClickHandler(e) {
                    console.log("Klik na notifikacijsko dugme");
                    e.stopPropagation();
                    toggleNotificationDropdown();
                }
                
                // Dodajemo novi event listener
                globalNotificationBtn.addEventListener('click', notificationClickHandler);
            } else {
                console.error("globalNotificationBtn element nije pronađen!");
                // Pokušajmo ga pronaći ponovo nakon što se stranica potpuno učita
                setTimeout(function() {
                    globalNotificationBtn = document.getElementById('notificationBtn');
                    if (globalNotificationBtn) {
                        console.log("globalNotificationBtn pronađen nakon odgode");
                        
                        function delayedNotificationClickHandler(e) {
                            console.log("Klik na notifikacijsko dugme (odgođeno)");
                            e.stopPropagation();
                            toggleNotificationDropdown();
                        }
                        
                        globalNotificationBtn.addEventListener('click', delayedNotificationClickHandler);
                    }
                }, 500);
            }
            
            // Event listener za klik na "Označi sve kao pročitano"
            if (globalMarkAllReadBtn) {
                console.log("globalMarkAllReadBtn pronađen i dodavanje event listenera");
                globalMarkAllReadBtn.addEventListener('click', function(e) {
                    console.log("Kliknuto na 'Označi sve kao pročitano'");
                    e.stopPropagation();
                    e.preventDefault();
                    markAllNotificationsAsRead();
                });
            } else {
                console.warn("globalMarkAllReadBtn nije pronađen! Proverite ID dugmeta.");
                // Pokušaj naći dugme po tekstu ako ID ne radi
                setTimeout(function() {
                    const markAllBtns = Array.from(document.querySelectorAll('button')).filter(btn => 
                        btn.textContent.includes('Označi sve kao pročitano'));
                    if (markAllBtns.length > 0) {
                        console.log("Pronađeno dugme po tekstu:", markAllBtns[0]);
                        markAllBtns[0].addEventListener('click', function(e) {
                            console.log("Kliknuto na 'Označi sve kao pročitano' (alternativno)");
                            e.stopPropagation();
                            e.preventDefault();
                            markAllNotificationsAsRead();
                        });
                    }
                }, 500);
            }
            
            // Sakrij dropdown kada se klikne bilo gde na stranici
            document.addEventListener('click', function(e) {
                if (notificationDropdown && notificationDropdown.style.display === 'block') {
                    if (!notificationDropdown.contains(e.target) && e.target !== notificationBtn) {
                        notificationDropdown.style.display = 'none';
                    }
                }
            });
            
            // Omogući scrollovanje unutar dropdown-a bez zatvaranja
            if (notificationList) {
                notificationList.addEventListener('wheel', function(e) {
                    e.stopPropagation();
                });
                
                notificationList.addEventListener('touchmove', function(e) {
                    e.stopPropagation();
                });
                
                // Osiguramo da se događaji skrola ne propagiraju izvan kontejnera
                notificationList.addEventListener('scroll', function(e) {
                    e.stopPropagation();
                });
            }
            
            // Dodajemo delegirani event listener za notifikacije (ovo radi sa dinamički dodanim elementima)
            if (notificationList) {
                notificationList.addEventListener('click', function(e) {
                    // Pronalazimo najbliži notification-item element od kliknutog elementa
                    const notificationItem = e.target.closest('.notification-item');
                    if (notificationItem) {
                        // Ovde možemo dodati logiku za otvaranje detalja notifikacije
                        // ili preusmeravanje na odgovarajuću stranicu
                        console.log('Notifikacija kliknuta');
                        
                        // Označi notifikaciju kao pročitanu
                        const notificationId = notificationItem.getAttribute('data-id');
                        if (notificationId) {
                            markNotificationAsRead(notificationId);
                        }
                        
                        // Efekat označavanja kao pročitano
                        notificationItem.style.opacity = '0.7';
                        notificationItem.classList.add('read');
                        
                        // Ažuriraj broj nepročitanih notifikacija
                        updateNotificationsDisplay();
                    }
                });
            }
            
            // Inicijalno ažuriranje prikaza notifikacija
            console.log("Inicijalno ažuriranje prikaza notifikacija");
            loadAdminNotifications(); // Učitaj admin notifikacije prilikom inicijalizacije
            updateNotificationsDisplay();
            
            // Pozovi i našu funkciju za inicijalizaciju bedža za dodatnu sigurnost
            initializeNotificationBadge();
            
            // Dodatno osiguravanje da će se notifikacije ispravno učitati nakon potpunog učitavanja stranice
            window.addEventListener('load', function() {
                console.log("Stranica potpuno učitana - ponovna inicijalizacija notifikacija");
                
                // Ponovo dohvati elemente ako neki nedostaju
                if (!globalNotificationBtn) globalNotificationBtn = document.getElementById('notificationBtn');
                if (!globalNotificationDropdown) globalNotificationDropdown = document.getElementById('notificationDropdown');
                if (!globalNotificationList) globalNotificationList = document.getElementById('notificationList');
                if (!globalMarkAllReadBtn) globalMarkAllReadBtn = document.getElementById('markAllRead');
                if (!globalNotificationBadge) globalNotificationBadge = document.querySelector('.notification-badge');
                
                console.log("Nakon load event-a:");
                console.log("notificationBtn:", globalNotificationBtn ? "pronađen" : "nije pronađen");
                console.log("notificationDropdown:", globalNotificationDropdown ? "pronađen" : "nije pronađen");
                console.log("notificationList:", globalNotificationList ? "pronađen" : "nije pronađen");
                
                // Ponovo dodaj event listener za klik na zvonce ako je potrebno
                if (globalNotificationBtn) {
                    function loadEventClickHandler(e) {
                        console.log("Klik na notifikacijsko dugme (nakon load event-a)");
                        e.stopPropagation();
                        toggleNotificationDropdown();
                    }
                    
                    globalNotificationBtn.addEventListener('click', loadEventClickHandler);
                }
                
                loadAdminNotifications(); // Učitaj admin notifikacije kada se stranica potpuno učita
                setTimeout(() => updateNotificationsDisplay(), 300);
            });
        });
        
        // Funkcionalnost za zakazivanje konsultacija
        document.addEventListener('DOMContentLoaded', function() {
            // Inicijalizacija forme za zakazivanje konsultacija
            const consultationForm = document.getElementById('consultationForm');
            const consultationSuccess = document.getElementById('consultationSuccess');
            const consultationDate = document.getElementById('consultationDate');
            
            // Postavljanje minimalnog datuma na današnji dan
            if (consultationDate) {
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                const formattedToday = `${yyyy}-${mm}-${dd}`;
                consultationDate.min = formattedToday;
            }
            
            // Slušaj događaj podnošenja forme za zakazivanje konsultacija
            if (consultationForm) {
                consultationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Pozovi novu funkciju za submitovanje
                    submitConsultationForm(e);
                });
            }
            
            // Dodaj funkciju za otvaranje modala za zakazivanje konsultacija
            window.openConsultationModal = function() {
                openModal('consultationModal');
                
                // Resetuj prikaz forme i poruke o uspjehu
                if (consultationForm && consultationSuccess) {
                    consultationForm.style.display = 'block';
                    consultationSuccess.style.display = 'none';
                }
            };
            
            // Funkcija za navigaciju do određene sekcije
            window.showSection = function(sectionId) {
                // Prvo dobavimo elemente za koje znamo da postoje
                const sections = {
                    'dashboard': document.querySelector('.hero-section') || document.documentElement,
                    'results': document.getElementById('results'),
                    'about': document.getElementById('about'),
                    'testimonials': document.getElementById('testimonials')
                };
                
                if (sections[sectionId]) {
                    // Skrolujemo do sekcije sa glatkom animacijom
                    sections[sectionId].scrollIntoView({ behavior: 'smooth' });
                }
            };

            // Funkcija za ažuriranje prikaza budžeta
            function updateBudgetDisplay() {
                try {
                    // Učitaj i validiraj podatke iz localStorage-a
                    let budget = {};
                    let userBudget = {};
                    
                    try {
                        const budgetStr = localStorage.getItem('budget');
                        if (budgetStr) budget = JSON.parse(budgetStr);
                    } catch (e) {
                        console.warn('Greška pri učitavanju budget podataka:', e);
                    }
                    
                    try {
                        const userBudgetStr = localStorage.getItem('userBudget');
                        if (userBudgetStr) userBudget = JSON.parse(userBudgetStr);
                    } catch (e) {
                        console.warn('Greška pri učitavanju userBudget podataka:', e);
                    }

                    // Izračunaj vrednosti sa validacijom
                    const monthlyBudget = parseFloat(budget.monthlyBudget) || 
                        parseFloat(userBudget.monthlyIncome) || 0;
                    
                    const spentAmount = parseFloat(budget.totalSpent) || 
                        (parseFloat(userBudget.necessities || 0) + parseFloat(userBudget.hobby || 0)) || 0;
                    
                    const remainingAmount = Math.max(0, monthlyBudget - spentAmount);

                    // Ažuriraj DOM elemente
                    const elements = {
                        monthlyBudget: document.getElementById('monthlyBudget'),
                        spentAmount: document.getElementById('spentAmount'),
                        remainingAmount: document.getElementById('remainingAmount'),
                        progressBar: document.getElementById('budgetProgressBar')
                    };

                    // Proveri da li elementi postoje pre ažuriranja
                    if (!elements.monthlyBudget && !elements.spentAmount && 
                        !elements.remainingAmount && !elements.progressBar) {
                        return; // Tiho prekini ako nijedan element ne postoji
                    }

                    // Funkcija za animirano ažuriranje vrednosti
                    const updateWithAnimation = (element, newValue) => {
                        if (!element) return;
                        
                        const oldValue = parseFloat(element.textContent.replace('€', '')) || 0;
                        const duration = 1000; // 1 sekunda za animaciju
                        const startTime = performance.now();
                        
                        const animate = (currentTime) => {
                            const elapsed = currentTime - startTime;
                            const progress = Math.min(elapsed / duration, 1);
                            
                            const currentValue = oldValue + (newValue - oldValue) * progress;
                            element.textContent = `€${currentValue.toFixed(2)}`;
                            
                            if (progress < 1) {
                                requestAnimationFrame(animate);
                            }
                        };
                        
                        requestAnimationFrame(animate);
                    };

                    // Ažuriraj vrednosti sa animacijom
                    updateWithAnimation(elements.monthlyBudget, monthlyBudget);
                    updateWithAnimation(elements.spentAmount, spentAmount);
                    updateWithAnimation(elements.remainingAmount, remainingAmount);

                    // Ažuriraj progres bar sa animacijom
                    if (elements.progressBar) {
                        const percentage = monthlyBudget > 0 ? (spentAmount / monthlyBudget) * 100 : 0;
                        elements.progressBar.style.transition = 'width 0.5s ease-out, background 0.3s ease';
                        elements.progressBar.style.width = `${Math.min(100, percentage)}%`;
                        
                        // Koristi CSS varijable za boje
                        if (percentage >= 90) {
                            elements.progressBar.style.background = 'var(--gradient-gold-dark)';
                        } else if (percentage >= 75) {
                            elements.progressBar.style.background = 'var(--gradient-gold)';
                        } else {
                            elements.progressBar.style.background = 'var(--gradient-gold-light)';
                        }
                    }

                    // Emituj custom event za sinhronizaciju
                    window.dispatchEvent(new CustomEvent('budget-updated', { 
                        detail: { monthlyBudget, spentAmount, remainingAmount } 
                    }));

                } catch (error) {
                    console.error('Greška pri ažuriranju prikaza budžeta:', error);
                }
            }

            // Inicijalno učitavanje budžeta
            document.addEventListener('DOMContentLoaded', updateBudgetDisplay);

            // Osluškuj promene u localStorage-u
            window.addEventListener('storage', (e) => {
                if (e.key === 'budget' || e.key === 'userBudget' || e.key === 'currentUser') {
                    updateBudgetDisplay();
                }
            });

            // Osluškuj custom event za sinhronizaciju
            window.addEventListener('budget-updated', (e) => {
                console.log('Budžet je ažuriran:', e.detail);
            });

            // Ažuriraj svakih 30 sekundi
            setInterval(updateBudgetDisplay, 30000);

            // Izvozi funkcije za upotrebu u drugim fajlovima
            window.updateBudgetDisplay = updateBudgetDisplay;
        });
    </script>
</body>
</html>